(this.webpackJsonpbklog=this.webpackJsonpbklog||[]).push([[0],{122:function(e,t){},152:function(e,t){},155:function(e,t,a){},156:function(e,t,a){},157:function(e,t,a){},158:function(e,t,a){},159:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),c=a(36),r=a.n(c),l=a(13),i=a(12),s=a(5),u=a(8),d=a.n(u),p=a(9),f=a.n(p),b=a(39),m=a(14);var g=a(83),k=a(85),y=a(17),h=a(22),v=a(79),O=a.n(v),E=a(80),j=function(){function e(t){Object(y.a)(this,e),this.type="unknown",this.code="000",this.message="\uc54c \uc218 \uc5c6\ub294 \uc624\ub958\uc785\ub2c8\ub2e4.",this.detail="unknown",t&&this.build(t)}return Object(h.a)(e,[{key:"build",value:function(e){return e.type&&(this.type=e.type),e.code&&(this.code=e.code),e.message&&(this.message=e.message),e.detail&&(this.detail=e.detail),this}},{key:"setType",value:function(e){return this.type=e,this}},{key:"setCode",value:function(e){return this.code=e,this}},{key:"setMessage",value:function(e){return this.message=e,this}},{key:"setDetail",value:function(e){return this.detail=e,this}},{key:"get",get:function(){return{type:this.type,code:this.code,message:this.message,detail:this.detail}}}]),e}(),x=function(){function e(t){Object(y.a)(this,e),this._ajax=void 0,this.baseUrl=void 0,this.baseUrl=t,this._ajax=O.a.create({baseURL:t}),this._initializeAjax()}return Object(h.a)(e,[{key:"_initializeAjax",value:function(){this._ajax.interceptors.response.use((function(e){return e.data}),(function(e){return e.response?e.response.data.error?Promise.reject((new j).build(e.response.data.error)):Promise.reject((new j).build(e.response.data)):e.request?(console.log(e.request),Promise.reject({message:e.message,detail:"response not"})):(console.log(e),Promise.reject({message:e.message}))}))}},{key:"call",value:function(e){var t=this;return new Promise((function(a,n){t._ajax(e).then((function(e){a(e)})).catch((function(e){n(e)}))}))}}]),e}(),I={Api:x,Rest:function(e){Object(k.a)(a,e);var t=Object(g.a)(a);function a(e){return Object(y.a)(this,a),t.call(this,e)}return Object(h.a)(a,[{key:"_restConvert",value:function(e){return Object.assign({},e,{url:e.qs?"".concat(e.url).concat(Object(E.stringify)(e.qs,{addQueryPrefix:!0})):e.url})}},{key:"restApi",value:function(e){var t=this;return new Promise((function(a,n){t.call(t._restConvert(e)).then((function(e){a(e)})).catch((function(e){n(e)}))}))}}]),a}(x),ApiError:j},C=I.ApiError,D=new(0,I.Rest)("http://localhost:4500/v2");var T={authFetchPost:function(e,t){return D.restApi({method:"post",url:"auth/".concat(e),withCredentials:!0,data:t})},authFetchGet:function(e,t){return D.restApi({method:"get",url:"auth/".concat(e),withCredentials:!0,qs:t})}},B={signUpUser:function(e){return{type:N,payload:e}},signUpUserSuccess:function(){return{type:S}},signUpUserError:function(e){return{type:L,payload:{error:e}}},signInUser:function(e){return{type:w,payload:e}},signInUserError:function(e){return{type:_,payload:e}},signInUserSuccess:function(e){return{type:U,payload:e}},signOutUser:function(){return{type:R}},signOutUserError:function(){return{type:P}},signOutUserSuccess:function(){return{type:M}},reSignInUser:function(){return{type:A}},reSignInUserError:function(e){return{type:F,payload:e}},reSignInUserSuccess:function(e){return{type:G,payload:e}},reissueToken:function(){return{type:H}},reissueTokenError:function(e){return{type:K,payload:e}},resetAuth:function(){return{type:V}}},N="auth/SIGN_UP_USER",S="auth/SIGN_UP_USER_SUCCESS",L="auth/SIGN_UP_USER_ERROR",w="auth/SIGN_IN_USER",U="auth/SIGN_IN_USER_SUCCESS",_="auth/SIGN_IN_USER_ERROR",R="auth/SIGN_OUT_USER",M="auth/SIGN_OUT_USER_SUCCESS",P="auth/SIGN_OUT_USER_ERROR",A="auth/RESIGN_IN_USER",G="auth/RESIGN_IN_USER_SUCCESS",F="auth/RESIGN_IN_USER_ERROR",H="REISSUETOKEN",K="REISSUETOKEN_ERROR",V="auth/RESET_AUTH",X=B.signUpUser,Y=B.signInUser,q=B.signOutUser,z=B.reSignInUser,J=B.reissueToken,W=T.authFetchPost,Q=T.authFetchGet;var Z=function(){var e=Object(m.c)((function(e){return e.auth})),t=Object(m.b)(),a=Object(n.useCallback)((function(e){return t(X(e))}),[t]),o=Object(n.useCallback)((function(e){return t(Y(e))}),[t]),c=Object(n.useCallback)((function(){return t(z())}),[t]),r=Object(n.useCallback)((function(){return t(q())}),[t]),l=Object(n.useCallback)((function(){return t(J())}),[t]),i=function(){var t=Object(b.a)(f.a.mark((function t(){var a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T.authFetchGet("check-token");case 2:a=t.sent,console.log(a),a.data?a.data:null,!!a.data&&a.data.success?e.user||c():e.user&&l();case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return{authState:e,onSignUpUser:a,onSignInUser:o,onReSignInUser:c,onSignOutUser:r,onReissueToken:l,onCheckToken:i}},$=a(20),ee=a(18);var te=function(e){var t=e.boxClass,a=e.labelClass,n=e.onChange,c=e.value,r=e.placeholder,l=e.label,i=e.className,s=e.type,u=e.name,d=e.id,p=e.autoComplete,f=e.children;return o.a.createElement("div",{className:t},o.a.createElement("label",{htmlFor:s,className:a},l),o.a.createElement("input",{id:d,name:u,type:s,className:i,placeholder:r,value:c,onChange:n,autoComplete:p}),f)};var ae=function(e){var t=Object(n.useState)(e),a=Object(s.a)(t,2),o=a[0],c=a[1],r=Object(n.useState)(!1),l=Object(s.a)(r,2),i=l[0],u=l[1];return[o,function(e){i&&u(!1),c(e.target.value)},i,function(e){u(e)}]};var ne=function(){var e=Z(),t=e.authState.error.signInUser,a=e.onSignInUser,c=Object(n.useState)(!1),r=Object(s.a)(c,2),l=r[0],i=r[1],u=ae(""),p=Object(s.a)(u,4),f=p[0],b=p[1],m=p[2],g=p[3],k=ae(""),y=Object(s.a)(k,4),h=y[0],v=y[1],O=y[2],E=y[3],j=[{value:f,onChange:b,id:"email-address",name:"email",type:"email",label:"Email address",placeholder:"example@example.com",autoComplete:"on",error:m,style:"rounded-t-md"},{value:h,onChange:v,id:"password",name:"password",type:"password",label:"password",placeholder:"\ube44\ubc00\ubc88\ud638",autoComplete:"off",error:O,style:"rounded-b-md"}],x=function(e){e.preventDefault(),f&&h?a({email:f,password:h}):(g(!f),E(!h))};return Object(n.useEffect)((function(){t&&i(!0)}),[t]),o.a.createElement("form",{className:"mt-12",onSubmit:x,action:"#"},o.a.createElement("div",{className:"rounded-md shadow-sm -space-y-px"},j.map((function(e){return o.a.createElement(te,{key:e.id,labelClass:"sr-only",className:d()("dark:bg-gray-100 appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 focus:ring-1 sm:text-sm",e.style,{"border-red-500":e.error}),value:e.value,onChange:e.onChange,id:e.id,name:e.name,type:e.type,label:e.label,placeholder:e.placeholder,autoComplete:e.autoComplete})}))),o.a.createElement("div",{className:"mb-8 leading-6 h-6 block text-red-500 text-sm font-semibold text-left px-2"},l?"\uac00\uc785\ud558\uc9c0 \uc54a\uc740 \uacc4\uc815\uc774\uac70\ub098, \uc798\ubabb\ub41c \ube44\ubc00\ubc88\ud638\uc785\ub2c8\ub2e4.":m||O?"\uacc4\uc815\uacfc \ud328\uc2a4\uc6cc\ub4dc\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.":null),o.a.createElement("div",null,o.a.createElement("button",{type:"submit",onClick:x,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-purple-500 hover:bg-purple-600 active:outline-none active:ring-2 active:ring-offset-2 active:ring-purple-600"},o.a.createElement("span",{className:"absolute left-0 inset-y-0 flex items-center pl-3"},o.a.createElement($.a,{className:"text-base text-purple-300 group-hover:text-purple-200",icon:ee.d})),"Sign in")))};var oe=function(){return o.a.createElement("div",{className:"sign-in w-full h-full flex justify-center bg-gray-50 dark:bg-black pt-40 px-4 sm:px-6 lg:px-8 shadow rounded-md"},o.a.createElement("div",{className:"max-w-md w-full space-y-10"},o.a.createElement("div",null,o.a.createElement("h2",{className:"text-center text-3xl font-extrabold text-gray-900 dark:text-gray-100"},"Sign in to your account")),o.a.createElement(ne,null)))};function ce(e){var t=e.used,a=e.valid,n=e.name;return a?"".concat(n," \ud615\uc2dd\uc5d0 \ub9de\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."):t?"\uc0ac\uc6a9\ud558\uace0 \uc788\ub294 ".concat(n,"\uc785\ub2c8\ub2e4."):"\ud544\uc218 \uc815\ubcf4\uc785\ub2c8\ub2e4."}var re=function(){var e=ae(""),t=Object(s.a)(e,4),a=t[0],c=t[1],r=t[2],l=t[3],i=ae(""),u=Object(s.a)(i,4),p=u[0],f=u[1],b=u[2],m=u[3],g=ae(""),k=Object(s.a)(g,4),y=k[0],h=k[1],v=k[2],O=k[3],E=ae(""),j=Object(s.a)(E,4),x=j[0],I=j[1],C=j[2],D=j[3],T=ae(""),B=Object(s.a)(T,4),N=B[0],S=B[1],L=B[2],w=B[3],U=Z(),_=U.authState.error.signUpUser,R=_.emailUsed,M=_.emailValid,P=_.passwordValid,A=_.penNameUsed,G=_.penNameValid,F=U.onSignUpUser,H=[{id:"last-name",name:"lastName",type:"text",label:"\uc131",placeholder:"\uc131",value:a,onChange:c,error:r,errorMessage:"\ud544\uc218 \uc815\ubcf4\uc785\ub2c8\ub2e4."},{id:"first-name",name:"firstName",type:"text",label:"\uc774\ub984",placeholder:"\uc774\ub984",value:p,onChange:f,error:b,errorMessage:"\ud544\uc218 \uc815\ubcf4\uc785\ub2c8\ub2e4."},{id:"pen-name",name:"penName",type:"text",label:"\ud544\uba85",placeholder:"\uc601\ubb38 \ud544\uc218, \uc911\ubcf5\uc774 \ubd88\uac00\ud569\ub2c8\ub2e4.",value:y,onChange:h,error:v,errorMessage:ce({name:"\ud544\uba85",used:A,valid:G})},{id:"email-address",name:"email",type:"email",label:"\uacc4\uc815(\uc774\uba54\uc77c)",placeholder:"example@example.com",value:x,onChange:I,error:C,errorMessage:ce({name:"\uc774\uba54\uc77c",used:R,valid:M})},{id:"password",name:"password",type:"password",label:"\ube44\ubc00\ubc88\ud638",placeholder:"\uc601\ubb38, \uc22b\uc790 \uc870\ud569 8 ~ 12\uc790\ub85c \uc791\uc131\ud574\uc8fc\uc138\uc694.",value:N,onChange:S,error:L,errorMessage:ce({name:"\ube44\ubc00\ubc88\ud638",valid:P})}],K=function(e){e.preventDefault(),r||b||C||v||L?console.log("\uc2e4\ud589 \uc548\ub428"):y&&p&&a&&x&&N?F({penName:y,firstName:p,lastName:a,email:x,password:N}):(l(!a),m(!p),O(!y),D(!x),w(!N))};return Object(n.useEffect)((function(){(R||M)&&D(!0),(A||G)&&O(!0),P&&w(!0)}),[R,M,P,A,G]),o.a.createElement("form",{onSubmit:K},o.a.createElement("div",{className:"overflow-hidden sm:rounded-md mb-8"},o.a.createElement("div",{className:"rounded-md p-2 space-y-4"},H.map((function(e){return o.a.createElement(te,{key:e.id,boxClass:"relative group",labelClass:"pl-1 mb-1 block text-sm font-medium text-gray-700 dark:text-gray-50",className:d()("rounded-md dark:bg-gray-100 appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 focus:ring-1 sm:text-sm",{"border-red-500":e.error}),value:e.value,onChange:e.onChange,id:e.id,name:e.name,type:e.type,label:e.label,placeholder:e.placeholder,autoComplete:"off"},o.a.createElement("span",{className:d()("absolute right-0 top-0 text-red-500 text-sm",{hidden:!e.error})},e.errorMessage))})))),o.a.createElement("div",{className:"p-2"},o.a.createElement("button",{type:"submit",onClick:K,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-purple-500 hover:bg-purple-600 active:outline-none active:ring-2 active:ring-offset-2 active:ring-purple-600"},"Sign up")))};var le=function(){return o.a.createElement("div",{className:"sign-up relative overflow-auto flex items-center w-full h-full bg-gray-50 dark:bg-black shadow rounded-md"},o.a.createElement("div",{className:"absolute left-0 top-auto py-32 w-full h-auto box-contents flex justify-center"},o.a.createElement("div",{className:"max-w-md w-full h-auto space-y-10"},o.a.createElement("div",null,o.a.createElement("h2",{className:"text-center text-3xl font-extrabold text-gray-900 dark:text-gray-100"},"Sign up")),o.a.createElement(re,null))))};var ie={toggle:!1,loading:!1,pageEditor:{penName:"Junhee",profileId:"4c382a569f1f4ea7841b25bd2efe78d8",bio:"\ud504\ub860\ud2b8\uc5d4\ub4dc \uac1c\ubc1c\uc790",userPhoto:"https://avatars.githubusercontent.com/u/59816563?v=4"},pageList:[{pageId:"d5cc2725-97ec-494b-bc80-c16f96379e61",pageTitle:"\uad00\ub9ac\uc790 \uc0ac\uc6a9 \uc124\uba85\uc11c"},{pageId:"d5cc2725-97ec-494b-bc80-c16f96379e62",pageTitle:"\uc0ac\uc6a9\uc790 \uc0ac\uc6a9 \uc124\uba85\uc11c"},{pageId:"d5cc2725-97ec-494b-bc80-c16f96379e63",pageTitle:"\uc0ac\uc6a9\uc790 \uc774\uc6a9 \ubb38\uc758 \ubc29\ubc95"},{pageId:"d5cc2725-97ec-494b-bc80-c16f96379e64",pageTitle:"\uac10\uc0ac\ud569\ub2c8\ub2e4."},{pageId:"d5cc2725-97ec-494b-bc80-c16f96379e65",pageTitle:"test5"},{pageId:"d5cc2725-97ec-494b-bc80-c16f96379e61",pageTitle:"\uad00\ub9ac\uc790 \uc0ac\uc6a9 \uc124\uba85\uc11c"},{pageId:"d5cc2725-97ec-494b-bc80-c16f96379e62",pageTitle:"\uc0ac\uc6a9\uc790 \uc0ac\uc6a9 \uc124\uba85\uc11c"},{pageId:"d5cc2725-97ec-494b-bc80-c16f96379e63",pageTitle:"\uc0ac\uc6a9\uc790 \uc774\uc6a9 \ubb38\uc758 \ubc29\ubc95"},{pageId:"d5cc2725-97ec-494b-bc80-c16f96379e64",pageTitle:"\uac10\uc0ac\ud569\ub2c8\ub2e4."},{pageId:"d5cc2725-97ec-494b-bc80-c16f96379e65",pageTitle:"test5"},{pageId:"d5cc2725-97ec-494b-bc80-c16f96379e61",pageTitle:"\uad00\ub9ac\uc790 \uc0ac\uc6a9 \uc124\uba85\uc11c"},{pageId:"d5cc2725-97ec-494b-bc80-c16f96379e62",pageTitle:"\uc0ac\uc6a9\uc790 \uc0ac\uc6a9 \uc124\uba85\uc11c"},{pageId:"d5cc2725-97ec-494b-bc80-c16f96379e63",pageTitle:"\uc0ac\uc6a9\uc790 \uc774\uc6a9 \ubb38\uc758 \ubc29\ubc95"},{pageId:"d5cc2725-97ec-494b-bc80-c16f96379e64",pageTitle:"\uac10\uc0ac\ud569\ub2c8\ub2e4."},{pageId:"d5cc2725-97ec-494b-bc80-c16f96379e65",pageTitle:"test5"}]};var se=function(){var e=Object(m.c)((function(e){return e.page})),t=e.pageEditor,a=e.toggle,o=Object(m.b)();return{pageState:e,pageEditor:t,pageToggle:a,onChangeToggle:Object(n.useCallback)((function(e){return o(function(e){return{type:"page/CHANGE_TOGGLE",payload:{toggle:e}}}(e))}),[o]),onChangePageTitle:Object(n.useCallback)((function(e,t){return o(function(e,t){return{type:"page/CHANGE_PAGE_TITLE",payload:{title:t,pageId:e}}}(e,t))}),[o])}};var ue=function(){var e=Z().authState.user,t=se().onChangeToggle;return Object(n.useEffect)((function(){e&&t(!0)}),[e]),e?o.a.createElement(i.a,{to:"/bklog/".concat(e.penName)}):o.a.createElement("div",{className:"auth-page w-full h-full items-center p-4 rounded overflow-hidden"},o.a.createElement(i.d,null,o.a.createElement(i.b,{path:"/auth/sign-up"},o.a.createElement(le,null)),o.a.createElement(i.b,{path:"/auth/sign-in"},o.a.createElement(oe,null))))};var de=function(){var e=Object(m.c)((function(e){return e.base})),t=Object(m.b)();return{baseState:e,onChangeMode:Object(n.useCallback)((function(){return t({type:"base/CHANGE_DARK_MODE"})}),[t])}};var pe=function(e){return o.a.createElement("div",{className:"home"},o.a.createElement(l.b,{to:"/bklog"},"bklog \uc774\ub3d9"))},fe=a(81),be=a(11);var me=function(){return{type:Ee}},ge=function(e){return{type:je,payload:e}},ke=function(e){return{type:xe,payload:e}},ye=function(e){return{type:De,payload:e}},he=function(e){return{type:Te,payload:e}},ve=function(e,t){return{type:Se,payload:{id:e,preId:t}}},Oe=function(e){return{type:Ue,payload:e}};var Ee="bklog/RESET_BKLOG",je="bklog/CLEAR_BKLOG_STATE",xe="bklog/GET_PAGE",Ie="bklog/GET_PAGE_SUCCESS",Ce="bklog/GET_PAGE_ERROR",De="bklog/ADD_PUSH_MODIFY_DATA",Te="bklog/UPDATE_BKLOG",Be="bklog/UPDATE_BKLOG_SUCCESS",Ne="bklog/UPDATE_BKLOG_ERROR",Se="bklog/UPDATE_VERSION",Le="bklog/UPDATE_VERSION_SUCCESS",we="bklog/UPDATE_VERSION_ERROR",Ue="bklog/CHANGE_UPDATE_STATE",_e=me,Re=ge,Me=ke,Pe=ye,Ae=he,Ge=ve,Fe=Oe,He=function(e,t){return D.restApi({method:"get",url:"bklog/".concat(e),withCredentials:!0,qs:t})},Ke=function(e,t){return D.restApi({method:"post",url:"bklog/".concat(e),withCredentials:!0,data:t})},Ve=f.a.mark(Xe);function Xe(e){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(be.c)({type:V});case 2:return e.next=4,Object(be.c)({type:Ee});case 4:case"end":return e.stop()}}),Ve)}var Ye={createPromiseSaga:function(e,t,a,n){var o=n||"".concat(e,"_SUCCESS"),c=a||"".concat(e,"_ERROR");return f.a.mark((function e(a){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(be.b)(t,a.payload);case 3:return n=e.sent,e.next=6,Object(be.c)({type:o,payload:n});case 6:e.next=18;break;case 8:if(e.prev=8,e.t0=e.catch(0),"AUTH"!==e.t0.type||"001"!==e.t0.code){e.next=15;break}return e.next=13,Object(be.c)({type:H,payload:a});case 13:e.next=18;break;case 15:return console.log("error",c,e.t0,new C(e.t0).get),e.next=18,Object(be.c)({type:c,payload:new C(e.t0).get});case 18:case"end":return e.stop()}}),e,null,[[0,8]])}))},allResetSaga:Xe},qe=a(6);a(40);var ze={updateObject:function(e,t){return Object.assign({},e,t)},createReducer:function(e,t){return function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e,n=arguments.length>1?arguments[1]:void 0;return t.hasOwnProperty(n.type)?t[n.type](a,n):a}},createAction:function(e){return function(t){return{type:e,payload:t}}}},Je=ze.updateObject,We=ze.createReducer,Qe=Ye.createPromiseSaga,Ze=Ye.allResetSaga;var $e={initBlockState:function(e){return{type:Tt,payload:e}},resetBlock:function(){return{type:Bt}},addBlock:function(e,t,a){return{type:St,payload:{addBlockList:e,targetPosition:t,nextEditInfo:a}}},addTextBlock:function(e,t,a,n){return{type:Lt,payload:{index:e,innerHTML:t,cursorStart:a,cursorEnd:n}}},changeEditingId:function(e){return{type:Nt,payload:e}},editBlock:function(e,t,a){return{type:wt,payload:{blockId:e,blockIndex:t,contents:a}}},commitBlock:function(){return{type:Ut}},changeBlockContents:function(e,t){return{type:_t,payload:{index:e,contents:t}}},deleteBlock:function(e,t){return{type:Rt,payload:{removedBlockList:e,nextEditInfo:t}}},deleteTextBlock:function(e,t,a){return{type:Mt,payload:{index:e,innerHTML:t,textLength:a}}},updateBlock:function(e){return{type:Pt,payload:e}},changeTextStyle:function(e,t,a,n,o){return{type:Ft,payload:{index:e,styleType:t,startPoint:a,endPoint:n,order:o}}},revertBlock:function(e){return{type:Gt,front:e}},switchBlock:function(e,t){return{type:At,payload:{changedBlockIdList:e,container:!!t}}},setClipboard:function(){return{type:Ht}},clearClipboard:function(){return{type:Kt}},setTempClip:function(e){return{type:Vt,payload:e}},clearTempClip:function(){return{type:Xt}},chageEditorState:function(e){return{type:Yt,payload:e}},changeTargetPosition:function(e){return{type:qt,payload:{targetPosition:e}}},testClipAdd:function(e){return{type:ea,payload:e}},resetEditorState:function(e){return{type:zt,payload:e}},changeFetchState:function(e){return{type:Jt,payload:e}},changeStyleType:function(e,t){return{type:Wt,payload:{blockInfo:e,styleType:t}}},clearModifyData:function(){return{type:Qt}},clearNextBlockInfo:function(){return{type:Zt}},setNextBlockInfo:function(e){return{type:$t,payload:e}}},et=a(10),tt=a(2),at=a(160),nt=function(){function e(){Object(y.a)(this,e)}return Object(h.a)(e,null,[{key:"getUUID",value:function(){var e=Object(at.a)().split("-");return e[2]+e[1]+e[0]+e[3]+e[4]}}]),e}();function ot(e){return e.map((function(e){return Object.assign({},e)}))}function ct(e){var t=e.position,a=e.type,n=e.styleType,o=e.styles,c=e.parentId,r=e.contents;return{index:0,position:t,id:nt.getUUID(),type:a||"text",styleType:n||"bk-p",parentId:c||"null",contents:r||[],styles:o||{}}}function rt(e){return function(t){return t.id===e}}function lt(e,t){var a=e.concat(),n=[],o=t.split(/-/),c=a.length-1,r=[],l=0,i=o.concat(),s=a.shift();if(!s)return console.error("resetToTargetPosition: not block"),[];for(n.push(Object.assign({},s,{position:i.join("-")})),r.push([s.position.split(/-/).length,s.id]);c;){if(!(s=a.shift()))return console.error("resetToTargetPosition: not block"),[];var u=s.position.split(/-/).length,d=[u,s.id];r[l][0]<u&&r[l][1]===s.parentId?(i.push("1"),r.push(d),l++):r[l][0]===u&&r[l-1]&&r[l-1][1]===s.parentId?r[l]=d:r[l-2]&&r[l-2][1]===s.parentId?(i.pop(),r.pop(),l--):(i=o.concat(),r=[d],l=0),n.push(Object.assign({},s,{position:i.join("-")})),c--}return n}function it(e,t){var a,n=[],o={create:[],update:[]},c=e.concat(),r=c.length,l=ot(t);null===(a=o.create)||void 0===a||a.push.apply(a,Object(tt.a)(l.map((function(e){return Xa(e.id,Object.assign({},e))}))));var i,s=l.map((function(e){return e.id})),u=Object(et.a)(l);try{for(u.s();!(i=u.n()).done;)for(var d=i.value,p=d.position,f=function(e){if(e===d.index)n.push(Wa(c[e].id)),c[e].position="null";else{if(0!==c[e].position.indexOf(p))return"break";if(!s.includes(c[e].id)){var t,a=c[e].position.split(/-/);a.pop();var r,l=null===(t=o.update)||void 0===t?void 0:t.findIndex((function(t){return t.blockId===c[e].id})),i=Xa(c[e].id,{position:c[e].position});if(void 0!==l&&-1!==l&&o.update)o.update[l]=i;else null===(r=o.update)||void 0===r||r.push(i);c[e].position=a.join("-")}}},b=d.index;b<r;b++){if("break"===f(b))break}}catch(v){u.e(v)}finally{u.f()}var m=Ba(c.filter((function(e){return"null"!==e.position})));if(m.tempData.update&&o.update){var g,k=o.update.map((function(e){return e.blockId})),y=Object(et.a)(m.tempData.update);try{for(y.s();!(g=y.n()).done;){var h=g.value;k.includes(h.blockId)||o.update.push(h)}}catch(v){y.e(v)}finally{y.f()}}return m.modifyData[0]&&n.push.apply(n,Object(tt.a)(m.modifyData)),{blockList:m.blockList,modifyData:n,tempData:o}}function st(e,t){var a,n=[],o=[],c=Object(et.a)(e);try{for(c.s();!(a=c.n()).done;){var r=a.value;t.includes(r.id)?o.push(Object.assign({},r)):n.push(Object.assign({},r))}}catch(l){c.e(l)}finally{c.f()}return[n,o]}function ut(e,t,a){var n=st(e,t),o=Object(s.a)(n,2),c=o[0],r=o[1],l=c.findIndex((function(e){return e.position===a}))+1;if(0===l)return null;var i=c.filter((function(e){return"container"===e.type})),u={create:[],update:[]},d=[],p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0",a=e.split(/-/).length-1;if(a){for(var n=t,o=0;o<a-1;o++)n="".concat(t,"-").concat(n);return n}return t}(a,"0"),f=ot(c);if(f.splice.apply(f,[l,0].concat(Object(tt.a)(lt(r,p)))),i[0]){var b,m=Object(et.a)(i);try{var g=function(){var e,t=b.value,a=f.findIndex((function(e){return e.id===t.id}))+1;f[a]&&0===f[a].position.indexOf(t.position)||(f.splice(a,1),null===(e=u.create)||void 0===e||e.push(Xa(t.id,Object.assign({},t))),d.push(Wa(t.id)))};for(m.s();!(b=m.n()).done;)g()}catch(h){m.e(h)}finally{m.f()}}var k,y=Ba(f);y.tempData.update&&(null===(k=u.update)||void 0===k||k.push.apply(k,Object(tt.a)(y.tempData.update)));return d.push.apply(d,Object(tt.a)(y.modifyData)),{blockList:y.blockList,modifyData:d,tempData:u}}var dt={copyToNewObjectArray:ot,createBlockData:ct,resetToTargetPosition:lt,reissueBlockId:function(e){return e.map((function(e){return Object.assign({},e,{id:nt.getUUID()})}))},addToStage:function(e,t,a,n){var o=e.filter((function(e){return e.id!==t})),c={id:t,blockIndex:a,contents:n};return o[0]?[].concat(Object(tt.a)(o),[c]):[c]},updateBlockContents:function(e,t){var a,n=e.concat(),o={update:[]},c=[],r=Object(et.a)(t);try{for(r.s();!(a=r.n()).done;){var l=a.value,i=l.blockIndex,s=l.id,u=l.contents;if(n[i]&&s===n[i].id){if("text"===n[i].type||"title"===n[i].type){var d,p="string"===typeof n[i].contents?n[i].contents:n[i].contents.concat();null===(d=o.update)||void 0===d||d.push(Xa(n[i].id,{contents:p})),n[i].contents="string"===typeof u?Ia(u):u,c.push(Ja(n[i].id,{contents:n[i].contents}))}}else console.log("block\uc774 \uc81c\ub300\ub85c \uc815\ub82c\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4.")}}catch(f){r.e(f)}finally{r.f()}return{blockList:n,modifyData:c,tempData:o}},changeBlockTextStyle:function(e,t,a,n,o,c){var r,l={update:[]},i=[],s=e.concat();if("text"!==s[t].type&&"title"!==s[t].type)return console.log("text block\uc774 \uc544\ub2d9\ub2c8\ub2e4."),null;var u="string"===typeof s[t].contents?s[t].contents:s[t].contents.concat();null===(r=l.update)||void 0===r||r.push(Xa(s[t].id,{contents:u}));var d=xa(s[t],a,n,o,c);return i.push(Ja(d.id,{contents:d.contents})),s[t]=d,{blockList:s,modifyData:i,tempData:l}},addBlockInList:function(e,t,a){var n,o=[],c={delete:[],update:[]},r=e.concat(),l=r.findIndex((function(e){return e.position===a}));r.splice.apply(r,[l,1,e[l]].concat(Object(tt.a)(lt(t,a))));var i=Ba(r);o.push.apply(o,Object(tt.a)(t.map((function(e){return za(e)}))).concat(Object(tt.a)(i.modifyData)));var s=t.map((function(e){return e.id}));if(null===(n=c.delete)||void 0===n||n.push.apply(n,Object(tt.a)(s.map((function(e){return Xa(e)})))),i.tempData.update){var u,d=i.tempData.update.filter((function(e){return!s.includes(e.blockId)}));null===(u=c.update)||void 0===u||u.push.apply(u,Object(tt.a)(d))}return{blockList:i.blockList,tempData:c,modifyData:o}},removeBlockInList:it,removeTextBlockInList:function(e,t,a,n){if("text"!==e[a].type)return null;var o=e.concat(),c=Ia(n),r=o[a].id,l=o[a].contents.concat(),i=Da(o[a].contents,c);o[a].contents=i;var s=it(o,[o[t]]),u=s.blockList,d=s.tempData,p=s.modifyData,f=d.update.findIndex((function(e){return e.blockId===r})),b=p.findIndex((function(e){return e.blockId===r}));return-1!==f?d.update[f]=Je(d.update[f],{contents:l}):d.update.push(Xa(r,{contents:l})),-1!==b?p[b]=Je(p[b],{contents:i}):p.push(Ya("update","block",r,{contents:i})),{blockList:u,tempData:d,modifyData:p}},changeBlockPosition:ut,switchBlockList:function(e,t,a,n){var o={},c=[],r=ot(e),l=t.concat(),i=a;if(n){var s=ct({position:a,type:"container",styleType:"bk-container"}),u=r.findIndex((function(e){return e.position===a}));r.splice(u,0,s),i=a.split(/-/).concat("1").join("-"),r[u+1].position=i,o.delete=[Xa(s.id)],c.push(za(s))}var d=ut(r,l,i);return d?(d.tempData.update&&(o.update=d.tempData.update),c=c.concat(d.modifyData),{blockList:d.blockList,tempData:o,modifyData:c}):null},restoreBlock:function(e,t){console.log(e,t);var a={},n=[],o=e.concat();if(t.update){a.update=[];var c,r=Object(et.a)(t.update);try{for(r.s();!(c=r.n()).done;){for(var l=c.value,i=o.findIndex(rt(l.blockId)),u={},d=0,p=Object.entries(o[i]);d<p.length;d++){var f=Object(s.a)(p[d],2),b=f[0],m=f[1];l.payload[b]&&(u[b]=m)}a.update.push(Xa(o[i].id,u)),n.push(Ja(o[i].id,l.payload)),o[i]=Object.assign({},o[i],l.payload)}}catch(I){r.e(I)}finally{r.f()}}if(t.delete){var g,k=t.delete.map((function(e){return e.blockId})),y=st(o,k),h=Object(s.a)(y,2),v=h[0],O=h[1];o=v,null===(g=a.create)||void 0===g||g.push.apply(g,Object(tt.a)(O.map((function(e){return Xa(e.id,e)})))),n.push.apply(n,Object(tt.a)(k.map((function(e){return Wa(e)}))))}if(t.create){var E,j=t.create.map((function(e){return e.payload}));a.delete=t.create.map((function(e){return Xa(e.blockId)})),n.push.apply(n,Object(tt.a)(j.map((function(e){return za(e)})))),(E=o).push.apply(E,Object(tt.a)(j))}var x=Ba(Ta(o));return(x.modifyData[0]||x.tempData.update&&x.tempData.update[0])&&(console.log("\ud655\uc778 \ud544\uc694"),console.log(x)),{blockList:x.blockList,modifyData:n,tempData:a}},changeBlockStyleType:function(e,t,a){var n,o="number"===typeof t?t:e.findIndex(rt(t));if(!e[o])return null;var c=e.concat(),r={update:[]},l=[];return null===(n=r.update)||void 0===n||n.push({blockId:c[o].id,payload:{styleType:c[o].styleType}}),c[o].styleType=a,l.push(Ja(c[o].id,{styleType:a})),{blockList:c,tempData:r,modifyData:l}},updateBlockData:function(e,t){var a={},n=e.concat();if(t.update){a.update=[];var o,c=Object(et.a)(t.update);try{for(c.s();!(o=c.n()).done;){var r=o.value;if("block"===r.set){var l=n.findIndex(rt(r.blockId)),i={};if(-1!==l){for(var u=0,d=Object.entries(n[l]);u<d.length;u++){var p=Object(s.a)(d[u],2),f=p[0],b=p[1];r.payload[f]&&(i[f]=b)}a.update.push(Xa(n[l].id,i)),n[l]=Object.assign({},n[l],r.payload)}}else r.set}}catch(N){c.e(N)}finally{c.f()}}if(t.delete){var m=t.delete.blockIdList?t.delete.blockIdList:null;t.delete.commentIdList&&t.delete.commentIdList;if(m){var g,k=st(n,m),y=Object(s.a)(k,2),h=y[0],v=y[1];n=h,null===(g=a.create)||void 0===g||g.push.apply(g,Object(tt.a)(v.map((function(e){return Xa(e.id,e)}))))}}if(t.create){var O=t.create.filter((function(e){return"block"===e.set}));a.delete=[];var E,j=Object(et.a)(O);try{var x=function(){var e=E.value;a.delete.push(Xa(e.blockId));var t=n.findIndex((function(t){return t.id===e.blockId}));-1!==t?n[t]=Je(e.payload,{position:n[t].position}):n.push(e.payload)};for(j.s();!(E=j.n()).done;)x()}catch(N){j.e(N)}finally{j.f()}}var I=Ba(Ta(n));if((I.modifyData[0]||I.tempData.update&&I.tempData.update[0])&&(console.log("\ud655\uc778 \ud544\uc694"),console.log(I),I.tempData.update&&I.tempData.update[0])){a.update||(a.update=[]);var C,D=Object(et.a)(I.tempData.update);try{for(D.s();!(C=D.n()).done;){var T=C.value,B=a.update.findIndex((function(e){return e.blockId===e.blockId}));-1!==B?a.update[B].payload=Je(a.update[B].payload,T.payload):a.update.push(T)}}catch(N){D.e(N)}finally{D.f()}}return{blockList:I.blockList,modifyData:I.modifyData,tempData:a}}};function pt(e){switch(e){case"bk-bold":return"b";case"bk-italic":return"i";case"bk-underbar":return"_";case"color":return"fc";case"background-color":return"bc";case"border-bottom":return"_";default:return null}}function ft(e){switch(e){case"700":return"b";case"italic":return"i";default:return e}}function bt(e,t){for(var a,n=e[t],o=t+1,c=e.length;" "!==e[o]&&"&"!==e[o]&&o<c&&(n+=e[o],";"!==e[o]);)o++;if(";"===e[o])switch(n){case"&quot;":a='"';break;case"&amp;":a="&";break;case"&lt;":a="<";break;case"&gt;":a=">";break;case"&nbsp;":a=" ";break;case"&iexcl;":a="\xa1";break;case"&cent;":a="\uffe0";break;case"&pound;":a="\uffe1";break;case"&curren;":a="\xa4";break;case"&yen;":a="\uffe5";break;case"&brvbar;":a="|";break;case"&sect;":a="\xa7";break;case"&uml;":a="\xa8";break;case"&copy;":a="\u24d2";break;case"&ordf;":a="\xaa";break;case"&laquo;":a="\u226a";break;case"&not;":a="\uffe2";break;case"&shy;":a="-";break;case"&reg;":a="?";break;case"&macr;":a=n;break;case"&deg;":a="\xb0";break;case"&plusmn;":a="\xb1";break;case"&sup1;":a="\xb9";break;case"&sup2;":a="\xb2";break;case"&sup3;":a="\xb3";break;case"&acute;":a="\xb4";break;case"&micro;":a="\u03bc";break;case"&para;":a="\xb6";break;case"&middot;":a="\xb7";break;case"&cedil;":a="\xb8";break;case"&ordm;":a="\xba";break;case"&raquo;":a="\u226b";break;case"&frac14;":a="\xbc";break;case"&frac12;":a="\xbd";break;case"&frac34;":a="\xbe";break;case"&iquest;":a="\xbf";break;case"&Agrave;":case"&Aacute;":case"&Acirc;":case"&Atilde;":case"&Auml;":case"&Aring;":a="A";break;case"&AElig;":a="\xc6";break;case"&Ccedil;":a="C";break;case"&Egrave;":case"&Eacute;":case"&Ecirc;":case"&Euml;":a="E";break;case"&Igrave;":case"&Iacute;":case"&Icirc;":case"&Iuml;":a="I";break;case"&ETH;":a="\xd0";break;case"&Ntilde;":a="N";break;case"&Ograve;":case"&Oacute;":case"&Ocirc;":case"&Otilde;":case"&Ouml;":a="O";break;case"&times;":a="\xd7";break;case"&Oslash;":a="\xd8";break;case"&Ugrave;":case"&Uacute;":case"&Ucirc;":case"&Uuml;":a="U";break;case"&Yacute;":a="Y";break;case"&THORN;":a="\xde";break;case"&szlig;":a="\xdf";break;case"&agrave;":case"&aacute;":case"&acirc;":case"&atilde;":case"&auml;":case"&aring;":a="a";break;case"&aelig;":a="\xe6";break;case"&ccedil;":a="c";break;case"&egrave;":case"&eacute;":case"&ecirc;":case"&euml;":a="e";break;case"&igrave;":case"&iacute;":case"&icirc;":case"&iuml;":a="i";break;case"&eth;":a="\xf0";break;case"&ntilde;":a="n";break;case"&ograve;":case"&oacute;":case"&ocirc;":case"&otilde;":case"&ouml;":a="o";break;case"&divide;":a="\xf7";break;case"&oslash;":a="\xf8";break;case"&ugrave;":case"&uacute;":case"&ucirc;":case"&uuml;":a="u";break;case"&yacute;":a="y";break;case"&thorn;":a="\xfe";break;case"&yuml;":a="y";break;default:a=n}else a=e[t],o=t;return{word:a,count:o}}function mt(e,t){if(!e&&!t)return!0;if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(var a=[],n=0;n<e.length;n++){var o=JSON.stringify(e[n]);if(n){for(var c=a.length,r=0;r<a.length;r++)if(a[r]===o){a.splice(r,1);break}if(c===a.length)return!1}else{for(var l=0;l<t.length;l++){var i=JSON.stringify(t[l]);o===i||a.push(i)}if(a.length===t.length)return!1}}return!a.length}function gt(e,t){for(var a=0;a<e.length;a++)if(e[a][0]===t[0])return a;return-1}function kt(e,t,a,n){var o=0,c=["",[]],r=[];return e.forEach((function(e){for(var l=0;l<e[0].length;l++)o===t||o+1===a||o>=t&&o<a&&0===l?-1===gt(c[1],n)?(c[0]&&r.push(c),c=e[1]?-1!==gt(e[1],n)?["",Object(tt.a)(e[1])]:["",[].concat(Object(tt.a)(e[1]),[n])]:["",[n]]):e[1]?-1!==gt(e[1],n)?mt(c[1],e[1])||(r.push(c),c=["",Object(tt.a)(e[1])]):mt(c[1],[].concat(Object(tt.a)(e[1]),[n]))||(r.push(c),c=["",[].concat(Object(tt.a)(e[1]),[n])]):mt(c[1],[n])||(r.push(c),c=["",[n]]):o!==a&&0!==l||mt(c[1],e[1]?e[1]:[])||(c[0]&&r.push(c),c=e[1]?["",Object(tt.a)(e[1])]:["",[]]),c[0]+=e[0][l],o++})),r.push(c),r.map((function(e){return e[1][0]?e:[e[0]]}))}function yt(e,t,a,n){var o=0,c=["",[]],r=[];return e.forEach((function(e){for(var l=0;l<e[0].length;l++){if(o===t||o+1===a||o>t&&o<a&&0===l){var i=void 0;if(e[1])if(mt(c[1],e[1])){if(-1!==(i=gt(c[1],n))){r.push(c);var s=Object(tt.a)(c[1]);s.splice(i,1),c=["",Object(tt.a)(s)]}}else{var u=gt(e[1],n),d=Object(tt.a)(e[1]);if(-1!==(i=gt(c[1],n))){c[0]&&r.push(c);var p=Object(tt.a)(c[1]);console.log("new style",p),-1!==u?(d.splice(u,1),c=["",Object(tt.a)(d)]):c=["",Object(tt.a)(e[1])]}else-1!==u?(d.splice(u,1),mt(c[1],d)||(c[0]&&r.push(c),c=["",Object(tt.a)(d)])):mt(c[1],e[1])||(c[0]&&r.push(c),c=["",Object(tt.a)(e[1])])}else c[1][0]&&(r.push(c),c=["",[]])}else o!==a&&0!==l||mt(c[1],e[1]?e[1]:[])||(c[0]&&r.push(c),c=e[1]?["",Object(tt.a)(e[1])]:["",[]]);c[0]+=e[0][l],o++}})),c[0]&&r.push(c),r.map((function(e){return e[1][0]?e:[e[0]]}))}var ht={parseHtmlContents:function(e){for(var t=[],a=e.length,n=!0,o=[],c=!1,r=!1,l=[],i=null,s=[],u=0;u<a;u++)if(c||r)if(c)switch(e[u]){case":":i&&(s=[pt(i)],i=null);break;case";":s&&i&&(s.push(ft(i)),s[0]||s.shift(),"_"===s[0]&&s.pop(),l.push(s),s=[],i=null);break;case" ":i&&!s[0]&&(s=[pt(i)],l.push(s),s=[],i=null);break;case'"':i&&(s=[pt(i)])&&l.push(s),o[1]?o[1]=[].concat(Object(tt.a)(o[1]),Object(tt.a)(l)):(o=[o[0]])[1]=Object(tt.a)(l),l=[],c=!1,i=null,s=[];break;default:i?i+=e[u]:i=e[u]}else r&&("'"===e[u]||'"'===e[u]?(o[1]?o[1].push(["a",i]):o=[o[0],[["a",i]]],i=null,r=!1):i?i+=e[u]:i=e[u]);else switch(e[u]){case"<":!u||"/"!==e[u+1]||">"!==e[u+6]&&"a"!==e[u+2]?(n=!1,void 0!==o[0]&&(t.push(o),o=[]),"s"===e[u+1]?u+=4:"a"===e[u+1]&&(u+=1)):(o[0]&&(t.push(o),o=[]),">"===e[u+6]?u+=6:u+=3,n=!0);break;case">":n=!0;break;case"s":n?o[0]?o[0]+=e[u]:o[0]=e[u]:"t"===e[u+1]&&"="===e[u+5]&&(u+=6,c=!0);break;case"c":n?o[0]?o[0]+=e[u]:o[0]=e[u]:"l"===e[u+1]&&"="===e[u+5]&&(u+=6,c=!0);break;case"h":n?o[0]?o[0]+=e[u]:o[0]=e[u]:"r"===e[u+1]&&"f"===e[u+3]&&(u+=5,r=!0);break;case"&":var d=bt(e,u),p=d.word;u=d.count,o[0]?o[0]+=p:o[0]=p;break;case"f":if(n)o[0]?o[0]+=e[u]:o[0]=e[u];else if("<"===e[u-1])for(;">"!==e[u+1];)u++;break;default:n&&(o[0]?o[0]+=e[u]:o[0]=e[u])}return o[0]&&t.push(o),t},addContentsStyle:kt,deleteContentsStyle:yt,changeStyleTextContents:function(e,t,a,n,o){var c;switch(o){case"add":c=kt(e.contents,a,n,t);break;case"del":c=yt(e.contents,a,n,t);break;case"color":case"link":c=kt(yt(e.contents,a,n,t),a,n,t);break;default:c=e.contents}return Object.assign({},e,{contents:c})},sliceTextContents:function(e,t,a){var n=0,o=null,c=[],r=[];if(0===t&&0===a)return[c,e];var l,i=Object(et.a)(e);try{for(i.s();!(l=i.n()).done;)for(var s=l.value,u=s[0].length-1,d=0;d<=u;d++)n<t||n>a?(o?0===d&&o[1]&&s[1]&&!mt(o[1],s[1])&&(r.push(o),o=["",s[1]]):o=s[1]?["",s[1]]:[""],o[0]+=s[0][d],d===u&&o&&(n<t?c.push(o):r.push(o),o=null)):(n===t&&o&&(c.push(o),o=null),n===a&&(o=s[1]?[s[0][d],s[1]]:[s[0][d]])),n++}catch(p){i.e(p)}finally{i.f()}return o&&r.push(o),[c,r]},mergeTextContents:function(e,t){var a=e.concat(),n=t.concat(),o=a.pop(),c=n.shift();return o?(mt(o[1]?o[1]:[],c[1]?c[1]:[])?(o[0]+=c[0],a.push.apply(a,[o].concat(Object(tt.a)(n)))):(a.push.apply(a,[o,c].concat(Object(tt.a)(n))),console.log("1",o,c,n)),a):t}};function vt(e){return e.concat().sort((function(e,t){if(e.position===t.position)return 0;for(var a=e.position.split(/-/),n=t.position.split(/-/),o=0;a[o]&&n[o];){var c=Number(a[o]),r=Number(n[o]);if(c>r)return 1;if(c<r)return-1;o++}return a[o]||n[o]?a[o]?1:-1:0}))}function Ot(e){var t=La(e),a=[],n={update:[]},o=[],c=t.length-1;if(-1===c)return{blockList:[],modifyData:o,tempData:n};var r,l=[],i=0,s=1,u=[1],d=0;(l.push(t[0].id),a.push(Object.assign({},t[0],{index:0,parentId:"root",position:"1"})),"1"!==t[0].position)&&(null===(r=n.update)||void 0===r||r.push(Xa(t[0].id,{position:t[0].position})),o.push(Ja(t[0].id,{position:"1"})));for(t.shift();c;){var p=t.shift();if(!p)return console.log("not block",t,e),{blockList:[],modifyData:o,tempData:n};var f=p.position.split(/-/).length-1;if(d===f)l[i]=p.id,u[d]++;else if(d<f)l.push(p.id),i++,u.push(1),d++;else{for(var b=0;b<=d-f;b++)u.pop(),d--,l.pop(),i--;u[d]++,l[i]=p.id}var m,g=u.join("-");if(g!==p.position)null===(m=n.update)||void 0===m||m.push(Xa(p.id,{position:p.position})),o.push(Ja(p.id,{position:g}));a.push(Object.assign({},p,{index:s,parentId:i?l[i-1]:"root",position:g})),c--,s++}return{blockList:a,tempData:n,modifyData:o}}var Et=function(e,t){return e.hasOwnProperty([t.parentId])||(e[t.parentId]=[]),e[t.parentId].push(t),e};var jt={sortBlock:vt,orderingBlock:Ot,initBlock:function(e){return Ot(vt(e))},setBlockList:function(e){return e[0]?e.reduce(Et,{}):null}};function xt(e,t,a,n){return{command:e,set:t,blockId:a,payload:n}}var It=function(e,t){switch(t.command){case"create":e.create.push(t);break;case"update":e.update.push(t);break;case"delete":"block"===t.set?e.delete.blockIdList.push(t.blockId):"comment"===t.set&&e.delete.commentIdList.push(t.payload)}return e};var Ct,Dt={tempDataPush:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,n=[].concat(Object(tt.a)(e),[t]);return a<n.length&&n.shift(),n},getContentsToBeChanged:function(e,t){var a,n=[],o=Object(et.a)(t);try{for(o.s();!(a=o.n()).done;){var c=a.value;"text"===e[c.blockIndex].type&&n.push(e[c.blockIndex])}}catch(r){o.e(r)}finally{o.f()}return n.map((function(e){return{id:e.id,contents:e.contents?e.contents:null,blockIndex:e.index}}))},createTempData:function(e,t){return{blockId:e,payload:t}},createModifyData:xt,setCreateModifyDataOfBlock:function(e){return xt("create","block",e.id,Je(e,{index:void 0,parentId:void 0}))},setDeleteModifyDataOfBlock:function(e){return xt("delete","block",e)},setUpdateModifyDataOfBlock:function(e,t){return xt("update","block",e,t)},updateModifyData:function(e,t){if(!t[0])return e;var a,n=Object(tt.a)(e),o=Object(et.a)(t);try{var c=function(){var e=a.value,t=n.findIndex((function(t){return t.blockId===e.blockId}));if(-1!==t){var o=n[t],c=o.command,r=o.blockId,l=o.set,i=o.payload;l===e.set?"create"===c&&"delete"===e.command?n.splice(t,1):n[t]={blockId:r,set:l,command:"create"===c&&"update"===e.command?"create":e.command,payload:i?Object.assign({},i,e.payload):e.payload}:"block"!==l&&"delete"!==c&&n.push(e)}else n.push(e)};for(o.s();!(a=o.n()).done;)c()}catch(r){o.e(r)}finally{o.f()}return n},convertModifyData:function(e){var t=e.reduce(It,{create:[],update:[],delete:{blockIdList:[],commentIdList:[]}});return t.create[0]||(t.create=void 0),t.update[0]||(t.update=void 0),t.delete.blockIdList[0]||(t.delete.blockIdList=void 0),t.delete.commentIdList[0]||(t.delete.commentIdList=void 0),t.delete.blockIdList||t.delete.commentIdList||(t.delete=void 0),t},replaceModifyData:function(e,t){if(!e[0])return[];var a=t.update?t.update:null,n=t.create?t.create:null,o=t.delete?t.delete:null,c=e.concat();if(o){var r=o.blockIdList?o.blockIdList:null;o.commentIdList&&o.commentIdList;r&&(c=c.filter((function(e){return!r.includes(e.blockId)||"block"!==e.set})))}if(a&&c[0]){var l,i=Object(et.a)(a);try{var u=function(){var e=l.value;if(!c[0])return"break";var t=c.findIndex((function(t){return t.blockId===e.blockId&&t.set===e.set}));if(console.log(e,t),-1!==t&&"delete"!==c[t].command){for(var a=!0,n=0,o=Object.entries(c[t].payload);n<o.length;n++){var r=Object(s.a)(o[n],2),i=r[0];r[1];e.payload[i]?(c[t].payload[i]=void 0,delete c[t].payload[i]):a=!1}a&&c.splice(t,1)}};for(i.s();!(l=i.n()).done;){if("break"===u())break}}catch(b){i.e(b)}finally{i.f()}}if(n&&c[0]){var d,p=Object(et.a)(n);try{var f=function(){var e=d.value,t=c.findIndex((function(t){return t.blockId===e.blockId&&t.set===e.set}));-1!==t&&c.splice(t,1)};for(p.s();!(d=p.n()).done;)f()}catch(b){p.e(b)}finally{p.f()}}return c}},Tt="INIT_BLOCK_STATE",Bt="RESET_BLOCK",Nt="CHANGE_EDITING_ID",St="ADD_BLOCK",Lt="ADD_TEXT_BLOCK",wt="EDIT_BLOCK",Ut="COMMIT_BLOCK",_t="CHANGE_BLOCK_CONTENTS",Rt="DELETE_BLOCK",Mt="DELETE_TEXT_BLOCK",Pt="UPDATE_BLOCK",At="SWITCH_BLOCK",Gt="REVERT_BLOKC",Ft="CHANGE_TEXT_STYLE",Ht="SET_CLIPBOARD",Kt="CLEAR_CLIPBOARD",Vt="SET_TEMPCLIP",Xt="CLEAR_TEMPCLIP",Yt="CHANGE_EDITOR_STATE",qt="CHANGE_TARGET_POSITION",zt="EDITOR_STATE_RESET",Jt="CHANGE_FETCH_STATE",Wt="CHANGE_STYLE_TYPE",Qt="CLEAR_MODIFYDATA",Zt="CLEAR_NEXTBLOCKINFO",$t="CLEAR_NEXTBLOCKINFO",ea="TEST_CLIPBOARD",ta=$e.initBlockState,aa=$e.addBlock,na=$e.addTextBlock,oa=$e.changeEditingId,ca=$e.editBlock,ra=$e.commitBlock,la=$e.changeBlockContents,ia=$e.deleteBlock,sa=$e.deleteTextBlock,ua=$e.updateBlock,da=$e.changeTextStyle,pa=$e.revertBlock,fa=$e.switchBlock,ba=$e.clearClipboard,ma=$e.setTempClip,ga=$e.chageEditorState,ka=$e.changeTargetPosition,ya=$e.resetEditorState,ha=$e.changeFetchState,va=$e.changeStyleType,Oa=$e.clearModifyData,Ea=$e.clearNextBlockInfo,ja=$e.setNextBlockInfo,xa=ht.changeStyleTextContents,Ia=ht.parseHtmlContents,Ca=ht.sliceTextContents,Da=ht.mergeTextContents,Ta=jt.sortBlock,Ba=jt.orderingBlock,Na=jt.initBlock,Sa=jt.setBlockList,La=dt.copyToNewObjectArray,wa=dt.createBlockData,Ua=dt.updateBlockContents,_a=dt.changeBlockTextStyle,Ra=dt.addToStage,Ma=dt.addBlockInList,Pa=dt.removeBlockInList,Aa=dt.removeTextBlockInList,Ga=dt.switchBlockList,Fa=dt.restoreBlock,Ha=dt.changeBlockStyleType,Ka=dt.updateBlockData,Va=Dt.tempDataPush,Xa=Dt.createTempData,Ya=Dt.createModifyData,qa=Dt.updateModifyData,za=Dt.setCreateModifyDataOfBlock,Ja=Dt.setUpdateModifyDataOfBlock,Wa=Dt.setDeleteModifyDataOfBlock,Qa=Dt.convertModifyData,Za=Dt.replaceModifyData;var $a=(Ct={},Object(qe.a)(Ct,Tt,(function(e,t){var a=t.payload,n=Na(a),o=n.blockList,c=n.modifyData;return Je(e,Je(en,{blockList:o,modifyData:c,isFetch:!!c[0]}))})),Object(qe.a)(Ct,Bt,(function(e,t){return en})),Object(qe.a)(Ct,Nt,(function(e,t){var a=t.payload;return Je(e,"string"===typeof a?{editingBlockId:a}:void 0===a?{editingBlockId:null}:{editingBlockId:e.blockList[a]?e.blockList[a].id:null})})),Object(qe.a)(Ct,wt,(function(e,t){var a=t.payload,n=a.blockId,o=a.blockIndex,c=a.contents;return Je(e,{stage:Ra(e.stage,n,o,c)})})),Object(qe.a)(Ct,Ut,(function(e,t){if(!e.stage[0])return e;var a=Ua(e.blockList,e.stage),n=a.blockList,o=a.modifyData,c=a.tempData;return c.editingBlockId=e.editingBlockId,Je(e,{blockList:n,stage:[],modifyData:qa(e.modifyData,o),tempBack:Va(e.tempBack,c),isFetch:!0})})),Object(qe.a)(Ct,_t,(function(e,t){var a=t.payload,n=a.index,o=a.contents,c=e.blockList.concat(),r={editingBlockId:e.editingBlockId,update:[Xa(c[n].id,{contents:c[n].contents.concat()})]},l=[Ya("update","block",c[n].id,{contents:o})];return c[n].contents=o,Je(e,{blockList:c,tempBack:Va(e.tempBack,r),modifyData:qa(e.modifyData,l)})})),Object(qe.a)(Ct,St,(function(e,t){var a=t.payload,n=a.addBlockList,o=a.targetPosition,c=a.nextEditInfo,r=Ma(e.blockList,n,o),l=r.blockList,i=r.modifyData,s=r.tempData;s.editingBlockId=e.editingBlockId;var u=void 0!==c?"string"===typeof c?c:l[c].id:null;return Je(e,{blockList:l,editingBlockId:u,modifyData:qa(e.modifyData,i),tempBack:Va(e.tempBack,s),tempFront:[],isFetch:!0})})),Object(qe.a)(Ct,Lt,(function(e,t){var a=t.payload,n=a.index,o=a.innerHTML,c=a.cursorStart,r=a.cursorEnd,l=Ca(Ia(o),c,r),i=Object(s.a)(l,2),u=i[0],d=i[1],p=e.blockList[n],f=p.contents.concat();p.contents=u;var b=e.stage[0]?e.stage.filter((function(e){return e.id!==p.id})):[],m=wa({position:p.position,type:p.type,styleType:p.styleType,contents:d}),g=Ma(e.blockList,[m],m.position),k=g.blockList,y=g.tempData,h=g.modifyData;y.editingBlockId=e.editingBlockId;var v=y.update.findIndex((function(e){return e.blockId===p.id}));return-1!==v?y.update[v].payload=Je(y.update[v].payload,{contents:f}):y.update.push(Xa(p.id,{contents:f})),h.push(Ya("update","block",p.id,{contents:u})),Je(e,{blockList:k,stage:b,editingBlockId:m.id,tempBack:Va(e.tempBack,y),modifyData:qa(e.modifyData,h),isFetch:!0})})),Object(qe.a)(Ct,Rt,(function(e,t){var a=t.payload,n=a.removedBlockList,o=a.nextEditInfo,c=Pa(e.blockList,n),r=c.blockList,l=c.modifyData,i=c.tempData;i.editingBlockId=e.editingBlockId;var s=void 0!==o?"string"===typeof o?o:r[o].id:null,u=n.map((function(e){return e.id}));return Je(e,{blockList:r,editingBlockId:s,stage:e.stage?e.stage.filter((function(e){return!u.includes(e.id)})):[],tempBack:Va(e.tempBack,i),tempFront:[],modifyData:qa(e.modifyData,l),isFetch:!0})})),Object(qe.a)(Ct,Mt,(function(e,t){var a=t.payload,n=a.index,o=a.innerHTML,c=a.textLength,r=Je(e.blockList[n],{}),l=n?e.blockList[n-1].id:e.blockList[0].id;if(o){if(0===n)return e;var i=Aa(e.blockList,n,n-1,o);if(!i)return e;var s=i.blockList,u=i.tempData,d=i.modifyData,p=e.stage[0]?e.stage.filter((function(e){return e.id!==r.id})):[];return Je(e,{blockList:s,editingBlockId:l,nextBlockInfo:{type:"text",payload:["delete",c]},tempBack:Va(e.tempBack,u),modifyData:qa(e.modifyData,d),tempFront:[],stage:p,isFetch:!0})}if(o)return e;var f=Pa(e.blockList.concat(),[e.blockList[n]]),b=f.blockList,m=f.tempData,g=f.modifyData;return Je(e,{blockList:b,editingBlockId:l,tempBack:Va(e.tempBack,m),tempFront:[],modifyData:qa(e.modifyData,g),isFetch:!0})})),Object(qe.a)(Ct,Ft,(function(e,t){var a=t.payload,n=a.index,o=a.styleType,c=a.startPoint,r=a.endPoint,l=a.order,i=_a(e.blockList,n,o,c,r,l);return i?(i.tempData.editingBlockId=e.editingBlockId,Je(e,{blockList:i.blockList,modifyData:qa(e.modifyData,i.modifyData),tempFront:[],tempBack:Va(e.tempBack,i.tempData),isFetch:!0})):e})),Object(qe.a)(Ct,At,(function(e,t){var a=t.payload,n=a.changedBlockIdList,o=a.container;if(!e.targetPosition)return e;var c=Ga(e.blockList,n,e.targetPosition,o);if(!c)return Je(e,{tempClipData:[],isGrab:!1,isHoldingDown:!1});var r=c.blockList,l=c.tempData,i=c.modifyData;return l.editingBlockId=e.editingBlockId,Je(e,{isGrab:!1,isHoldingDown:!1,editingBlockId:e.blockList[e.tempClipData[0]].id,blockList:r,modifyData:qa(e.modifyData,i),tempFront:[],tempBack:Va(e.tempBack,l),tempClipData:[],isFetch:!0})})),Object(qe.a)(Ct,Gt,(function(e,t){var a=t.front;if(console.log("revert",e),!a&&e.tempBack[0]){var n=e.tempBack.length-1,o=e.tempBack[n].editingBlockId?e.tempBack[n].editingBlockId:null,c=Fa(e.blockList,e.tempBack[n]),r=c.blockList,l=c.tempData,i=c.modifyData,s=e.tempBack.concat();return s.pop(),l.editingBlockId=e.editingBlockId,console.log(s),Je(e,{editingBlockId:o,blockList:r,tempBack:s,tempFront:Va(e.tempFront,l),modifyData:qa(e.modifyData,i),isFetch:!0})}if(e.tempFront[0]){var u=e.tempFront.length-1,d=e.tempFront[u].editingBlockId?e.tempFront[u].editingBlockId:null,p=Fa(e.blockList,e.tempFront[u]),f=p.blockList,b=p.tempData,m=p.modifyData,g=e.tempFront.concat();return g.pop(),b.editingBlockId=e.editingBlockId,console.log(g),Je(e,{blockList:f,editingBlockId:d,tempFront:g,tempBack:Va(e.tempBack,b),modifyData:qa(e.modifyData,m),isFetch:!0})}return e})),Object(qe.a)(Ct,Yt,(function(e,t){var a=t.payload,n=a.isGrab,o=a.isHoldingDown,c=a.isCliping;return Je(e,{isGrab:void 0!==n?n:e.isGrab,isCliping:void 0!==c?c:e.isCliping,isHoldingDown:void 0!==o?o:e.isHoldingDown})})),Object(qe.a)(Ct,qt,(function(e,t){var a=t.payload.targetPosition;return Je(e,{targetPosition:a||null})})),Object(qe.a)(Ct,Vt,(function(e,t){var a=t.payload;return Je(e,{tempClipData:e.tempClipData.concat(a)})})),Object(qe.a)(Ct,Kt,(function(e,t){return Je(e,{tempClipData:[]})})),Object(qe.a)(Ct,zt,(function(e,t){var a=t.payload;return Je(e,{isCliping:!a&&e.isCliping,isHoldingDown:!1,isGrab:!1,tempClipData:[],targetPosition:null})})),Object(qe.a)(Ct,Jt,(function(e,t){var a=t.payload;return Je(e,{isFetch:!!a})})),Object(qe.a)(Ct,Wt,(function(e,t){var a=t.payload,n=a.blockInfo,o=a.styleType,c=Ha(e.blockList,n,o);if(c){var r=c.blockList,l=c.modifyData,i=c.tempData;return i.editingBlockId=e.editingBlockId,Je(e,{blockList:r,isFetch:!0,tempBack:Va(e.tempBack,i),modifyData:qa(e.modifyData,l)})}return e})),Object(qe.a)(Ct,Qt,(function(e,t){return Je(e,{modifyData:[]})})),Object(qe.a)(Ct,Pt,(function(e,t){var a=t.payload,n=Ka(e.blockList,a),o=n.blockList,c=n.tempData,r=n.modifyData;return c.editingBlockId=e.editingBlockId,Je(e,{blockList:o,tempBack:Va(e.tempBack,c),modifyData:r[0]?qa(Za(e.modifyData,a),r):Za(e.modifyData,a)})})),Object(qe.a)(Ct,Zt,(function(e,t){return Je(e,{nextBlockInfo:null})})),Object(qe.a)(Ct,$t,(function(e,t){var a=t.payload;return Je(e,{nextBlockInfo:a})})),Ct),en={isFetch:!1,isGrab:!1,isHoldingDown:!1,isCliping:!1,targetPosition:null,blockList:[],editingBlockId:null,nextBlockInfo:null,stage:[],modifyData:[],tempBack:[],tempFront:[],tempClipData:[],clipBoard:[]},tn=We(en,$a);var an=function(){var e=Object(n.useReducer)(tn,en),t=Object(s.a)(e,2),a=t[0],o=t[1],c=Object(n.useMemo)((function(){return Sa(a.blockList)}),[a.blockList]),r=Object(n.useMemo)((function(){return a.blockList.length}),[a.blockList]),l=Object(n.useMemo)((function(){return a.editingBlockId}),[a.editingBlockId]),i=Object(n.useMemo)((function(){return a.isGrab}),[a.isGrab]),u=Object(n.useMemo)((function(){return a.isCliping}),[a.isCliping]),d=Object(n.useMemo)((function(){return a.isHoldingDown}),[a.isHoldingDown]),p=Object(n.useMemo)((function(){return a.isFetch}),[a.isFetch]),f=Object(n.useMemo)((function(){return a.stage}),[a.stage]),b=Object(n.useMemo)((function(){return a.tempClipData}),[a.tempClipData]),m=Object(n.useMemo)((function(){return a.targetPosition}),[a.targetPosition]),g=Object(n.useMemo)((function(){return a.modifyData}),[a.modifyData]),k=Object(n.useMemo)((function(){return a.nextBlockInfo}),[a.nextBlockInfo]),y=Object(n.useCallback)((function(e){o(ta(e))}),[o]),h=Object(n.useCallback)((function(e){o(ga(e))}),[o]),v=Object(n.useCallback)((function(e){o(oa(e))}),[o]),O=Object(n.useCallback)((function(e,t,a){o(ca(e,t,a))}),[o]),E=Object(n.useCallback)((function(){o(ra())}),[o]),j=Object(n.useCallback)((function(e,t){o(la(e,t))}),[o]),x=Object(n.useCallback)((function(e,t,a){o(aa(e,t,a))}),[o]),I=Object(n.useCallback)((function(e,t,a,n){o(na(e,t,a,n))}),[o]),C=Object(n.useCallback)((function(e,t){o(ia(e,t))}),[o]),D=Object(n.useCallback)((function(e,t,a){o(sa(e,t,a))}),[o]),T=Object(n.useCallback)((function(e,t,a,n,c){o(da(e,t,a,n,c))}),[o]),B=Object(n.useCallback)((function(e,t){o(fa(e,t))}),[o]),N=Object(n.useCallback)((function(e){o(pa(e))}),[o]),S=Object(n.useCallback)((function(e){o(ka(e))}),[o]),L=Object(n.useCallback)((function(e){o(ma(e))}),[o]),w=Object(n.useCallback)((function(){o(ba())}),[o]),U=Object(n.useCallback)((function(e){o(ya(e))}),[o]),_=Object(n.useCallback)((function(e,t){o(va(e,t))}),[o]),R=Object(n.useCallback)((function(e){o(ha(e))}),[o]),M=Object(n.useCallback)((function(){o(Oa())}),[o]),P=Object(n.useCallback)((function(e){o(ua(e))}),[o]),A=Object(n.useCallback)((function(){o(Ea())}),[o]),G=Object(n.useCallback)((function(e){o(ja(e))}),[o]);return{state:a,editingBlockId:l,isGrab:i,isHoldingDown:d,isCliping:u,isFetch:p,stage:f,tempClipData:b,targetPosition:m,modifyData:g,nextBlockInfo:k,onEditBlock:O,initBlock:c,blockLength:r,onInitBlockState:y,onChangeEditorState:h,onChangeEditingId:v,onCommitBlock:E,onChangeBlockContents:j,onAddBlock:x,onAddTextBlock:I,onDeleteBlock:C,onDeleteTextBlock:D,onChangeTextStyle:T,onSwitchBlock:B,onRevertBlock:N,onChangeTargetPosition:S,onSetTempClip:L,onClearTempClip:w,onResetEditorState:U,onChangeStyleType:_,onChangeFetchState:R,onClearModifyData:M,onUpdateBlock:P,onClearNextBlockInfo:A,onSetNextBlockInfo:G}},nn=function(){function e(){Object(y.a)(this,e)}return Object(h.a)(e,null,[{key:"getUUID",value:function(){var e=Object(at.a)().split("-");return e[2]+e[1]+e[0]+e[3]+e[4]}}]),e}();var on=function(){var e=Object(m.c)((function(e){return e.bklog})),t=Object(m.b)(),a=Object(n.useCallback)((function(e){t(Re(e))}),[t]),o=Object(n.useCallback)((function(e){console.log("\ud398\uc774\uc9c0 \ubd88\ub7ec\uc624\uae30"),t(Me(e))}),[t]),c=Object(n.useCallback)((function(){t(_e())}),[t]),r=Object(n.useCallback)((function(e){t(Pe(e))}),[t]),l=Object(n.useCallback)((function(){if(e.pageInfo&&e.pushModifyData){var a=e.pageInfo.id,n=e.pushModifyData;t(Ae({pageId:a,pageVersions:{current:e.version,next:nn.getUUID()},data:n}))}}),[t,e.pageInfo,e.pushModifyData,e.version]),i=Object(n.useCallback)((function(e,a){t(Ge(e,a))}),[t]),s=Object(n.useCallback)((function(e){t(Fe(e))}),[t]);return{bklogState:e,onClearBklogState:a,onResetBklog:c,onGetPage:o,onAddPushModifyData:r,onUpdateBklog:l,onUpdateVersion:i,onChangeUpdateState:s}},cn=a(82),rn=a.n(cn);var ln=function(e){var t=Object(n.useState)(null),a=Object(s.a)(t,2),o=a[0],c=a[1];return Object(n.useEffect)((function(){o||c(rn()(e))}),[]),o};var sn=function(e){var t=ln("http://localhost:4600/bklog"),a=Object(n.useState)(null),o=Object(s.a)(a,2),c=o[0],r=o[1],l=Object(n.useState)(!1),i=Object(s.a)(l,2),u=i[0],d=i[1],p=on(),f=p.bklogState,b=p.onClearBklogState,m=p.onUpdateBklog,g=p.onAddPushModifyData,k=p.onGetPage,y=p.onUpdateVersion,h=p.onChangeUpdateState,v=e.state,O=e.editingBlockId,E=e.isFetch,j=e.modifyData,x=e.onInitBlockState,I=e.onClearModifyData,C=e.onUpdateBlock,D=Object(n.useMemo)((function(){return f.isFetching}),[f.isFetching]),T=Object(n.useMemo)((function(){return f.isUpdated}),[f.isUpdated]),B=Object(n.useMemo)((function(){return f.isRefresh}),[f.isRefresh]),N=Object(n.useMemo)((function(){return f.pageInfo?f.pageInfo.id:null}),[f.pageInfo]),S=Object(n.useMemo)((function(){return f.pushModifyData}),[f.pushModifyData]),L=Object(n.useMemo)((function(){return f.version}),[f.version]),w=Object(n.useCallback)((function(){t&&(t.on("connect",(function(){console.log("connected")})),t.on("updated",(function(e){console.log("updated: ".concat(e)),r(e)})),t.on("disconnect",(function(){console.log("disconnected")})),t.on("editing",(function(e){console.log(e)})),t.on("edited",(function(e){console.log(e)})))}),[t]);return Object(n.useEffect)((function(){f.blockList&&(x(f.blockList),b("blockList"),I())}),[f.blockList]),Object(n.useEffect)((function(){E&&!D&&j[0]&&g(Qa(v.modifyData))}),[j]),Object(n.useEffect)((function(){T&&t&&(t.emit("update",[f.pageInfo.id,L]),h(),I())}),[T]),Object(n.useEffect)(m,[S]),Object(n.useEffect)(w,[t]),Object(n.useEffect)((function(){t&&N&&t.emit("roomjoin",N)}),[t,N]),Object(n.useEffect)((function(){c&&L&&(y(c,L),r(null))}),[c]),Object(n.useEffect)((function(){f.pullModifyData&&(C(f.pullModifyData),d(!0))}),[f.pullModifyData]),Object(n.useEffect)((function(){B&&k(f.pageInfo.id)}),[B]),Object(n.useEffect)((function(){t&&N&&(O?t.emit("edit",[N,{penName:"junhee",editingId:O}]):t.emit("edited",[N,"junhee"]))}),[O]),Object(n.useEffect)((function(){if(u){var e=setTimeout((function(){d(!1)}),1500);return function(){return clearTimeout(e)}}}),[u]),{updated:u}};function un(e,t){switch(t){case"child":var a=e.split(/-/);return a.push("1"),1===(n=a).length?"".concat(n[0]):n.reduce((function(e,t){return e?"".concat(e,"-").concat(t):"".concat(t)}));case"next":default:return e}var n}var dn=function(e,t,a){var o=t.state,c=t.initBlock,r=t.onSwitchBlock,l=t.isCliping,i=(t.isHoldingDown,t.isGrab),u=t.tempClipData,d=t.onChangeEditingId,p=t.onChangeEditorState,f=t.onChangeTargetPosition,b=t.onSetTempClip,m=t.onClearTempClip,g=Object(n.useState)(!1),k=Object(s.a)(g,2),y=k[0],h=k[1],v=Object(n.useState)(!1),O=Object(s.a)(v,2),E=O[0],j=O[1],x=Object(n.useState)(!1),I=Object(s.a)(x,2),C=I[0],D=I[1],T=Object(n.useState)(!1),B=Object(s.a)(T,2),N=B[0],S=B[1],L=!!a&&a.selected,w=Object(n.useMemo)((function(){return c.hasOwnProperty(e.id)?c[e.id]:null}),[c]),U=Object(n.useMemo)((function(){return un(e.position,a&&"container"===a.type?"child":"next")}),[e.position]),_=Object(n.useMemo)((function(){return un(e.position,a&&"container"===a.type?"next":"child")}),[e.position]),R=Object(n.useCallback)((function(e,t){return function(){!i||E||L||(t(!0),f(e))}}),[u,l,i]),M=Object(n.useCallback)((function(e){return function(){e(!1)}}),[]),P=Object(n.useCallback)((function(e){return function(){void 0!==u[0]&&r(u.map((function(e){return o.blockList[e].id})),e)}}),[u,i]),A=Object(n.useCallback)((function(){p({isGrab:!0}),d(null),l||b(w?[e.index].concat(Object(tt.a)(w.map((function(e){return e.index})))):[e.index])}),[l,w,e.index]),G=Object(n.useCallback)((function(){i||h(!0)}),[i]),F=Object(n.useCallback)((function(){h(!1)}),[]),H=Object(n.useCallback)((function(){h(!1)}),[]);return Object(n.useEffect)((function(){i||!C&&!N||(D(!1),S(!1),j(!1),l||m())}),[i]),Object(n.useEffect)((function(){u.includes(e.index)?j(!0):j(!1)}),[u]),Object(n.useEffect)((function(){L&&w&&b(w.map((function(e){return e.index})))}),[L]),{parentSelected:L,isHover:y,setHover:h,selected:E,setSelect:j,down:C,setDown:D,setRight:S,childrenBlockData:w,downPosition:U,rightPosition:_,handleSelectMouseEnter:R,handleSelectMouseLeave:M,handleSelectMouseUp:P,handleGrabMouseDown:A,handleContentsHover:G,handleContentsMouseLeave:H,handleContentsBlur:F}},pn=function(e){var t=e.childrenBlockData,a=e.useBlockReducer,n=e.parentInfo;return o.a.createElement(o.a.Fragment,null,t?t.map((function(e){return o.a.createElement(An,{key:e.id,blockData:e,useBlockReducer:a,parentInfo:n})})):null)},fn=function(e){var t=e.blockData,a=e.useBlockReducer,n=e.parentInfo,c=e.children,r=dn(t,a,n),l=r.parentSelected,i=r.isHover,s=r.selected,u=r.setSelect,p=r.down,f=r.setDown,b=r.childrenBlockData,m=r.downPosition,g=(r.rightPosition,r.handleSelectMouseEnter),k=r.handleSelectMouseLeave,y=r.handleSelectMouseUp,h=r.handleGrabMouseDown,v=(r.handleContentsBlur,r.handleContentsHover),O=r.handleContentsMouseLeave;return o.a.createElement("div",{className:d()("block-zone",{selected:!l&&s})},o.a.createElement("div",{className:"contents-area",onMouseOver:v,onMouseLeave:O},o.a.createElement("div",{className:d()("block-utils",{on:i})},o.a.createElement("div",{className:"block-add-button"},o.a.createElement($.a,{icon:ee.f})),o.a.createElement("div",{className:"block-type-change-button",onMouseDown:h},o.a.createElement($.a,{icon:ee.c}))),c(s,u)),o.a.createElement(pn,{childrenBlockData:b,useBlockReducer:a,parentInfo:{type:t.type,selected:s}}),o.a.createElement("div",{className:d()("block-select-area",{selected:a.isGrab})},o.a.createElement("div",{className:d()("area","rigth-drop-area",{on:!1})},o.a.createElement("div",{className:"box"})),o.a.createElement("div",{className:d()("area","down-drop-area",{on:p}),onMouseEnter:g(m,f),onMouseLeave:k(f),onMouseUp:y()},o.a.createElement("div",{className:"box"}))))};function bn(e){var t,a,n=null;if(2===e.length){if(e[1].forEach((function(e){switch(e[0]){case"b":n=n?n+" ".concat("font-weight: 700;"):"font-weight: 700;";break;case"i":n=n?n+" ".concat("font-style: italic;"):"font-style: italic;";break;case"_":n=n?n+" ".concat("border-bottom: 0.05em solid;"):"border-bottom: 0.05em solid;";break;case"fc":n=n?n+" ".concat("color:"," ").concat(e[1],";"):"".concat("color:"," ").concat(e[1],";");break;case"bc":n=n?n+" ".concat("background-color:"," ").concat(e[1],";"):"".concat("background-color:"," ").concat(e[1],";");break;case"a":a=e[1]}})),t="<span".concat("").concat(n?' style="'+n+'"':"",">").concat(e[0],"</span>"),a){var o=t;t='<a href="'.concat(a,'">').concat(o,"</a>")}}else t=e[0];return t}function mn(e,t,a){return 1===a?bn(e)+bn(t):e+bn(t)}function gn(e,t){for(var a=0,n=null,o=0;o<e.length;o++)if((a+=e[o][0].length)>t){n=2===e[o].length?e[o][1]:null;break}return n}var kn=f.a.mark(On);function yn(e,t,a){for(var n=a;n.parentNode!==e;)n=n.parentNode;for(var o=t;null!==n&&o>0;)n=n.previousSibling,o-=1;return o>0}function hn(e,t,a,n){if(e===a)return t-n;var o=e.compareDocumentPosition(a);return 0!==(o&Node.DOCUMENT_POSITION_CONTAINED_BY)?yn(e,t,a)?1:-1:0!==(o&Node.DOCUMENT_POSITION_CONTAINS)?yn(a,n,e)?-1:1:0!==(o&Node.DOCUMENT_POSITION_FOLLOWING)?-1:0!==(o&Node.DOCUMENT_POSITION_PRECEDING)?1:void 0}function vn(e,t){return"br"===e.tagName.toLowerCase()?"\n":"div"!==e.tagName.toLowerCase()||t?"":"\n"}function On(e){var t,a,n,o=arguments;return f.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return t=!(o.length>1&&void 0!==o[1])||o[1],a=e.firstChild,n=0,c.next=5,{node:e,offset:n,text:vn(e,t)};case 5:if(null==a){c.next=20;break}if(a.nodeType!==Node.TEXT_NODE){c.next=12;break}return c.next=9,{node:a,offset:NaN,text:a.data};case 9:t=!1,c.next=14;break;case 12:return c.delegateYield(On(a,t),"t0",13);case 13:t=c.t0;case 14:return a=a.nextSibling,n+=1,c.next=18,{node:e,offset:n,text:""};case 18:c.next=5;break;case 20:return c.abrupt("return",t);case 21:case"end":return c.stop()}}),kn)}function En(e,t){var a,n=0,o=null,c=0,r=Object(et.a)(On(e));try{for(r.s();!(a=r.n()).done;){var l=a.value;if(l.text.length>t-n)return{node:l.node,offset:l.node.nodeType===Node.TEXT_NODE?t-n:l.offset};n+=l.text.length,o=l.node,c=l.node.nodeType===Node.TEXT_NODE?l.text.length:l.offset}}catch(i){r.e(i)}finally{r.f()}return{node:o,offset:c}}function jn(e,t,a){var n,o=0,c=Object(et.a)(On(e));try{for(c.s();!(n=c.n()).done;){var r=n.value;if(!t||!t.nodeType)return o+=r.text.length;if(t.nodeType!==Node.TEXT_NODE&&t===r.node&&a===r.offset)return o;if(t.nodeType===Node.TEXT_NODE&&t===r.node)return o+a;o+=r.text.length}}catch(l){c.e(l)}finally{c.f()}return hn(t,a,e,0)<0?0:o}function xn(e,t,a){var n=window.getSelection(),o=En(e,t),c=En(e,a);n.setBaseAndExtent(o.node,o.offset,c.node,c.offset)}function In(e){var t=window.getSelection();return hn(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset)<0?jn(e,t.anchorNode,t.anchorOffset):jn(e,t.focusNode,t.focusOffset)}function Cn(e){var t=window.getSelection();return hn(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset)<0?jn(e,t.focusNode,t.focusOffset):jn(e,t.anchorNode,t.anchorOffset)}var Dn=function(e,t,a){var o=Object(n.useState)(!0),c=Object(s.a)(o,2),r=c[0],l=c[1],i=Object(n.useState)(0),u=Object(s.a)(i,2),d=u[0],p=u[1],f=Object(n.useState)(0),b=Object(s.a)(f,2),m=b[0],g=b[1],k=Object(n.useState)(!1),y=Object(s.a)(k,2),h=y[0],v=y[1],O=Object(n.useRef)(null),E=(t.initBlock,t.isGrab),j=(t.isHoldingDown,t.isCliping,t.nextBlockInfo),x=t.editingBlockId,I=t.onChangeEditingId,C=t.onEditBlock,D=t.onAddTextBlock,T=(t.onChangeTextStyle,t.onCommitBlock),B=(t.onChangeBlockContents,t.onDeleteBlock),N=t.onDeleteTextBlock,S=(t.onRevertBlock,t.onSwitchBlock,t.onClearNextBlockInfo),L=Object(n.useMemo)((function(){return{__html:e.contents[0]?e.contents[1]?e.contents.reduce(mn):bn(e.contents[0]):""}}),[e.contents]),w=Object(n.useCallback)((function(t){if(!t.ctrlKey)switch(p(In(t.target)),g(Cn(t.target)),t.key){case"Enter":t.preventDefault();break;case"ArrowUp":t.preventDefault(),p(0),g(0),xn(t.target,0,0),0===d&&0===m&&I(e.index-1);break;case"ArrowDown":t.preventDefault();var a=t.target.innerText.length;p(a),g(a),xn(t.target,a,a),(m&&d)===t.target.innerText.length&&(p(0),g(0),I(e.index+1));break;case" ":g(0),C(e.id,e.index,t.target.innerHTML),T();break;default:C(e.id,e.index,t.target.innerHTML)}}),[e,m,d]),U=Object(n.useCallback)((function(e){var t=e.innerText.length;p(t),g(t),xn(e,t,t)}),[]),_=Object(n.useCallback)((function(e,t,a){xn(e,t,a||t)}),[]),R=Object(n.useCallback)((function(e){var t=e.target.parentNode;"A"===t.tagName&&window.open(t.href)}),[]),M=Object(n.useCallback)((function(e){e.relatedTarget&&!e.currentTarget.contains(e.relatedTarget)&&(p(0),g(0),T(),I())}),[]),P=Object(n.useCallback)((function(e){e.focus()}),[]);return Object(n.useEffect)((function(){var e=document.activeElement;d|m&&O&&e===O.current&&_(O.current,d,m)}),[e.contents]),Object(n.useEffect)((function(){if(x===e.id){if(O.current&&(P(O.current),j&&"text"===j.type)){if("delete"===j.payload[0]){var t=O.current.innerText.length-j.payload[1];xn(O.current,t,t)}S()}}else v(!1)}),[x]),Object(n.useEffect)((function(){v(m-d>=1)}),[d,m]),Object(n.useEffect)((function(){l(E?!E:!a)}),[a]),Object(n.useEffect)((function(){x===e.id&&O&&(P(O.current),xn(O.current,0,0))}),[O]),{cursorStart:d,cursorEnd:m,styleToggle:h,blockContentsRef:O,createMarkup:L,handleKeyUp:w,handleKeyPress:function(t){"Enter"===t.key&&(t.preventDefault(),D(e.index,t.target.innerHTML,In(t.target),Cn(t.target)))},handleKeyDown:function(t){if("Backspace"===t.key){var a=In(t.target),n=Cn(t.target);if(p(a),g(n),0===a&&0===n)if(t.target.innerHTML&&"<br>"!==t.target.innerHTML)0!==e.index&&N(e.index,t.target.innerHTML,t.target.innerText.length);else{var o=e.index>0?e.index-1:void 0;B([e],o)}}},handleClick:R,handleMouseUp:function(){var e=In(O.current),t=Cn(O.current);p(e),g(t)},handleBlur:M,isFocus:function(){h?d|m&&_(O.current,d,m):U(O.current),e.id!==x&&I(e.id)},reBlockFocus:function(){P(O.current)},editable:r,setEditable:l}},Tn=o.a.forwardRef((function(e,t){var a=e.className,n=e.editable,c=e.onKeyPress,r=e.onKeyUp,l=e.onKeyDown,i=e.onCopy,s=e.onPaste,u=e.onClick,d=e.onMouseUp,p=e.onMouseDown,f=e.onMouseMove,b=e.onFocus,m=e.onBlur,g=e.dangerouslySetInnerHTML,k=e.contents,y=e.placeholder;return o.a.createElement("div",{className:"bk-contentEditable ".concat(a||""),ref:t,onKeyUp:r,onKeyPress:c,onKeyDown:l,onCopy:i,onPaste:s,onClick:u,onMouseUp:d,onMouseDown:p,onMouseMove:f,onFocus:b,onBlur:m,contentEditable:n,dangerouslySetInnerHTML:g,placeholder:y},k)})),Bn=function(e){var t=e.colorCode,a=e.onStyleChange,n=e.addDelToggle,c="rgba(".concat(t[0],",").concat(t[1],",").concat(t[2],",").concat(t[3],")"),r={color:c},l=n(["fc",c])?"del":"color";return o.a.createElement("button",{className:"bk-colorStyleToggle",style:r,onClick:function(){a(["fc",c],l)}},"Text","del"===l?"v":null)},Nn=[[191,63,63,1],[191,127,63,1],[191,191,63,1],[127,191,63,1],[63,191,63,1],[63,191,127,1],[63,127,191,1],[63,63,191,1],[127,63,191,1],[191,63,191,1],[191,63,127,1]],Sn=function(e){var t=e.addDelToggle,a=e.onStyleChange;return o.a.createElement("div",{className:"bk-color-menu"},Nn.map((function(e,n){return o.a.createElement(Bn,{key:n,colorCode:e,onStyleChange:a,addDelToggle:t})})))};var Ln=function(e){var t=Object(n.useState)(e),a=Object(s.a)(t,2),o=a[0],c=a[1];return[o,function(e){return function(t){c(t.target.value),e&&e(t.target.value)}}]},wn=[["h1","bk-h1"],["h2","bk-h2"],["h3","bk-h3"],["h4","bk-h4"],["p","bk-p"]],Un=function(e){var t=e.blockIndex,a=e.onChangeStyleType,c=e.styleType,r=Ln(c),l=Object(s.a)(r,2),i=l[0],u=l[1],d=Object(n.useCallback)((function(){return u((function(e){return a(t,e)}))}),[i,a,t]);return o.a.createElement("select",{onChange:d(),value:i},wn.map((function(e){return o.a.createElement("option",{value:e[1],key:e[1]},e[0])})))},_n=function(e){var t=e.onStyleChange,a=e.addDelToggle,n=e.styleType,c=function(){return a?"del":"add"};return o.a.createElement("button",{className:"bk-textStyleToggle ".concat(c),onClick:function(){t([n],c)}},n)},Rn=function(e){var t=e.blockIndex,a=e.styleType,c=e.contents,r=e.startPosition,l=e.endPosition,i=e.reBlockFocus,u=e.useBlockReducer,d=Object(n.useState)(gn(c,r)),p=Object(s.a)(d,2),f=p[0],b=p[1],m=u.onChangeTextStyle,g=u.onCommitBlock,k=u.onChangeStyleType,y=function(e,a){g(),m(t,e,r,l,a),console.log("click",r,l),i()},h=function(e){return-1!==function(e,t){for(var a=JSON.stringify(t),n=0;n<e.length;n++){if(JSON.stringify(e[n])===a)return n}return-1}(f||[],e)};return Object(n.useEffect)((function(){b(gn(c,r))}),[c,r]),o.a.createElement("div",{style:{left:"".concat(16*r,"px")},className:"bk-style-toggles absolute bg-white -top-full border"},o.a.createElement(Un,{blockIndex:t,styleType:a,onChangeStyleType:k}),["b","i","_"].map((function(e){return o.a.createElement(_n,{key:e,onStyleChange:y,styleType:e,addDelToggle:h([e])})})),o.a.createElement(Sn,{addDelToggle:h,onStyleChange:y}))},Mn=function(e){var t=e.blockData,a=e.useBlockReducer,c=e.selected,r=(e.setSelect,Dn(t,a,c)),l=r.cursorStart,i=r.cursorEnd,s=r.styleToggle,u=r.blockContentsRef,d=r.createMarkup,p=r.handleKeyUp,f=r.handleKeyPress,b=r.handleKeyDown,m=r.handleClick,g=r.handleMouseUp,k=r.handleBlur,y=r.isFocus,h=r.reBlockFocus,v=r.editable,O=r.setEditable;return Object(n.useEffect)((function(){O(!c)}),[c]),o.a.createElement("div",{className:"text-block",onBlur:k},o.a.createElement(Tn,{className:t.styleType,editable:v,dangerouslySetInnerHTML:d,ref:u,onKeyUp:p,onKeyPress:f,onKeyDown:b,onClick:m,onMouseDown:y,onMouseUp:g,onFocus:y,placeholder:"\uc785\ub825\ud574\uc8fc\uc138\uc694..."}),s?o.a.createElement(Rn,{blockIndex:t.index,styleType:t.styleType,contents:t.contents,startPosition:l,endPosition:i,reBlockFocus:h,useBlockReducer:a}):null)},Pn=function(e){var t=e.blockData,a=e.useBlockReducer,n=e.parentInfo;return o.a.createElement(fn,{blockData:t,useBlockReducer:a,parentInfo:n},(function(e,n){return o.a.createElement(Mn,{blockData:t,useBlockReducer:a,selected:e,setSelect:n})}))},An=(a(77),function(e){var t=e.blockData,a=e.useBlockReducer,n=e.parentInfo;switch(t.type){case"text":return o.a.createElement(Pn,{blockData:t,useBlockReducer:a,parentInfo:n});default:return null}}),Gn=function(){var e=an(),t=sn(e).updated,a=e.state,c=e.stage,r=e.isGrab,l=e.isCliping,i=e.tempClipData,s=e.initBlock,u=e.onCommitBlock,p=e.onResetEditorState,f=e.onRevertBlock,b=Object(n.useRef)(null),m=Object(n.useRef)(null),g=Object(n.useCallback)((function(){c[0]&&u()}),[c,u]),k=Object(n.useCallback)((function(e){var t;null===(t=m.current)||void 0===t||t.setAttribute("style","transform: translate(".concat(e.clientX-40,"px, ").concat(e.clientY-70,"px)"))}),[m]),y=Object(n.useCallback)((function(e){var t;r&&(null===(t=m.current)||void 0===t||t.setAttribute("style","transform: translate(".concat(e.clientX-40,"px, ").concat(e.clientY-70,"px)")))}),[r,m]),h=Object(n.useCallback)((function(e){}),[r,l]),v=Object(n.useCallback)((function(){p(!1)}),[b,p]),O=Object(n.useCallback)((function(){p(!1)}),[p]),E=Object(n.useCallback)((function(e){if(e.metaKey||e.ctrlKey){if(!c[0])switch(e.key){case"z":e.preventDefault(),f();break;case"y":e.preventDefault(),f(!0)}i[0]}}),[f,c,i]);Object(fe.a)({timeout:1200,onIdle:g,debounce:500}).getLastActiveTime;return o.a.createElement("div",{className:"block-editor blockEditor items-center overflow-auto w-full notranslate text-gray-700 bg-white h-full rounded-md shadow-md",ref:b,onMouseUp:v,onMouseLeave:O,onMouseMove:y,onMouseDown:k,onDrag:h,onKeyDown:E},o.a.createElement("div",{className:"cover"}),o.a.createElement("div",{className:d()("pt-8","m-auto","h-full","block-container",{"not-drag":!(!r&&!l)},{updated:t})},s?s.root.map((function(t){return o.a.createElement(An,{key:t.id,blockData:t,useBlockReducer:e})})):o.a.createElement("div",null," Loading... ")),o.a.createElement("div",{className:d()("drag-elements",{hidden:!r}),ref:m},void 0!==i[0]?i.map((function(t,n){var c=a.blockList[t];return o.a.createElement(An,{key:n,blockData:c,useBlockReducer:e})})):null))},Fn=["user-block px-4 pt-4 bg-purple-50","profile-text-block","penName font-semibold text-xl text-gray-600","bi text-sm font-medium text-gray-600","profile-image-block w-full h-18 pt-6","avatar w-24 h-12 m-auto relative","w-24 h-24 absolute hover:cursor-pointer rounded-full overflow-hidden border","w-full h-full","w-full h-full"];var Hn=function(e){var t=e.penName,a=e.bio,n=e.userPhoto;return o.a.createElement("div",{className:Fn[0]},o.a.createElement("div",{className:Fn[1]},o.a.createElement("div",{className:Fn[2]},t),o.a.createElement("div",{className:Fn[3]},a)),o.a.createElement("div",{className:Fn[4]},o.a.createElement("div",{className:Fn[5]},o.a.createElement(l.b,{to:"/bklog/".concat(t),className:Fn[6],title:"".concat(t," page \uc774\ub3d9")},n?o.a.createElement("img",{className:Fn[7],src:n,alt:t}):o.a.createElement("div",{className:Fn[8]},t[0])))))};a(155);var Kn=function(){var e=se().pageEditor;return o.a.createElement("div",{className:"user-profile flex-none w-full whitespace-nowrap border-b mb-12"},e?o.a.createElement(o.a.Fragment,null,o.a.createElement(Hn,{penName:e.penName,userPhoto:e.userPhoto,bio:e.bio})):o.a.createElement("div",null))};var Vn=function(e){var t=e.pageEditor,a=e.pageList;return o.a.createElement("div",{className:"page-list flex-1 overflow-auto pt-1"},o.a.createElement("div",{className:"pl-4 text-base font-semibold"},"Page list"),o.a.createElement("ul",{className:"list p-4 font-semibold text-sm text-gray-600"},a?a.map((function(e,a){return o.a.createElement("li",{key:a,className:"h-auto flex justify-between px-2"},o.a.createElement("div",{className:"h-8 leading-8 w-5/6 flex-none"},o.a.createElement(l.b,{to:"/bklog/".concat(t.penName,"/").concat(e.pageId)}," ".concat(e.pageTitle))),o.a.createElement("button",{className:"h-8 pb-2 w-8 outline-none click:outline-none text-gray-300 hover:text-gray-600"},o.a.createElement($.a,{icon:ee.g})))})):o.a.createElement("li",null)),o.a.createElement("ul",null,o.a.createElement("li",null)))};a(156);var Xn=function(){var e=se().pageState;return o.a.createElement("div",{className:d()("sidebar h-full flex-none gnb-box overflow-hidden",{off:!e.toggle})},o.a.createElement("div",{className:"h-full py-2 pl-2"},o.a.createElement("nav",{className:" h-full rounded-md shadow-md bg-white overflow-hidden relative flex flex-col"},o.a.createElement(Kn,null),o.a.createElement(Vn,{pageEditor:e.pageEditor,pageList:e.pageList}))))};var Yn=function(){var e=on().bklogState,t=Object(n.useMemo)((function(){return e.pageInfo}),[e.pageInfo]);return o.a.createElement("div",{className:"flex h-full relative overflow-auto"},o.a.createElement(Xn,null),o.a.createElement("div",{className:d()("flex-auto w-full h-full py-2 pr-2 ml-2")},t?o.a.createElement(Gn,null):"loading..."))};var qn=function(e){var t=e.match,a=t.params,c=(a.penName,a.id),r=(Z().onCheckToken,on()),l=(r.bklogState,r.onGetPage);return Object(n.useEffect)((function(){})),Object(n.useEffect)((function(){t.params.id&&l(t.params.id)}),[t.params.id]),t.params.penName?o.a.createElement("div",{className:d()("bk-page","h-full","overflow-scroll")},c?o.a.createElement(Yn,null):null):o.a.createElement(i.a,{to:"/home"})};var zn=function(e){var t=e.className,a=e.penName,n=e.userPhoto,c=e.onClick;return o.a.createElement("button",{onClick:c,className:"".concat(t," max-w-xs rounded-xl flex items-center text-sm py-1 px-2"),id:"user-menu"},o.a.createElement("span",{className:"sr-only"},a),n?o.a.createElement("img",{className:"h-8 w-8 rounded-full",src:n,alt:a}):o.a.createElement("div",{className:"h-8 w-8 rounded-full bg-blue-400 leading-8"},a[0]),o.a.createElement("span",{className:"ml-4"},a))};var Jn=function(){var e=de(),t=e.baseState.dark,a=e.onChangeMode;return o.a.createElement("div",{className:"dark-mode-toggle"},o.a.createElement("button",{onClick:function(){a()},className:d()("mode-field hover:bg-yellow-300 transition-all bg-gray-200 dark:bg-gray-700 dark:hover:bg-indigo-900 w-16 h-8 rounded-full p-1 border-none","text-2xl leading-6 text-left text-white dark:text-gray-500 hover:text-yellow-50 dark:hover:text-yellow-300")},o.a.createElement("span",{className:"sr-only"},"Dark mode toggle"),o.a.createElement($.a,{className:d()("transform transition-all",{"translate-x-8":t}),icon:t?ee.e:ee.b})))},Wn="hover:bg-purple-500 hover:text-white px-3 py-2 rounded-md text-sm font-medium";var Qn=function(){var e=Object(n.useState)(!1),t=Object(s.a)(e,2),a=t[0],c=t[1],r=se(),i=r.pageToggle,u=r.onChangeToggle,p=Z(),f=p.authState,b=f.loading,m=f.user,g=p.onSignOutUser;return o.a.createElement("nav",{className:"bg-white dark:bg-black absolute left-0 top-0 z-10 shadow w-full"},o.a.createElement("div",{className:"w-full pr-4 pl-1"},o.a.createElement("div",{className:"flex items-center justify-between h-14"},o.a.createElement("div",{className:"hidden md:block"},o.a.createElement("div",{className:"flex items-center space-x-4"},o.a.createElement("div",{className:"flex-shrink-0"},o.a.createElement("button",{className:d()("w-12 h-12 text-xl rounded",{"text-white bg-purple-500 shadow":i},{"text-gray-500 hover:text-purple-500":!i}),onClick:function(){u()}},o.a.createElement($.a,{icon:ee.a}))),o.a.createElement("div",{className:"ml-0 relative"},o.a.createElement("div",null,m?o.a.createElement(zn,{className:d()({"hover:bg-purple-500 hover:text-white outline-none":a}),userPhoto:m.userPhoto,penName:m.penName,onClick:function(){c(!a)}}):b?o.a.createElement("button",{className:"max-w-xs rounded-full flex items-center text-sm",id:"user-menu","aria-haspopup":"true"},o.a.createElement("span",{className:"sr-only"}),o.a.createElement("div",{className:"h-8 w-8 rounded-full leading-8 bg-gray-200"})):o.a.createElement("div",{className:"flex items-center"},o.a.createElement("div",{className:"hidden md:block"},o.a.createElement("div",{className:"flex items-baseline space-x-4 text-gray-700 dark:text-gray-100"},o.a.createElement(l.b,{className:Wn,to:"/auth/sign-in"},"Sign In"),o.a.createElement(l.b,{className:Wn,to:"/auth/sign-up"},"Sign up"))))),a&&m?o.a.createElement("div",{onMouseLeave:function(e){c(!1)},className:"origin-top-right absolute left-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5",role:"menu","aria-orientation":"vertical","aria-labelledby":"user-menu"},o.a.createElement(l.b,{to:"/bklog/".concat(m.penName),className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},"My Page"),o.a.createElement("a",{href:"#",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",role:"menuitem"},"View Profile"),o.a.createElement("button",{className:"block text-left w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:function(){g()}}," Sign out ")):null),o.a.createElement("div",{className:"hidden md:block"},o.a.createElement("div",{className:"flex items-baseline space-x-4 text-gray-700 dark:text-gray-100"},o.a.createElement(l.b,{className:Wn,to:"/home"},"Home"))))),o.a.createElement("div",{className:"flex items-center"},o.a.createElement(Jn,null)))))};a(157);var Zn=function(){var e=de().baseState.dark;return o.a.createElement("div",{className:d()("App w-full h-screen",{dark:e},{light:!e})},o.a.createElement("div",{className:"w-full h-full pt-14 bg-gray-100 dark:bg-gray-900 text-gray-700 dark:text-gray-100"},o.a.createElement(l.a,{basename:"/"},o.a.createElement(Qn,null),o.a.createElement(i.d,null,o.a.createElement(i.b,{path:"/",exact:!0},o.a.createElement(i.a,{to:"/home"})),o.a.createElement(i.b,{path:"/home",component:pe}),o.a.createElement(i.b,{path:"/bklog/:penName/:id",component:qn}),o.a.createElement(i.b,{path:"/auth",component:ue})))))},$n=a(21),eo={dark:!1,error:null};var to,ao=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:eo,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"base/CHANGE_DARK_MODE":return Object.assign({},e,{dark:!e.dark});case"base/SERVER_DISCONNECTED":return Object.assign({},e,{error:t.payload.error});default:return e}};var no=(to={},Object(qe.a)(to,Ee,(function(e,t){return Je(e,oo)})),Object(qe.a)(to,je,(function(e,t){var a=t.payload;return Je(e,Object(qe.a)({},a,null))})),Object(qe.a)(to,Ie,(function(e,t){var a=t.payload,n=a.pageInfo,o=a.blockList,c=a.version;return Je(e,{pageInfo:n,blockList:o,version:c,isLoading:!1,isRefresh:!1,isFetching:!1,pushModifyData:null,pullModifyData:null})})),Object(qe.a)(to,Ce,(function(e,t){var a=t.payload;return Je(e,{error:a})})),Object(qe.a)(to,De,(function(e,t){var a=t.payload;return Je(e,{pushModifyData:a})})),Object(qe.a)(to,Te,(function(e,t){return Je(e,{isFetching:!0})})),Object(qe.a)(to,Be,(function(e,t){var a=t.payload.pageVersion;return Je(e,{isFetching:!1,isUpdated:!0,pushModifyData:null,version:a})})),Object(qe.a)(to,Ne,(function(e,t){var a=t.payload;return"Bklog"===a.type&&"002"===a.code?Je(e,{isLoading:!0,isRefresh:!0}):Je(e,{isLoading:!0,error:a})})),Object(qe.a)(to,Se,(function(e,t){return Je(e,{isFetching:!0})})),Object(qe.a)(to,Le,(function(e,t){var a=t.payload,n=a.id,o=a.data,c=o.pageInfo,r=o.modifyData;return Je(e,{isFetching:!1,pageInfo:c?Je(e.pageInfo,c):e.pageInfo,version:n,pullModifyData:r||e.pullModifyData})})),Object(qe.a)(to,we,(function(e,t){var a=t.payload;return console.log(a),"Bklog"===a.type&&"002"===a.code?Je(e,{isLoading:!0,isRefresh:!0}):Je(e,{isLoading:!0,error:a})})),Object(qe.a)(to,Ue,(function(e,t){var a=t.payload;return Je(e,{isUpdated:!!a})})),to),oo={isLoading:!1,isFetching:!1,isRefresh:!1,isUpdated:!1,pageInfo:null,version:null,pageStar:null,pageComments:null,blockList:null,blockComments:null,pullModifyData:null,pushModifyData:null,editingUserList:[],error:null},co=We(oo,no),ro={loading:!1,user:null,error:{signInUser:null,signUpUser:{emailValid:!1,passwordValid:!1,penNameValid:!1,emailUsed:!1,penNameUsed:!1},signOutUser:null}};var lo=f.a.mark(uo),io=f.a.mark(go);function so(){return Q("reissue-token")}function uo(e){var t;return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t=e.payload,a.prev=1,a.next=4,Object(be.b)(so);case 4:if(!t){a.next=7;break}return a.next=7,Object(be.c)({type:t.type,payload:t.payload?t.payload:void 0});case 7:a.next=21;break;case 9:if(a.prev=9,a.t0=a.catch(1),"System"===a.t0.type){a.next=16;break}return a.next=14,Object(be.c)({type:"common/ALL_RESET"});case 14:a.next=21;break;case 16:return a.next=18,Object(be.c)({type:_,payload:{userInfo:null,error:a.t0}});case 18:if(!t){a.next=21;break}return a.next=21,Object(be.c)({type:"".concat(t.type,"_ERROR"),error:new C(a.t0).get});case 21:case"end":return a.stop()}}),lo,null,[[1,9]])}var po=Qe(w,(function(e){return W("sign-in",e)}),"auth/AUTH_ERROR"),fo=Qe(R,(function(){return Q("sign-out")}),"auth/AUTH_ERROR"),bo=Qe(N,(function(e){return W("sign-up",e)}),"auth/AUTH_ERROR"),mo=Qe(A,(function(){return Q("resign-in")}),"auth/AUTH_ERROR");function go(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(be.d)(w,po);case 2:return e.next=4,Object(be.d)(R,fo);case 4:return e.next=6,Object(be.d)(N,bo);case 6:return e.next=8,Object(be.d)(A,mo);case 8:return e.next=10,Object(be.d)(H,uo);case 10:case"end":return e.stop()}}),io)}var ko=f.a.mark(Oo);var yo=Qe(xe,(function(e){return He("t-getpage",{id:e})})),ho=Qe(Te,(function(e){return Ke("t-modify",e)})),vo=Qe(Se,(function(e){return He("getmodifydata",e)}));function Oo(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(be.d)(xe,yo);case 2:return e.next=4,Object(be.d)(Te,ho);case 4:return e.next=6,Object(be.d)(Se,vo);case 6:case"end":return e.stop()}}),ko)}var Eo=f.a.mark(xo),jo=f.a.mark(Io);function xo(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(be.d)("common/ALL_RESET",Ze);case 2:case"end":return e.stop()}}),Eo)}function Io(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(be.a)([xo(),go(),Oo()]);case 2:case"end":return e.stop()}}),jo)}var Co=Object($n.c)({base:ao,auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ro,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N:return Object.assign({},ro,{loading:!0,error:{signInUser:null,signUpUser:{emailValid:!1,passwordValid:!1,penNameValid:!1,emailUsed:!1,penNameUsed:!1},signOutUser:null}});case S:return Object.assign({},e,{loading:!1});case L:return Object.assign({},e,{loading:!1,error:Object.assign({},e.error,{signUpUser:t.payload.error})});case w:case A:return Object.assign({},ro,{loading:!0,user:null,error:{signInUser:null,signUpUser:{emailValid:!1,passwordValid:!1,penNameValid:!1,emailUsed:!1,penNameUsed:!1},signOutUser:null}});case U:case _:case G:case F:var a=t.payload,n=(a.userInfo,a.error);return Object.assign({},e,{loading:!1,user:t.payload,error:Object.assign({},e.error,{signInUser:n})});case R:return ro;case M:return Object.assign({},e,{loading:!1});case P:return Object.assign({},e,{loading:!1,error:Object.assign({},e.error,{signOut:"\uc11c\ubc84\uc640 \ud1b5\uc2e0\uc774 \ubd88\uc548\uc815\ud569\ub2c8\ub2e4."})});case V:return ro;default:return e}},bklog:co,page:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"page/CHANGE_TOGGLE":return Object.assign({},e,{toggle:void 0!==t.payload.toggle?t.payload:!e.toggle});case"page/CHANGE_PAGE_TITLE":var a=t.payload,n=a.title,o=a.pageId;return Object.assign({},e,{pageList:e.pageList.map((function(e){return e.pageId===o?Object.assign({},e,{pageTitle:n}):e}))});default:return e}}}),Do=a(84),To=Object(Do.a)(),Bo=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||$n.d,No=function(){var e=Object($n.e)(Co,Bo(Object($n.a)(To)));return To.run(Io),e}();var So=function(){return o.a.createElement(m.a,{store:No},o.a.createElement(Zn,null))};a(158);r.a.render(o.a.createElement(So,null),document.getElementById("root"))},77:function(e,t,a){},86:function(e,t,a){e.exports=a(159)}},[[86,1,2]]]);
//# sourceMappingURL=main.a5cab33b.chunk.js.map