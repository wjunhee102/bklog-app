{"version":3,"sources":["utils/api-utils/apiUtils.ts","utils/api-utils/cookieUtils.ts","utils/api-utils/index.ts","store/modules/auth/utils/apiUtils.ts","store/modules/auth/utils/actions.ts","store/modules/auth/utils/index.ts","hooks/useAuth.ts","components/auth/InputComponent.tsx","hooks/useChange.ts","components/auth/sign-in/SignInForm.tsx","components/auth/sign-in/SignIn.tsx","components/auth/sign-in/index.ts","components/auth/sign-up/SignUpForm.tsx","components/auth/sign-up/SignUp.tsx","components/auth/sign-up/index.ts","store/modules/page/index.ts","hooks/usePage.ts","store/modules/page/utils/index.ts","pages/AuthPage.tsx","hooks/useBase.ts","store/modules/base/utils/index.ts","pages/HomePage.tsx","store/modules/bklog/utils/converter.ts","store/modules/bklog/utils/ordering.ts","store/modules/bklog/utils/blocksUtils.ts","store/modules/bklog/utils/tempStoreUtils.ts","store/modules/bklog/utils/index.ts","store/modules/bklog/index.ts","hooks/useBKlog.ts","components/bklog/utils/index.ts","components/bklog/utils/selectionText.ts","components/bklog/block/ContentEditableEle.tsx","components/bklog/block/ColorStyleToggle.tsx","components/bklog/block/TextStyleToggle.tsx","components/bklog/block/Block.tsx","components/bklog/block/index.ts","components/sidebar/profile/EditorBlock.tsx","components/sidebar/profile/Profile.tsx","components/sidebar/profile/index.ts","components/sidebar/Page-list.tsx","components/sidebar/Sidebar.tsx","components/sidebar/index.ts","containers/BklogContainer.tsx","pages/BkPage.tsx","components/editor/index.tsx","components/gnb/user/Userblock.tsx","components/gnb/DarkModeToggle.tsx","components/gnb/GlobalNav.tsx","components/gnb/index.ts","App.tsx","store/modules/base/index.ts","store/modules/auth/index.ts","store/modules/auth/authSaga.ts","store/modules/index.ts","store/index.ts","Root.tsx","index.tsx"],"names":["baseURL","req","a","axios","Object","assign","responseType","data","success","error","baseFetch","url","method","withCredentials","authApiUtils","authFetchPost","authFetchGet","actions","signUpUser","requiredUserInfo","type","SIGNUPUSER","payload","signUpUserSuccess","SIGNUPUSER_SUCCESS","signUpUserError","SIGNUPUSER_ERROR","signInUser","userAuthInfo","SIGNINUSER","signInUserError","SIGNINUSER_ERROR","signInUserSuccess","SIGNINUSER_SUCCESS","signOutUser","SIGNOUTUSER","signOutUserError","SIGNOUTUSER_ERROR","signOutUserSuccess","SIGNOUTUSER_SUCCESS","reSignInUser","RESIGNINUSER","reSignInUserError","RESIGNINUSER_ERROR","reSignInUserSuccess","RESIGNINUSER_SUCCESS","reissueToken","REISSUETOKEN","reissueTokenError","REISSUETOKEN_ERROR","resetAuth","RESET_AUTH","useAuth","state","useSelector","auth","dispatch","useDispatch","onSignUpUser","useCallback","onSignInUser","onReSignInUser","onSignOutUser","onReissueToken","onCheckToken","response","console","log","user","userId","authState","InputComponent","boxClass","labelClass","onChange","value","placeholder","label","className","name","id","autoComplete","children","htmlFor","useChange","defaultValue","useState","setValue","setError","e","target","SignInForm","email","handleInputEmail","errorEmail","handleErrorEmail","password","handleInputPwd","errorPwd","handleErrorPwd","inputProps","style","handleClickSubmit","preventDefault","useEffect","onSubmit","action","map","props","key","classNames","onClick","icon","faLock","SignIn","createErrorMessage","used","valid","SignUpForm","lastName","handleInputLName","errorLastName","handleErrorLName","firstName","handleInputFName","errorFirstName","handleErrorFName","penName","handleInputPName","errorPenName","handleErrorPName","emailUsed","emailValid","passwordValid","penNameUsed","penNameValid","errorMessage","handleSubmit","SignUp","initialState","toggle","loading","pageEditor","profileId","bio","userPhoto","pageList","pageId","pageTitle","usePage","page","pageToggle","pageState","onChangeToggle","changeToggle","onChangePageTitle","title","changePageTitle","AuthPage","to","path","useBase","base","baseState","onChangeMode","Home","convertType","prop","convertProperty","specialCharacters","text","i","convertedWord","word","count","length","equalsArray","aryA","aryB","Array","isArray","targetBList","targetA","JSON","stringify","targetBListLength","ii","splice","targetB","push","arrayFindIndex","array","factor","JSONFactor","addContentsStyle","preTexts","startPoint","endPoint","insertText","newContents","forEach","content","deleteContentsStyle","stylePosition","newStyle","textStylePosition","newText","converter","parseHtmlContents","textLength","saveToggle","propertyToggle","linkToggle","propertys","property","shift","pop","undefined","changeStyleTextContents","changedTextStyleBlock","styleType","order","changedTextContents","contents","isFirstBlockPoint","block","preBlockId","parentBlockId","isNextBlockPoint","insertChild","insertPoint","insertChildren","deleteCount","newChildren","concat","isBlockId","isNotBlockId","blocksUtils","createBlockData","blockType","nextBlockId","index","uuidv4","styles","color","backgroundColor","copyBlockData","blockData","copyBlockDataList","blockDataList","newBlockDataList","newPreBlockData","newParentBlockData","newBlock","parentData","preBlockData","preNextBlockId","findIndex","insertBlock","preBlocks","parentId","newBlocks","currentBlockId","newChildrenList","preBlockPosition","preBlock","nextBlockPosition","nextBlock","currentBlockPosition","currentBlock","parentBlockPosition","parentBlock","insertPosion","indexOf","newBlockLastChild","newBlocklastChildPosition","updateContents","stageData","blockIndex","excludeBlock","blocks","deletedId","deletedBlock","filter","deletedBlocks","newPreBlockId","newNextBlockId","childPositionList","child","firstChild","lastChild","deletePosition","excludeBlockList","blockIdList","nextBlockData","parentPosition","find","switchingBlock","blockId","targetBlockId","parentType","currentPreBlockPosition","currentNextBlockPosition","currentParentBlockPosition","currentParentBlock","targetBlockPosition","preBlockParentId","insertPosition","restoreBlock","changedData","childId","childPosition","childChangedData","preParentBlockId","preParentPosition","tempStoreUtils","tempDataPush","tempStore","tempData","limitCount","newTempStore","getContentsToBeChanged","stage","changedBlocks","ADD_BLOCK","COMMIT_BLOCK","DELETE_BLOCK","orderingBlock","BLOCK_LENGTH","rawBlocks","currentPosition","idStack","currentId","editingId","rightToEdit","tempBack","tempFront","bklog","newBlockType","addedBlocks","editingBlockId","editingIndex","editedId","editedBlockIndex","preStagedBlock","stagedBlock","newStagedBlock","changedTextStyleBlockIndex","newTempData","newTempBack","newState","localStorage","setItem","switchedId","targetType","switchedBlocks","restoreBlocks","testBlock","useBklog","initBlock","useMemo","getEditAbleId","getStagedBlocks","getRightToEdit","onAddBlock","addBlock","onEditAble","editAble","onEditBlock","onCommitBlock","onDeleteBlock","onChangeTextStyle","changeTextStyle","onSwitchBlock","switchBlock","onRevertBlock","getChilrenBlock","getBlockState","blockState","getStagedBlock","statedBlock","contentsElement","rawContents","aTag","preText","createContentsElement","accumulator","currentIndex","findTextStyle","textContents","position","positions","isAfter","container","offset","node","c","parentNode","previousSibling","compareCaretPositons","node1","offset1","node2","offset2","compareDocumentPosition","Node","DOCUMENT_POSITION_CONTAINED_BY","DOCUMENT_POSITION_CONTAINS","DOCUMENT_POSITION_FOLLOWING","DOCUMENT_POSITION_PRECEDING","stringifyElementStart","isLineStart","tagName","toLowerCase","nodeType","TEXT_NODE","nextSibling","getCaretPosition","contenteditable","textPosition","textOffset","lastNode","lastOffset","p","getTextOffset","selectionNode","selectionOffset","setSelectionRange","start","end","selection","window","getSelection","s","setBaseAndExtent","getSelectionStart","anchorNode","anchorOffset","focusNode","focusOffset","getSelectionEnd","ContentEditableEle","React","forwardRef","ref","onKeyPress","onKeyUp","onMouseUp","onMouseDown","onMouseMove","onFocus","onBlur","dangerouslySetInnerHTML","contentEditable","ColorStyleToggleButton","colorCode","onStyleChange","addDelToggle","RGBA","btnStyle","addDel","colorCodes","ColorStyleToggle","code","textBlockType","TextBlockTypeSelection","idx","TextStyleToggleButton","addDelClassName","TextStyleToggles","startPosition","endPosition","reBlockFocus","currentStyle","setStyle","useBKlog","left","Block","cursorStart","setCursorStart","cursorEnd","setCursorEnd","styleToggle","setStyleToggle","blockRef","useRef","createMarkup","__html","reduce","childrenBlock","refreshPoint","ele","handleFocus","focus","focused","document","activeElement","current","data-index","currentTarget","contains","relatedTarget","innerText","innerHTML","open","href","getStartPosition","getEndPosition","moveEndPoint","TextStyleToggle","classes","EditorBlock","src","alt","Profile","PageList","faSortDown","Sidebar","Sibebar","BklogContainer","setCount","getLastActiveTime","useIdleTimer","timeout","onIdle","debounce","BkPage","match","params","NodeDom","addNode","editable","setAble","data-id","Editor","nodeData","setNodeData","UserBlock","DarkModeToggle","dark","faMoon","faCircle","LinkClasses","GlobalNav","onUserMenu","setOnUserMenu","faBars","aria-haspopup","onMouseLeave","role","aria-orientation","aria-labelledby","App","basename","exact","component","initState","reissueTokenSaga","authSaga","createPromiseSateAuth","promiseCreator","SUCCESS","ERROR","saga","call","put","accessTokken","userInfo","signInUserSaga","signOutUserSaga","signUpUserSaga","reSignInUserSaga","takeEvery","rootSage","all","rootReducer","combineReducers","signOut","sagaMiddleware","createSagaMiddleware","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","configureStore","store","createStore","applyMiddleware","run","Root","ReactDOM","render","getElementById"],"mappings":"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EAAI,EACZI,EAASL,EAAKK,OAEI,MAAhBL,EAAKI,IAAkC,MAAhBJ,EAAKI,IAAkBA,EAAQC,IAC1DF,GAAQH,EAAKI,GACM,MAAhBJ,EAAKI,KACRA,IAGF,GAAmB,MAAhBJ,EAAKI,GACN,OAAOD,GACL,IAAK,SACHD,EAAa,IACb,MACF,IAAK,QACHA,EAAgB,IAChB,MACF,IAAK,OACHA,EAAgB,IAChB,MACF,IAAK,OACHA,EAAgB,IAChB,MACF,IAAK,SACHA,EAAgB,IAChB,MACF,IAAK,UACHA,EAAgB,OAChB,MACF,IAAK,SACHA,EAAgB,SAChB,MACF,IAAK,UACHA,EAAgB,SAChB,MACF,IAAK,WACHA,EAAgB,OAChB,MACF,IAAK,QACHA,EAAgB,SAChB,MACF,IAAK,WACHA,EAAgB,IAChB,MACF,IAAK,SACHA,EAAgB,OAChB,MACF,IAAK,QACHA,EAAgB,OAChB,MACF,IAAK,SACHA,EAAgB,SAChB,MACF,IAAK,SACHA,EAAgB,OAChB,MACF,IAAK,UACHA,EAAgB,SAChB,MACF,IAAK,QACHA,EAAgB,SAChB,MACF,IAAK,QACHA,EAAgB,IAChB,MACF,IAAK,QACHA,EAAgB,IAChB,MACF,IAAK,SACHA,EAAgBC,EAChB,MACF,IAAK,QACHD,EAAgB,OAChB,MACF,IAAK,WACHA,EAAgB,OAChB,MACF,IAAK,SACHA,EAAgB,OAChB,MACF,IAAK,SACHA,EAAgB,OAChB,MACF,IAAK,SACHA,EAAgB,OAChB,MACF,IAAK,UACHA,EAAgB,OAChB,MACF,IAAK,UACHA,EAAgB,SAChB,MACF,IAAK,SACHA,EAAgB,OAChB,MACF,IAAK,WACHA,EAAgB,OAChB,MACF,IAAK,UACHA,EAAgB,OAChB,MACF,IAAK,SACHA,EAAgB,OAChB,MACF,IAAK,UACHA,EAAgB,SAChB,MACF,IAAK,WACHA,EAAgB,OAChB,MACF,IAAK,WACHA,EAAgB,OAChB,MACF,IAAK,WACHA,EAAgB,OAChB,MACF,IAAK,WACHA,EAAgB,OAChB,MACF,IAAK,WAGL,IAAK,WAGL,IAAK,UAGL,IAAK,WA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","file":"static/js/main.54659d8c.chunk.js","sourcesContent":["import axios from 'axios';\nimport { RequestArg, ResType } from './index'; \n\nconst baseURL = \"http://localhost:4500/v2\";\n\nasync function baseFetch(req: RequestArg): Promise<ResType> {\n  try {\n\n    const data = await axios(Object.assign({baseURL, responseType: \"json\"}, req));\n    \n    return data;\n\n  } catch(e) {\n    return {\n      success: false,\n      error: e\n    };\n  }\n}\n\nconst apiUtils = {\n  baseFetch\n}\n\nexport default apiUtils;","function getCookieList() {\n  return document.cookie;\n}\n\nfunction getCookie(name: string): string | null {\n  const cookieList:any = document.cookie;\n    \n  if(cookieList) {\n    const cookieValue = cookieList? \n      cookieList\n      .split(\"; \")\n      .find((row: any) => row.startsWith(name))\n      .split(\"=\")[1] : null;\n\n    return cookieValue;\n  } else {\n    return null;\n  }\n}\n\nconst CookieUtils = {\n  getCookie,\n  getCookieList\n}\n\nexport default CookieUtils;","import apiUtils    from './apiUtils';\nimport cookieUtils from './cookieUtils';\nimport { AxiosRequestConfig } from 'axios';\n\n\nexport type ResType<T = any> = T & {\n  success: boolean;\n  error?: any;\n};\n\nexport type RequestArg<Data = any , Params = any> = {\n  method: AxiosRequestConfig[\"method\"];\n  url: string;\n  data?: Data;\n  params?: Params;\n  withCredentials?: boolean;\n}\n\n/**\n * Api Utils\n */\nexport const baseFetch = apiUtils.baseFetch;\n\n/**\n * Cookie Utils\n */\nexport const getCookie = cookieUtils.getCookie;\nexport const getCookieList = cookieUtils.getCookieList;\n\n","import { ResType, RequestArg } from \"../../../../utils/api-utils\";\nimport { baseFetch } from \"../../../../utils/api-utils\";\n\nasync function authFetchPost(url: string, data: object): Promise<ResType> {\n  return await baseFetch({\n    method: \"post\",\n    url: `/auth/${url}`,\n    withCredentials: true,\n    data\n  })\n}\n\nasync function authFetchGet(url: string): Promise<ResType> {\n  return await baseFetch({\n    method: \"get\",\n    url: `auth/${url}`,\n    withCredentials: true\n  })\n}\n\n\n\nconst authApiUtils = {\n  authFetchPost,\n  authFetchGet\n}\n\nexport default authApiUtils;","import { \n  RequiredUserInfo, \n  SIGNUPUSER, \n  UserAuthInfo, \n  SIGNINUSER, \n  User, \n  SIGNINUSER_SUCCESS, \n  SIGNINUSER_ERROR, \n  SIGNOUTUSER,\n  SIGNOUTUSER_SUCCESS,\n  SIGNOUTUSER_ERROR,\n  RESIGNINUSER,\n  RESIGNINUSER_SUCCESS,\n  RESIGNINUSER_ERROR,\n  SIGNUPUSER_SUCCESS,\n  SIGNUPUSER_ERROR,\n  REISSUETOKEN_ERROR,\n  REISSUETOKEN,\n  RESET_AUTH\n } from \".\";\n\nconst signUpUser = ( requiredUserInfo: RequiredUserInfo ) => {\n  return {\n    type: SIGNUPUSER,\n    payload: requiredUserInfo\n  }\n}\n\nconst signUpUserSuccess = () => {\n  return {\n    type: SIGNUPUSER_SUCCESS\n  }\n}\n\nconst signUpUserError = (error: any) => {\n  return {\n    type: SIGNUPUSER_ERROR,\n    payload: {\n      error\n    }\n  }\n}\n\nconst signInUser = ( userAuthInfo: UserAuthInfo ) => {\n  return {\n    type: SIGNINUSER,\n    payload: userAuthInfo\n  }\n}\n\nconst signInUserSuccess = (payload: User) => {\n  return {\n    type: SIGNINUSER_SUCCESS,\n    payload\n  }\n};\n\nconst signInUserError = (payload: User) => {\n  return {\n    type: SIGNINUSER_ERROR,\n    payload\n  }\n}\n  \nconst signOutUser = () => {\n  return {\n    type: SIGNOUTUSER\n  }\n}\n\nconst signOutUserSuccess = () => {\n  return {\n    type: SIGNOUTUSER_SUCCESS\n  }\n}\n\nconst signOutUserError = () => {\n  return {\n    type: SIGNOUTUSER_ERROR\n  }\n};\n\nconst reSignInUser = () => {\n  return {\n    type: RESIGNINUSER\n  }\n}\n\nconst reSignInUserSuccess = (payload: User) => {\n  return {\n    type: RESIGNINUSER_SUCCESS,\n    payload\n  }\n};\n\nconst reSignInUserError = (payload: User) => {\n  return {\n    type: RESIGNINUSER_ERROR,\n    payload\n  }\n};\n\nconst reissueToken = () => {\n  return {\n    type: REISSUETOKEN\n  }\n}\n\nconst reissueTokenError = (payload: User) => {\n  return {\n    type: REISSUETOKEN_ERROR,\n    payload\n  }\n}\n\nconst resetAuth = () => {\n  return {\n    type: RESET_AUTH\n  }\n}\n\nconst actions = {\n  signUpUser,\n  signUpUserSuccess,\n  signUpUserError,\n  signInUser,\n  signInUserError,\n  signInUserSuccess,\n  signOutUser,\n  signOutUserError,\n  signOutUserSuccess,\n  reSignInUser,\n  reSignInUserError,\n  reSignInUserSuccess,\n  reissueToken,\n  reissueTokenError,\n  resetAuth\n}\n\nexport default actions;","import authApiUtils from './apiUtils';\nimport actions from './actions';\n\nexport const SIGNUPUSER = \"auth/SIGN_UP_USER\" as const;\nexport const SIGNUPUSER_SUCCESS = \"auth/SIGN_UP_USER_SUCCESS\" as const;\nexport const SIGNUPUSER_ERROR = \"auth/SIGN_UP_USER_ERROR\" as const;\n\nexport const SIGNINUSER = \"auth/SIGN_IN_USER\" as const;\nexport const SIGNINUSER_SUCCESS = \"auth/SIGN_IN_USER_SUCCESS\" as const;\nexport const SIGNINUSER_ERROR = \"auth/SIGN_IN_USER_ERROR\" as const;\n\nexport const SIGNOUTUSER = \"auth/SIGN_OUT_USER\" as const;\nexport const SIGNOUTUSER_SUCCESS = \"auth/SIGN_OUT_USER_SUCCESS\" as const;\nexport const SIGNOUTUSER_ERROR = \"auth/SIGN_OUT_USER_ERROR\" as const;\n\nexport const RESIGNINUSER = \"auth/RESIGN_IN_USER\" as const;\nexport const RESIGNINUSER_SUCCESS = \"auth/RESIGN_IN_USER_SUCCESS\" as const;\nexport const RESIGNINUSER_ERROR = \"auth/RESIGN_IN_USER_ERROR\" as const;\n\nexport const REISSUETOKEN = \"REISSUETOKEN\" as const;\nexport const REISSUETOKEN_ERROR = \"REISSUETOKEN_ERROR\" as const;\n\nexport const RESET_AUTH = \"auth/RESET_AUTH\" as const;\n\nexport interface AuthState {\n  loading: boolean;\n  user: UserInfo | null;\n  error: {\n    signInUser: SignInError | null,\n    signUpUser: SignUpError,\n    signOutUser: any\n  }\n}\n\nexport interface UserProfile {\n  penName: string;\n  profileId: string;\n  userPhoto: string;\n  bio: string; \n}\n\nexport interface UserInfo extends UserProfile {\n  firstName: string;\n  lastName: string;\n  email: string;\n  userId: string;\n}\n\nexport interface User {\n  userInfo: UserInfo | null;\n  error: SignInError | null;\n}\n\nexport interface SignInError {\n  countOfFail: number;\n  isActive: boolean;\n  isNotDormant: boolean;\n}\n\nexport interface AuthReq<T = any> {\n  url: string,\n  data: T\n}\n\nexport interface UserAuthInfo {\n  email: string;\n  password: string;\n}\n\nexport interface RequiredUserInfo extends UserAuthInfo {\n  penName: string;\n  firstName: string;\n  lastName: string;\n}\n\nexport interface SignUpError {\n  emailValid: boolean;\n  passwordValid: boolean;\n  penNameValid: boolean;\n  emailUsed: boolean;\n  penNameUsed: boolean;\n}\n\nexport interface ResSignUpUser {\n  error? : {\n    emailValid: boolean;\n    passwordValid: boolean;\n    penNameValid: boolean;\n    emailUsed: boolean;\n    penNameUsed: boolean;\n  }\n}\n\n\n/**\n * actions\n */\nexport const signUpUser = actions.signUpUser;\nexport const signInUser = actions.signInUser;\nexport const signOutUser = actions.signOutUser;\nexport const reSignInUser = actions.reSignInUser;\nexport const reissueToken = actions.reissueToken;\nexport const resetAuth = actions.resetAuth;\n\nconst { \n  signUpUserSuccess,\n  signUpUserError,\n  signInUserSuccess, \n  signInUserError,\n  signOutUserSuccess,\n  signOutUserError,\n  reSignInUserError,\n  reSignInUserSuccess,\n  reissueTokenError\n} = actions;\n\nexport type AuthActions = \n  ReturnType<typeof signUpUser>\n  | ReturnType<typeof signUpUserSuccess>\n  | ReturnType<typeof signUpUserError>\n  | ReturnType<typeof signInUser>\n  | ReturnType<typeof signOutUser>\n  | ReturnType<typeof signInUserSuccess>\n  | ReturnType<typeof signInUserError>\n  | ReturnType<typeof signOutUserSuccess>\n  | ReturnType<typeof signOutUserError>\n  | ReturnType<typeof reSignInUser>\n  | ReturnType<typeof reSignInUserSuccess>\n  | ReturnType<typeof reSignInUserError>\n  | ReturnType<typeof reissueTokenError>\n  | ReturnType<typeof resetAuth>\n;\n\nexport const authFetchPost = authApiUtils.authFetchPost;\nexport const authFetchGet  = authApiUtils.authFetchGet;\n\n","import { useCallback } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { \n  AuthState, \n  UserAuthInfo, \n  UserInfo,\n  signInUser, \n  reSignInUser, \n  signOutUser,\n  reissueToken,\n  RequiredUserInfo,\n  signUpUser\n} from '../store/modules/auth/utils';\nimport { RootState } from '../store/modules';\nimport authApiUtils from '../store/modules/auth/utils/apiUtils';\n\nfunction useAuth() {\n  const state: AuthState = useSelector((state: RootState) => state.auth);\n\n  const dispatch = useDispatch();\n\n  const onSignUpUser = useCallback((requiredUserInfo: RequiredUserInfo) => \n    dispatch(signUpUser(requiredUserInfo)), [dispatch]);\n\n  const onSignInUser = useCallback((userAuthInfo: UserAuthInfo) => \n      dispatch(signInUser(userAuthInfo))\n    ,[dispatch]);\n  \n  const onReSignInUser = useCallback(()=> dispatch(reSignInUser()),[dispatch]);\n\n  const onSignOutUser = useCallback(()=> dispatch(signOutUser()),[dispatch]);\n\n  const onReissueToken = useCallback(()=> dispatch(reissueToken()),[dispatch]);\n\n  const onCheckToken = async () => {\n    const response = await authApiUtils.authFetchGet('check-token');\n    console.log(response);\n    const data = response.data? response.data : null;\n    const success = response.data? response.data.success : false;\n\n     if(!success) {\n\n       if(state.user) {\n        onReissueToken();\n       }\n\n     } else {\n\n       if(!state.user) {\n\n         onReSignInUser();\n       \n        } else {\n         \n          if(state.user.userId !== data.userId) {\n            onSignOutUser();\n          }\n\n       }\n     }\n  }\n\n  return {\n    authState: state,\n    onSignUpUser,\n    onSignInUser,\n    onReSignInUser,\n    onSignOutUser,\n    onReissueToken,\n    onCheckToken\n  }\n}\n\nexport default useAuth;","import React from 'react';\n\ninterface InputComponentProps {\n  boxClass?: string;\n  labelClass?: string;\n  onChange: any;\n  value: string | number; \n  placeholder: string;\n  label: string;\n  className?: string;\n  type: string;\n  name: string;\n  id?: string;\n  children?: any;\n  autoComplete?: string;\n}\n\nfunction InputComponent({\n  boxClass,\n  labelClass,\n  onChange,\n  value,\n  placeholder,\n  label,\n  className,\n  type,\n  name,\n  id,\n  autoComplete,\n  children\n}: InputComponentProps) {\n  return (\n    <div className={boxClass}>\n      <label \n        htmlFor={type} \n        className={labelClass}\n      >\n        { label }\n      </label>\n      <input \n        id={id} \n        name={name} \n        type={type} \n        className={className}\n        placeholder={placeholder} \n        value={value}\n        onChange={onChange}\n        autoComplete={autoComplete}\n      />\n      { children }\n    </div>\n  )\n}\n\nexport default InputComponent;","import { useState } from 'react';\n\ntype UseChangeType<T> = [T, (e: any)=> void, boolean, (P: boolean)=> void];\n\nfunction useChange<T = string>(defaultValue: T): UseChangeType<T> {\n  const [ value, setValue ] = useState<T>(defaultValue);\n  const [ error, setError ] = useState<boolean>(false);\n\n  const handleValue = (e:any) => {\n    if(error) {\n      setError(false);\n    }\n    setValue(e.target.value);\n  }\n\n  const handleError = (data: boolean) => {\n    setError(data);\n  }\n\n  return [ value, handleValue, error, handleError ];\n}\n\nexport default useChange;","import React, { useState, useEffect } from 'react';\nimport classNames from 'classnames';\nimport useAuth from '../../../hooks/useAuth';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faLock } from '@fortawesome/free-solid-svg-icons';\nimport InputComponent from '../InputComponent';\nimport useChange from '../../../hooks/useChange';\n\ninterface InputPropsType {\n  value: string;\n  onChange: (e: any) => void;\n  id: string;\n  name: string;\n  type: string;\n  label: string;\n  placeholder: string;\n  autoComplete: string;\n  error: boolean;\n  style: string;\n}\n\n\n// 전송 전에 validation 체크\nfunction SignInForm() {\n\n  const {\n    authState : { error: { signInUser } },\n    onSignInUser\n  } = useAuth();\n\n  const [error, setError] = useState<boolean>(false);\n\n  const [ email, handleInputEmail, errorEmail, handleErrorEmail ] = useChange<string>(\"\");\n  const [ password, handleInputPwd, errorPwd, handleErrorPwd ] = useChange<string>(\"\");\n\n  const inputProps: InputPropsType[] = [\n    {\n      value: email,\n      onChange: handleInputEmail,\n      id: \"email-address\",\n      name: \"email\",\n      type: \"email\",\n      label: \"Email address\",\n      placeholder: \"example@example.com\",\n      autoComplete: \"on\",\n      error: errorEmail,\n      style: \"rounded-t-md\"\n    },\n    {\n      value: password,\n      onChange: handleInputPwd,\n      id: \"password\",\n      name: \"password\",\n      type: \"password\",\n      label: \"password\",\n      placeholder: \"비밀번호\",\n      autoComplete: \"off\",\n      error: errorPwd,\n      style: \"rounded-b-md\"\n    }\n  ]\n\n  const handleClickSubmit = (e: any) => {\n    e.preventDefault();\n    if(email && password) {\n      onSignInUser({email, password});\n    } else {\n      handleErrorEmail(email? false : true);\n      handleErrorPwd(password? false : true);\n    }\n  }\n\n  useEffect(() => {\n    if(signInUser) {\n      setError(true);\n    }\n  },[signInUser]);\n\n  return (\n    <form className=\"mt-12\" onSubmit={handleClickSubmit} action=\"#\">\n      <div className=\"rounded-md shadow-sm -space-y-px\">\n        {\n          inputProps.map((props)=>\n            <InputComponent\n              key={props.id}\n              labelClass=\"sr-only\"\n              className={classNames(\n                \"dark:bg-gray-100 appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 focus:ring-1 sm:text-sm\",\n                props.style,\n                {\"border-red-500\": props.error}\n              )}\n              value={props.value}\n              onChange={props.onChange}\n              id={props.id} \n              name={props.name}\n              type={props.type}\n              label={props.label}\n              placeholder={props.placeholder}\n              autoComplete={props.autoComplete}\n            />\n          )\n        }\n      </div>\n      <div \n        className=\"mb-8 leading-6 h-6 block text-red-500 text-sm font-semibold text-left px-2\"\n      > \n        { \n          error? \n          `가입하지 않은 계정이거나, 잘못된 비밀번호입니다.` \n          : errorEmail || errorPwd \n          ? `계정과 패스워드를 입력해주세요.` \n          : null \n        } \n      </div>\n\n      <div>\n        <button type=\"submit\" onClick={handleClickSubmit} className=\"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-purple-500 hover:bg-purple-600 active:outline-none active:ring-2 active:ring-offset-2 active:ring-purple-600\">\n          <span className=\"absolute left-0 inset-y-0 flex items-center pl-3\">\n            <FontAwesomeIcon className=\"text-base text-purple-300 group-hover:text-purple-200\" icon={faLock} />\n          </span>\n          Sign in\n        </button>\n      </div>\n    </form>\n  )\n}\n\nexport default SignInForm;","import React from 'react';\nimport SignInForm from './SignInForm';\n\nfunction SignIn() {\n\n  return (\n    <div className=\"sign-in w-full h-full flex justify-center bg-gray-50 dark:bg-black pt-40 px-4 sm:px-6 lg:px-8 shadow rounded-md\">\n      <div className=\"max-w-md w-full space-y-10\">\n        <div>\n          <h2 className=\"text-center text-3xl font-extrabold text-gray-900 dark:text-gray-100\">\n            Sign in to your account\n          </h2>\n        </div>\n        <SignInForm />\n      </div>\n    </div>\n  ) \n}\n\nexport default SignIn;","import SignIn from './SignIn';\n\nexport default SignIn;","import React, { useEffect } from 'react';\nimport classNames from 'classnames';\nimport InputComponent from '../InputComponent';\nimport useChange from '../../../hooks/useChange';\nimport useAuth from '../../../hooks/useAuth';\n\ninterface ErrorType {\n  used?: boolean;\n  valid?: boolean;\n  name: string\n}\n\nfunction createErrorMessage({ used, valid, name }: ErrorType) {\n  if(valid) {\n    return `${name} 형식에 맞지 않습니다.`\n  }\n  if(used) {\n    return `사용하고 있는 ${name}입니다.`\n  }\n  return \"필수 정보입니다.\";\n}\n\ninterface InputPropsType {\n  id: string;\n  name: string;\n  type: string;\n  label: string;\n  placeholder: string;\n  value: string | number;\n  onChange: (e: any) => void;\n  error: boolean;\n  errorMessage?: string;\n}\n\n// 전송 전에 validation 체크\nfunction SignUpForm() {\n\n  const [ lastName, handleInputLName, errorLastName, handleErrorLName ] = useChange<string>(\"\");\n  const [ firstName, handleInputFName, errorFirstName, handleErrorFName ] = useChange<string>(\"\");\n  const [ penName, handleInputPName, errorPenName, handleErrorPName ] = useChange<string>(\"\");\n  const [ email, handleInputEmail, errorEmail, handleErrorEmail ] = useChange<string>(\"\");\n  const [ password, handleInputPwd, errorPwd, handleErrorPwd ] = useChange<string>(\"\");\n\n  const { authState: { error: {signUpUser : \n    { emailUsed, emailValid, passwordValid, penNameUsed, penNameValid }}}, \n    onSignUpUser \n  } = useAuth();\n\n  const inputProps: InputPropsType[] = [\n    {\n      id: \"last-name\",\n      name: \"lastName\",\n      type: \"text\",\n      label: \"성\",\n      placeholder: \"성\",\n      value: lastName,\n      onChange: handleInputLName,\n      error: errorLastName,\n      errorMessage: \"필수 정보입니다.\"\n    },\n    {\n      id: \"first-name\",\n      name: \"firstName\",\n      type: \"text\",\n      label: \"이름\",\n      placeholder: \"이름\",\n      value: firstName,\n      onChange: handleInputFName,\n      error: errorFirstName,\n      errorMessage: \"필수 정보입니다.\"\n    },\n    {\n      id: \"pen-name\",\n      name: \"penName\",\n      type: \"text\",\n      label: \"필명\",\n      placeholder: \"영문 필수, 중복이 불가합니다.\",\n      value: penName,\n      onChange: handleInputPName,\n      error: errorPenName,\n      errorMessage: createErrorMessage({\n        name: \"필명\",\n        used: penNameUsed,\n        valid: penNameValid\n      }) \n    },\n    {\n      id: \"email-address\",\n      name: \"email\",\n      type: \"email\",\n      label: \"계정(이메일)\",\n      placeholder: \"example@example.com\",\n      value: email,\n      onChange: handleInputEmail,\n      error: errorEmail,\n      errorMessage: createErrorMessage({\n        name: \"이메일\",\n        used: emailUsed,\n        valid: emailValid\n      }) \n    },\n    {\n      id: \"password\",\n      name: \"password\",\n      type: \"password\",\n      label: \"비밀번호\",\n      placeholder: \"영문, 숫자 조합 8 ~ 12자로 작성해주세요.\",\n      value: password,\n      onChange: handleInputPwd,\n      error: errorPwd,\n      errorMessage: createErrorMessage({\n        name: \"비밀번호\",\n        valid: passwordValid\n      }) \n    }\n  ];\n\n  const handleSubmit = (e: any) => {\n    e.preventDefault();\n    if(!errorLastName && !errorFirstName && !errorEmail && !errorPenName && !errorPwd) {\n      if(penName && firstName && lastName && email && password) {\n        onSignUpUser({\n          penName,\n          firstName,\n          lastName,\n          email,\n          password\n        })\n      } else {\n        handleErrorLName(lastName? false : true);\n        handleErrorFName(firstName? false : true);\n        handleErrorPName(penName? false : true);\n        handleErrorEmail(email? false : true);\n        handleErrorPwd(password? false : true);\n      }\n    } else {\n      console.log(\"실행 안됨\")\n    }\n  }\n\n  useEffect(()=> {\n    if(emailUsed || emailValid) {\n      handleErrorEmail(true);\n    } \n    if(penNameUsed || penNameValid) {\n      handleErrorPName(true);\n    }\n    if(passwordValid) {\n      handleErrorPwd(true);\n    }\n  },[emailUsed, emailValid, passwordValid, penNameUsed, penNameValid])\n\n  return (\n    <form onSubmit={handleSubmit}>\n\n      <div className=\"overflow-hidden sm:rounded-md mb-8\">\n        \n        <div className=\"rounded-md p-2 space-y-4\">\n          \n          {\n            inputProps.map(props =>(\n              <InputComponent \n                key={props.id}\n                boxClass=\"relative group\"\n                labelClass=\"pl-1 mb-1 block text-sm font-medium text-gray-700 dark:text-gray-50\"\n                className={classNames(\n                  \"rounded-md dark:bg-gray-100 appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 focus:ring-1 sm:text-sm\",\n                  {\"border-red-500\": props.error}\n                )}\n                value={props.value}\n                onChange={props.onChange}\n                id={props.id}\n                name={props.name}\n                type={props.type}\n                label={props.label}\n                placeholder={props.placeholder}\n                autoComplete=\"off\"\n              >\n                <span \n                  className={classNames(\n                    \"absolute right-0 top-0 text-red-500 text-sm\",\n                    {\"hidden\": !props.error}\n                  )}\n                >\n                  {props.errorMessage}\n                </span>\n              </InputComponent>\n            ))\n          }\n\n        </div>\n\n      </div>\n\n      <div className=\"p-2\">\n        <button type=\"submit\" onClick={handleSubmit} className=\"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-purple-500 hover:bg-purple-600 active:outline-none active:ring-2 active:ring-offset-2 active:ring-purple-600\">\n          Sign up\n        </button>\n      </div>\n\n    </form>\n  )\n}\n\nexport default SignUpForm;","import React from 'react';\nimport SignUpForm from './SignUpForm';\n\nfunction SignUp() {\n  return (\n    <div className=\"sign-up relative overflow-auto flex items-center w-full h-full bg-gray-50 dark:bg-black shadow rounded-md\">\n      <div className=\"absolute left-0 top-auto py-32 w-full h-auto box-contents flex justify-center\">\n        <div className=\"max-w-md w-full h-auto space-y-10\">\n          <div>\n            <h2 className=\"text-center text-3xl font-extrabold text-gray-900 dark:text-gray-100\">\n              Sign up\n            </h2>\n          </div>  \n          <SignUpForm />\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default SignUp;","import SignUp from './SignUp';\n\nexport default SignUp;","import { CHANGE_PAGE_TITLE, PageState, CHANGE_TOGGLE } from \"./utils\";\n\nexport function changeToggle(toggle?: boolean) {\n  return {\n    type: CHANGE_TOGGLE,\n    payload: {\n      toggle\n    }\n  }\n}\n\nexport function changePageTitle(pageId: string, title: string) {\n  return {\n    type: CHANGE_PAGE_TITLE,\n    payload: {\n      title,\n      pageId\n    }\n  }\n}\n\ntype PageActions = ReturnType<typeof changePageTitle>\n  | ReturnType<typeof changeToggle>;\n\nconst initialState: PageState = {\n  toggle: false,\n  loading: false,\n  pageEditor: {\n    penName: \"Junhee\",\n    profileId: \"4c382a569f1f4ea7841b25bd2efe78d8\",\n    bio: \"프론트엔드 개발자\",\n    userPhoto: \"https://avatars.githubusercontent.com/u/59816563?v=4\"\n  },\n  pageList: [\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e61\",\n      pageTitle: \"관리자 사용 설명서\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e62\",\n      pageTitle: \"사용자 사용 설명서\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e63\",\n      pageTitle: \"사용자 이용 문의 방법\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e64\",\n      pageTitle: \"감사합니다.\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e65\",\n      pageTitle: \"test5\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e61\",\n      pageTitle: \"관리자 사용 설명서\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e62\",\n      pageTitle: \"사용자 사용 설명서\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e63\",\n      pageTitle: \"사용자 이용 문의 방법\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e64\",\n      pageTitle: \"감사합니다.\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e65\",\n      pageTitle: \"test5\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e61\",\n      pageTitle: \"관리자 사용 설명서\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e62\",\n      pageTitle: \"사용자 사용 설명서\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e63\",\n      pageTitle: \"사용자 이용 문의 방법\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e64\",\n      pageTitle: \"감사합니다.\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e65\",\n      pageTitle: \"test5\"\n    }\n  ]\n};\n\nexport default function page(state: PageState = initialState, action: PageActions) {\n\n  switch(action.type) {\n    case CHANGE_TOGGLE:\n      return Object.assign({}, state, {\n        toggle: action.payload.toggle !== undefined? action.payload : !state.toggle\n      });\n\n    case CHANGE_PAGE_TITLE:\n      const { title, pageId } = action.payload;\n\n      return Object.assign({}, state, {\n        pageList: state.pageList.map(page => {\n          if(page.pageId === pageId) {\n            return Object.assign({}, page, {\n              pageTitle: title\n            });\n          } else {\n            return page\n          }\n        })\n      });\n\n    default: \n      console.log(state);\n      return state;\n  }\n\n}","import { useCallback } from 'react';\nimport { changePageTitle, changeToggle } from '../store/modules/page';\nimport { PageState } from '../store/modules/page/utils';\nimport { RootState } from '../store/modules';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { UserProfile } from '../store/modules/auth/utils';\n\nfunction usePage() {\n  const state: PageState = useSelector((state: RootState) => state.page);\n\n  const pageEditor: UserProfile = state.pageEditor;\n\n  const pageToggle: boolean = state.toggle;\n\n  const dispatch = useDispatch();\n\n  const onChangeToggle = useCallback((toggle?: boolean)=> \n    dispatch(changeToggle(toggle)),[dispatch]);\n\n  const onChangePageTitle = useCallback((pageId: string, title: string) => \n    dispatch(changePageTitle(pageId, title)), [dispatch]);\n\n  return {\n    pageState: state,\n    pageEditor,\n    pageToggle,\n    onChangeToggle,\n    onChangePageTitle\n  }\n}\n\nexport default usePage;","import { UserProfile } from \"../../auth/utils\";\n\nexport const CHANGE_PAGE_TITLE = \"page/CHANGE_PAGE_TITLE\" as const;\nexport const CHANGE_TOGGLE = \"page/CHANGE_TOGGLE\" as const;    \n\nexport interface Page {\n  pageId: string;\n  pageTitle: string;\n}\n\n\nexport interface PageState {\n  toggle: boolean;\n  loading: boolean;\n  pageEditor: UserProfile;\n  pageList: Page[];\n}\n\n","import React, { useEffect } from 'react';\nimport { Route, Switch, Redirect } from 'react-router-dom';\nimport SignIn from '../components/auth/sign-in';\nimport SignUp from '../components/auth/sign-up';\nimport useAuth from '../hooks/useAuth';\nimport usePage from '../hooks/usePage';\n\n\n\n\nfunction AuthPage() {\n  const { authState: { user } } = useAuth();\n  const { onChangeToggle } = usePage();\n\n  useEffect(() => {\n    if(user) {\n      onChangeToggle(true);\n    }\n    \n  },[user]);\n\n  if(user) {\n    return <Redirect to={`/bklog/${user.penName}`} />\n  }\n\n  return (\n    <div className=\"auth-page w-full h-full items-center p-4 rounded overflow-hidden\">\n      <Switch>\n        <Route path=\"/auth/sign-up\">\n          <SignUp />\n        </Route>\n        <Route path=\"/auth/sign-in\">\n          <SignIn />\n        </Route>\n      </Switch>\n    </div>\n  )\n}\n\nexport default AuthPage;","import { BaseState, changeDarkMode } from \"../store/modules/base/utils\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { RootState } from \"../store/modules\";\nimport { useCallback } from \"react\";\n\nfunction useBase() {\n  const state: BaseState = useSelector((state: RootState) => state.base);\n\n  const dispatch = useDispatch();\n\n  const onChangeMode = useCallback(()=> dispatch(changeDarkMode()), [dispatch]);;\n\n  return {\n    baseState: state,\n    onChangeMode\n  }\n}\n\nexport default useBase;","export const CHANGE_DARK_MODE = \"base/CHANGE_DARK_MODE\" as const;\nexport const SERVER_DISCONNECTED = \"base/SERVER_DISCONNECTED\" as const;\n\nexport const changeDarkMode = () => {\n  return {\n    type: CHANGE_DARK_MODE\n  }\n}\n\nconst disconnectedSever = (error: any) => {\n  return {\n    type: SERVER_DISCONNECTED,\n    payload: {\n      error\n    }\n  }\n}\n\nexport type BaseActions = ReturnType<typeof changeDarkMode> | \n            ReturnType<typeof disconnectedSever>;\n\nexport interface BaseState {\n  dark: boolean;\n  error: any;\n}","import React, { useEffect } from 'react';\nimport { Link } from 'react-router-dom';\n\nfunction Home(props: any) {\n\n\n  // useEffect(()=> {\n  //   console.log(props.cookies);\n  //   setCookie('cert', \"dsad\", { path: '/'});\n  // }, [props.cookies])\n\n  return (\n    <div className=\"home\">\n      <Link to=\"/bklog\">\n        bklog 이동\n      </Link>\n\n    </div>\n  )\n}\n\nexport default Home;","import { \n  ContentType, \n  TextContents, \n  BlockData,\n  TextProps\n} from '../../../../types/bklog';\nimport { OrderType } from '.';\n\nconst BOLD = \"b\" as const;\nconst ITALY = \"i\" as const;\nconst UNDERBAR = \"_\" as const;\nconst FONT_COLOR = \"fc\" as const;\nconst BACKGROUND_COLOR = \"bc\" as const;\nconst ANCHOR = \"a\" as const;\nconst FONT = \"f\" as const;\n\nconst BK_BOLB = \"bk-bold\";\nconst BK_ITALIC = \"bk-italic\";\nconst BK_UNDER = \"bk-underbar\";\nconst BK_COLOR = \"color\";\nconst BK_BACKGROUND_COLOR = \"background-color\";\n\nconst FONT_WEIGHT = \"font-weight\";\nconst FONT_STYLE = \"font-style\";\nconst TEXT_DECORATION = \"text-decoration\";\nconst BOLDER_BOTTOM = \"border-bottom\";\n\nfunction convertType(prop: string):any {\n  switch(prop) {\n    case BK_BOLB:\n      return BOLD;\n    case BK_ITALIC:\n      return ITALY;\n    case BK_UNDER:\n      return UNDERBAR;\n    case BK_COLOR:\n      return FONT_COLOR;\n    case BK_BACKGROUND_COLOR:\n      return BACKGROUND_COLOR;\n    case BOLDER_BOTTOM:\n      return UNDERBAR;\n    default:\n      return null;\n  }\n}\n\n/**\n * \n * @param prop \n */\nfunction convertProperty(prop: string):any {\n  switch(prop) {\n    case \"700\":\n      return BOLD;\n    case \"italic\":\n      return ITALY;\n    default:\n      return prop;\n  }\n}\n\n/**\n * html 특수문자 컨버팅 함수\n * @param text \n * @param i \n */\nfunction specialCharacters(\n  text: string, \n  i: number\n  ): { word: string, count: number } {\n\n  let word:string = text[i];\n  let convertedWord: string;\n  let count = i + 1;\n  let length = text.length;\n\n  while(text[count] !== \" \" && text[count] !== \"&\" && count < length) {\n    word += text[count];\n    if(text[count] === \";\") break;\n    count++;\n  }\n\n  if(text[count] === \";\") {\n    switch(word) {\n      case \"&quot;\": \n        convertedWord = `\"`;\n        break;\n      case \"&amp;\":\n        convertedWord = \"&\";\n        break;\n      case \"&lt;\":\n        convertedWord = \"<\";\n        break;\n      case \"&gt;\":\n        convertedWord = \">\";\n        break;\n      case \"&nbsp;\":\n        convertedWord = \" \";\n        break;\n      case \"&iexcl;\":\n        convertedWord = \"¡\";\n        break;\n      case \"&cent;\":\n        convertedWord = \"￠\";\n        break;\n      case \"&pound;\":\n        convertedWord = \"￡\";\n        break;\n      case \"&curren;\":\n        convertedWord = \"¤\";\n        break;\n      case \"&yen;\":\n        convertedWord = \"￥\";\n        break;\n      case \"&brvbar;\":\n        convertedWord = \"|\";\n        break;\n      case \"&sect;\":\n        convertedWord = \"§\";\n        break;\n      case \"&uml;\":\n        convertedWord = \"¨\";\n        break;\n      case \"&copy;\":\n        convertedWord = \"ⓒ\";\n        break;\n      case \"&ordf;\":\n        convertedWord = \"ª\";\n        break;\n      case \"&laquo;\":\n        convertedWord = \"≪\";\n        break;\n      case \"&not;\":\n        convertedWord = \"￢\";\n        break;\n      case \"&shy;\":\n        convertedWord = \"-\";\n        break;\n      case \"&reg;\":\n        convertedWord = \"?\";\n        break;\n      case \"&macr;\":\n        convertedWord = word;\n        break;\n      case \"&deg;\":\n        convertedWord = \"°\";\n        break;\n      case \"&plusmn;\":\n        convertedWord = \"±\";\n        break;\n      case \"&sup1;\":\n        convertedWord = \"¹\";\n        break;\n      case \"&sup2;\":\n        convertedWord = \"²\";\n        break;\n      case \"&sup3;\":\n        convertedWord = \"³\";\n        break;\n      case \"&acute;\":\n        convertedWord = \"´\";\n        break;\n      case \"&micro;\":\n        convertedWord = \"μ\";\n        break;\n      case \"&para;\":\n        convertedWord = \"¶\";\n        break;\n      case \"&middot;\":\n        convertedWord = \"·\";\n        break;\n      case \"&cedil;\":\n        convertedWord = \"¸\";\n        break;\n      case \"&ordm;\":\n        convertedWord = \"º\";\n        break;\n      case \"&raquo;\":\n        convertedWord = \"≫\";\n        break;\n      case \"&frac14;\":\n        convertedWord = \"¼\";\n        break;\n      case \"&frac12;\":\n        convertedWord = \"½\";\n        break;\n      case \"&frac34;\":\n        convertedWord = \"¾\";\n        break;\n      case \"&iquest;\":\n        convertedWord = \"¿\";\n        break;\n      case \"&Agrave;\":\n        convertedWord = \"A\";\n        break;\n      case \"&Aacute;\":\n        convertedWord = \"A\";\n        break;\n      case \"&Acirc;\":\n        convertedWord = \"A\";\n        break;\n      case \"&Atilde;\":\n        convertedWord = \"A\";\n        break;\n      case \"&Auml;\":\n        convertedWord = \"A\";\n        break;\n      case \"&Aring;\":\n        convertedWord = \"A\";\n        break;\n      case \"&AElig;\":\n        convertedWord = \"Æ\";\n        break;\n      case \"&Ccedil;\":\n        convertedWord = \"C\";\n        break;\n      case \"&Egrave;\":\n        convertedWord = \"E\";\n        break;\n      case \"&Eacute;\":\n        convertedWord = \"E\";\n        break;\n      case \"&Ecirc;\":\n        convertedWord = \"E\";\n        break;\n      case \"&Euml;\":\n        convertedWord = \"E\";\n        break;\n      case \"&Igrave;\":\n        convertedWord = \"I\";\n        break;\n      case \"&Iacute;\":\n        convertedWord = \"I\";\n        break;\n      case \"&Icirc;\":\n        convertedWord = \"I\";\n        break;\n      case \"&Iuml;\":\n        convertedWord = \"I\";\n        break;\n      case \"&ETH;\":\n        convertedWord = \"Ð\";\n        break;\n      case \"&Ntilde;\":\n        convertedWord = \"N\";\n        break;\n      case \"&Ograve;\":\n        convertedWord = \"O\";\n        break;\n      case \"&Oacute;\":\n        convertedWord = \"O\";\n        break;\n      case \"&Ocirc;\":\n        convertedWord = \"O\";\n        break;\n      case \"&Otilde;\":\n        convertedWord = \"O\";\n        break;\n      case \"&Ouml;\":\n        convertedWord = \"O\";\n        break;\n      case \"&times;\":\n        convertedWord = \"×\";\n        break;\n      case \"&Oslash;\":\n        convertedWord = \"Ø\";\n        break;\n      case \"&Ugrave;\":\n        convertedWord = \"U\";\n        break;\n      case \"&Uacute;\":\n        convertedWord = \"U\";\n        break;\n      case \"&Ucirc;\":\n        convertedWord = \"U\";\n        break;\n      case \"&Uuml;\":\n        convertedWord = \"U\";\n        break;\n      case \"&Yacute;\":\n        convertedWord = \"Y\";\n        break;\n      case \"&THORN;\":\n        convertedWord = \"Þ\";\n        break;\n      case \"&szlig;\":\n        convertedWord = \"ß\";\n        break;\n      case \"&agrave;\":\n        convertedWord = \"a\";\n        break;\n      case \"&aacute;\":\n        convertedWord = \"a\";\n        break;\n      case \"&acirc;\":\n        convertedWord = \"a\";\n        break;\n      case \"&atilde;\":\n        convertedWord = \"a\";\n        break;\n      case \"&auml;\":\n        convertedWord = \"a\";\n        break;\n      case \"&aring;\":\n        convertedWord = \"a\";\n        break;\n      case \"&aelig;\":\n        convertedWord = \"æ\";\n        break;\n      case \"&ccedil;\":\n        convertedWord = \"c\";\n        break;\n      case \"&egrave;\":\n        convertedWord = \"e\";\n        break;\n      case \"&eacute;\":\n        convertedWord = \"e\";\n        break;\n      case \"&ecirc;\":\n        convertedWord = \"e\";\n        break;\n      case \"&euml;\":\n        convertedWord = \"e\";\n        break;\n      case \"&igrave;\":\n        convertedWord = \"i\";\n        break;\n      case \"&iacute;\":\n        convertedWord = \"i\";\n        break;\n      case \"&icirc;\":\n        convertedWord = \"i\";\n        break;\n      case \"&iuml;\":\n        convertedWord = \"i\";\n        break;\n      case \"&eth;\":\n        convertedWord = \"ð\";\n        break;\n      case \"&ntilde;\":\n        convertedWord = \"n\";\n        break;\n      case \"&ograve;\":\n        convertedWord = \"o\";\n        break;\n      case \"&oacute;\":\n        convertedWord = \"o\";\n        break;\n      case \"&ocirc;\":\n        convertedWord = \"o\";\n        break;\n      case \"&otilde;\":\n        convertedWord = \"o\";\n        break;\n      case \"&ouml;\":\n        convertedWord = \"o\";\n        break;\n      case \"&divide;\":\n        convertedWord = \"÷\";\n        break;\n      case \"&oslash;\":\n        convertedWord = \"ø\";\n        break;\n      case \"&ugrave;\":\n        convertedWord = \"u\";\n        break;\n      case \"&uacute;\":\n        convertedWord = \"u\";\n        break;\n      case \"&ucirc;\":\n        convertedWord = \"u\";\n        break;\n      case \"&uuml;\":\n        convertedWord = \"u\";\n        break;\n      case \"&yacute;\":\n        convertedWord = \"y\";\n        break;\n      case \"&thorn;\":\n        convertedWord = \"þ\";\n        break;\n      case \"&yuml;\":\n        convertedWord = \"y\";\n        break;\n\n      default: \n        convertedWord = word;\n    }\n  } else {\n    convertedWord = text[i];\n    count = i;\n  }\n\n  return {\n    word: convertedWord,\n    count\n  };\n}\n\nfunction parseHtmlContents(text:string):TextContents[] {\n\n  const newContents: any[] = [];\n  const textLength: number = text.length;\n\n  console.log(text);\n\n  let saveToggle:boolean = true;\n\n  let content: any = [];\n\n  let propertyToggle:boolean = false;\n  let linkToggle:boolean = false;\n\n  let propertys: any[] = [];\n  let property: string | null = null;\n  let type: string[] = [];\n\n  for(let i = 0; i < textLength; i++) {\n\n    if(!propertyToggle && !linkToggle) {\n\n      switch(text[i]) {\n        case \"<\": \n  \n          if(i && text[i+1] === \"/\" && (text[i+6] === \">\" || text[i+2] === \"a\")) {\n            if(content[0]) {\n              newContents.push(content);\n              content = [];\n            }\n            if(text[i+6] === \">\") {\n              i += 6;\n            } else {\n              i += 3;\n            }\n          \n            saveToggle = true;\n\n          } else {\n\n            saveToggle = false;\n  \n            if(content[0] !== undefined) {\n              newContents.push(content);\n              content = [];\n            } \n\n            if(text[i+1] === \"s\") {\n              i += 4;\n            } else if(text[i+1] === ANCHOR) {\n              i += 1;\n            }\n         \n          }\n  \n          break;\n        case \">\":\n          saveToggle = true;\n\n          break;\n  \n        case \"s\":\n  \n          if(!saveToggle) {\n           if(text[i+1] === \"t\" && text[i+5] === \"=\") {\n             i += 6;\n             propertyToggle = true;\n           }\n          } else {\n            content[0]? content[0] += text[i] : content[0] = text[i];\n          }\n\n          break;\n  \n        case \"c\":\n          if(!saveToggle) {\n            if(text[i+1] === \"l\" && text[i+5] === \"=\") {\n              i += 6;\n              propertyToggle = true;\n            }\n          } else {\n            content[0]? content[0] += text[i] : content[0] = text[i];\n          }\n\n          break;\n        \n        case \"h\":\n          if(!saveToggle) {\n            if(text[i+1] === \"r\" && text[i+3] === \"f\") {\n              i += 5;\n              linkToggle = true;\n            }\n    \n          } else {\n            content[0]? content[0] += text[i] : content[0] = text[i];\n          }\n\n          break;\n        \n        case \"&\":\n          const { word, count } = specialCharacters(text, i);\n          i = count;\n          content[0]? content[0] += word : content[0] = word;\n  \n          break;\n        \n        // chrome 번역기 동작시 font 태그가 주입될때 오작동 방지\n        case FONT:\n          if(!saveToggle) {\n            if(text[i - 1] === \"<\") {\n              while(text[i+1] !== \">\") {\n                i++\n              }\n            }\n          } else {\n            content[0]? content[0] += text[i] : content[0] = text[i];\n          }\n\n          break;\n          \n        default:\n          if(saveToggle) {\n            content[0]? content[0] += text[i] : content[0] = text[i];\n          }\n         \n      }\n\n    } else if (propertyToggle){\n\n      switch(text[i]) {\n\n        case \":\":\n          if(property) {\n            type = [convertType(property)]\n            property = null;\n          };\n          break;\n\n        case \";\":\n\n          if(type && property) {\n            type.push(convertProperty(property));\n            if(!type[0]) type.shift();\n            if(type[0] === UNDERBAR) type.pop();\n            propertys.push(type);\n            type = [];\n            property = null;\n          }\n\n          break;\n\n        case \" \":\n\n          if(property && !type[0]) {\n            type = [convertType(property)];\n            propertys.push(type);\n            type = []; \n\n            property = null;\n          }\n\n          break;\n\n        case '\"' || \"'\":\n \n          if(property) {\n            type = [convertType(property)];\n            if(type) {\n              propertys.push(type); \n            }\n          }\n\n          if(!content[1]) {\n            content = [content[0], ];\n            content[1] = [...propertys];\n          } else {\n            content[1] = [...content[1], ...propertys];\n          }\n          propertys = [];\n          propertyToggle = false;\n          property = null;\n          type = [];\n\n          break;\n\n        default: \n          property? property += text[i] : property = text[i];\n      }\n\n    } else if(linkToggle) {\n\n      if(text[i] === \"'\" || text[i] === '\"') {\n        if(!content[1]) {\n          content = [content[0],[[ANCHOR, property]]];\n        } else {\n          content[1].push([ANCHOR, property]);\n        }\n        \n        property = null;\n        linkToggle = false;\n\n      } else {\n        property? property += text[i] : property = text[i];\n      }\n    }\n    \n  }\n\n  if(content[0]) {\n    newContents.push(content);\n  }\n\n  return newContents;\n}\n\nexport function equalsArray(aryA: any[], aryB: any[]): boolean {\n  if(!aryA && !aryB) return true;\n  if(!Array.isArray(aryA) || !Array.isArray(aryB) || aryA.length !== aryB.length ) return false;\n\n  const targetBList = [];\n\n  for(let i = 0; i < aryA.length; i++) {\n    const targetA = JSON.stringify(aryA[i]);\n    if(!i) {\n      for(let ii = 0; ii < aryB.length; ii++) {\n\n        const targetB = JSON.stringify(aryB[ii]);\n        if(targetA === targetB) {\n          \n        } else {\n          targetBList.push(targetB)\n        }\n\n      }\n      if(targetBList.length === aryB.length) return false;\n    } else {\n      const targetBListLength = targetBList.length;\n\n      for(let ii = 0; ii < targetBList.length; ii++) {\n        if(targetBList[ii] === targetA) {\n          targetBList.splice(ii, 1);\n          break;\n        } \n      }\n\n      if(targetBListLength === targetBList.length) {\n        return false;\n      }\n      \n    }\n  } \n\n  return targetBList.length? false : true;\n}\n\nexport function arrayFindIndex(array: any[], factor: any): number {\n  const JSONFactor = JSON.stringify(factor[0]);\n\n  for(let i = 0; i < array.length; i++) {\n    const JSONArray = JSON.stringify(array[i][0]);\n    if(JSONArray === JSONFactor) {\n      return i;\n    }\n  }\n  return -1;\n}\n\n\nfunction addContentsStyle(\n  preTexts: TextContents[], \n  startPoint: number, \n  endPoint: number, \n  style: ContentType\n  ): TextContents[] {\n  let count = 0;\n  let insertText: any = [\"\",[]];\n  let newContents = [];\n\n  preTexts.forEach( (text: any) => {\n\n    for(let i = 0; i < text[0].length; i++) {\n      if(count === startPoint \n        || (count + 1) === endPoint\n        || (count >= startPoint && count < endPoint && i === 0)\n      ) {\n        if(arrayFindIndex(insertText[1], style) === -1) {\n\n          if(insertText[0]) newContents.push(insertText);\n\n          if(text[1]) {\n            if(arrayFindIndex(text[1], style) !== -1) {\n              insertText = [\"\", [...text[1]]];\n            } else {\n              insertText = [\"\", [...text[1], style]];\n            };\n          } else {\n            insertText = [\"\", [style]];\n          };\n\n        } else {\n          \n          if(text[1]) {\n            if(arrayFindIndex(text[1], style) !== -1) {\n\n              if(!equalsArray(insertText[1], text[1])) {\n                newContents.push(insertText);\n                insertText = [\"\", [...text[1]]];\n              };\n\n            } else {\n\n              if(!equalsArray(insertText[1], [...text[1], style])) {\n                newContents.push(insertText);\n                insertText = [\"\", [...text[1], style]];\n              };\n\n            };\n          } else {\n            \n            if(!equalsArray(insertText[1], [style])) {\n              newContents.push(insertText);\n              insertText = [\"\", [style]];\n            };\n\n          };\n        };\n\n      } else if(count === endPoint || i === 0){\n        if(!equalsArray(insertText[1], text[1]? text[1] : [])) { \n          if(insertText[0]) {\n            newContents.push(insertText);\n          }\n          insertText = text[1]?[\"\", [...text[1]]] : [\"\", []];\n        };\n      };\n\n      insertText[0] += text[0][i];\n      count++;\n    }\n    \n  })\n\n  newContents.push(insertText);\n\n  return newContents.map(content => content[1][0]? content : [content[0]]);\n}\n\nfunction deleteContentsStyle(\n  preTexts: TextContents[], \n  startPoint:number, \n  endPoint:number, \n  style: ContentType\n  ): TextContents[] {\n  let count = 0;\n  let insertText:any = [\"\",[]];\n  let newContents = [];\n\n  preTexts.forEach((text: any) => {\n    for(let i = 0; i < text[0].length; i++) {\n\n      if(count === startPoint \n        || (count + 1) === endPoint\n        || (count > startPoint && count < endPoint && i === 0)\n      ) {\n        \n        let stylePosition: number;\n\n        if(text[1]) {\n          if(equalsArray(insertText[1], text[1])) {\n            stylePosition = arrayFindIndex(insertText[1], style);\n\n            if(stylePosition !== -1) {\n              newContents.push(insertText);\n              const newStyle = [...insertText[1]];\n              newStyle.splice(stylePosition, 1);\n              insertText = [\"\", [...newStyle]];\n            } \n\n          } else {\n            const textStylePosition = arrayFindIndex(text[1], style);\n            const newText = [...text[1]];\n            stylePosition = arrayFindIndex(insertText[1], style);\n            \n            if(stylePosition !== -1) {\n              if(insertText[0]) newContents.push(insertText);\n              const newStyle = [...insertText[1]];\n\n              if(textStylePosition !== -1) {\n                newText.splice(textStylePosition, 1);\n                insertText = [\"\", [...newText]];\n              } else {\n                insertText = [\"\", [...text[1]]];\n              }\n\n            } else {\n\n              if(textStylePosition !== -1) {\n                newText.splice(textStylePosition, 1);\n\n                if(!equalsArray(insertText[1], newText)) {\n                  if(insertText[0]) newContents.push(insertText);\n                  insertText = [\"\", [...newText]];\n                }\n\n              } else {\n                if(!equalsArray(insertText[1], text[1])) {\n                  if(insertText[0]) newContents.push(insertText);\n                  insertText = [\"\", [...text[1]]];\n                }\n              }\n              \n            }\n\n\n          }\n        } else if(insertText[1][0]){\n          newContents.push(insertText);\n          insertText = [\"\", []];\n        }\n      } else if(count === endPoint || i === 0) {\n        if(!equalsArray(insertText[1], text[1]? text[1] : [])) { \n          if(insertText[0]) newContents.push(insertText);\n          insertText = text[1]? [\"\", [...text[1]]] : [\"\", []]\n        };\n      }\n      insertText[0] += text[0][i];\n      \n      count++;\n\n    }\n  });\n\n  if(insertText[0]) {\n    newContents.push(insertText);\n  }\n\n  return newContents.map(content => content[1][0]? content : [content[0]]);\n}\n\n\n/**\n * Text contents style 변환 함수\n * return BlockData<TextProps>\n * @param changedTextStyleBlock \n * @param styleType \n * @param startPoint \n * @param endPoint \n * @param order \n */\nfunction changeStyleTextContents(\n  changedTextStyleBlock: BlockData<TextProps>, \n  styleType: ContentType,\n  startPoint: number, \n  endPoint: number,\n  order: OrderType\n):BlockData<TextProps> {\n  \n  let changedTextContents: TextContents[];\n\n  switch(order) {\n    case \"add\":\n      changedTextContents = addContentsStyle(\n        changedTextStyleBlock.property.contents,\n        startPoint,\n        endPoint,\n        styleType\n      );\n      break;\n\n    case \"del\":\n      changedTextContents = deleteContentsStyle(\n        changedTextStyleBlock.property.contents,\n        startPoint,\n        endPoint,\n        styleType\n      );\n      break;\n\n    case \"color\":\n      changedTextContents = addContentsStyle(\n        deleteContentsStyle(\n          changedTextStyleBlock.property.contents,\n          startPoint,\n          endPoint,\n          styleType\n        ),\n        startPoint,\n        endPoint,\n        styleType\n      );\n      break;\n\n    case \"link\":\n      changedTextContents = addContentsStyle(\n        deleteContentsStyle(\n          changedTextStyleBlock.property.contents,\n          startPoint,\n          endPoint,\n          styleType\n        ),\n        startPoint,\n        endPoint,\n        styleType\n      );\n      break;\n\n    default: \n      changedTextContents = changedTextStyleBlock.property.contents;\n  }\n\n  return Object.assign({}, \n    changedTextStyleBlock, {\n      property: Object.assign({}, \n        changedTextStyleBlock.property, {\n          contents: changedTextContents\n      })\n    }\n  );\n}\n\nconst converter = {\n  parseHtmlContents,\n  addContentsStyle,\n  deleteContentsStyle,\n  changeStyleTextContents\n}\n\nexport default converter;","import { RawBlockData, BlockData, UUID } from '../../../../types/bklog';\n\n\ntype Blocks = RawBlockData<any>[] | BlockData<any>[];\n\n/**\n * 첫번째 block 찾기\n */\nconst isFirstBlockPoint = (block: RawBlockData<any> | BlockData<any>) => \n  !block.preBlockId && !block.parentBlockId;\n\n/**\n * 다음 block 찾기\n * @param id \n */\nconst isNextBlockPoint = (id:string) => \n  (block: RawBlockData<any> | BlockData<any>) => \n  block.id === id;\n\n/**\n * block ordering\n * @param block \n */\nexport default function orderingBlock(blocks: Blocks): BlockData<any>[] {\n  const DELETE_COUNT = 1;\n  const BLOCK_LENGTH = blocks.length;\n  const rawBlocks: Blocks = blocks.concat();\n  const newBlocks: BlockData<any>[] = [];\n  \n  let newBlock: BlockData<any> | RawBlockData<any>;\n  let currentPosition: number = 0;\n  let blockIndex: number = 1;\n  let nextBlockId: UUID | null = null;\n  let idStack:UUID[] = [];\n  \n  while(rawBlocks[0] && newBlocks.length < BLOCK_LENGTH) {\n    let currentId:UUID | undefined | null;\n\n    if(nextBlockId) {\n      currentId = nextBlockId;\n    } else if(idStack.length >= 1) {\n      currentId = idStack.pop();\n    }\n\n    if(currentId) {\n      currentPosition = rawBlocks.findIndex(isNextBlockPoint(currentId));\n    } else {\n      currentPosition = rawBlocks.findIndex(isFirstBlockPoint);\n    }\n\n    if(currentPosition === -1) {\n      console.log(\"currentId 누락\", currentId, newBlocks)\n      return newBlocks\n    }\n\n    newBlock = rawBlocks[currentPosition];\n\n    if(newBlock.children[0] !== undefined) {\n      nextBlockId = newBlock.children[0];\n        if(newBlock.nextBlockId) idStack.push(newBlock.nextBlockId)\n    } else {\n      nextBlockId = newBlock.nextBlockId;\n    }\n\n    newBlocks.push(Object.assign({}, newBlock, {\n      index: blockIndex++\n    }));\n  \n    rawBlocks.splice(currentPosition, DELETE_COUNT);\n  }\n  \n  return newBlocks;\n}","import { v4 as uuidv4 } from 'uuid';\nimport { BlockData, UUID, RawBlockData } from '../../../../types/bklog';\nimport { StagedBlock, parseHtmlContents } from './index';\n\ninterface ChangedData {\n  id: UUID;\n  data: any;\n}\n\ntype Block = BlockData<any> | RawBlockData<any>\n\n/**\n * blockData 생성 함수\n * return blockData<any>\n * @param type \n * @param blockType \n */\nfunction createBlockData(\n  type: string = \"text\", \n  blockType: string = \"bk-p\", \n  preBlockId: UUID | null, \n  nextBlockId?: UUID | null | undefined\n):BlockData<any> {\n  return {\n    index: 0,\n    id: uuidv4(),\n    type: type,\n    parentBlockId: null,\n    preBlockId: preBlockId,\n    nextBlockId: nextBlockId? nextBlockId : null,\n    property: {\n      type: blockType,\n      styles: {\n        color: null,\n        backgroundColor: null\n      },\n      contents: []\n    },\n    children: []\n  }\n}\n\n/**\n * blockData 복사\n * return BlockData<any>\n * @param blockData \n */\nfunction copyBlockData(blockData: BlockData<any>): BlockData<any> {\n  return Object.assign({}, blockData, {\n    id: uuidv4(),\n    parentBlockId: null,\n    preBlockId: null,\n    nextBlockId: null,\n    children: []\n  })\n}\n\nfunction copyBlock(\n  preBlock: BlockData<any> | RawBlockData<any>, \n  preBlockId: UUID | null, \n  parentBlockId?: UUID\n): BlockData<any> {\n  return Object.assign({}, preBlock, {\n    index: 0,\n    id: uuidv4(),\n    preBlockId,\n    parentBlockId: parentBlockId? parentBlockId : null\n  });\n}\n\n/**\n * blockList를 복사하는 함수.\n * @param blockDataList \n */\nfunction copyBlockDataList(\n  blockDataList: Block[]\n): Block[] {\n  let newBlockDataList: Block[] = []; \n  let newPreBlockData: [UUID, number][] = [];\n  let newParentBlockData: [UUID, number][] = [];\n\n  for(let i = 0; i < blockDataList.length; i++) {\n    const newBlock: Block = Object.assign({}, blockDataList[i], {\n      id: uuidv4(),\n      preBlockId: null,\n      nextBlockId: null,\n      parentBlockId: null,\n      children: []\n    });\n\n    if(blockDataList[i].parentBlockId) {\n      const parentData = newParentBlockData[newParentBlockData.length - 1];\n      newBlock.parentBlockId = parentData[0];\n      const children = newBlockDataList[parentData[1]].children;\n      newBlockDataList[parentData[1]].children = insertChild(children,\n        children.length, \n        [newBlock.id]);\n    }\n    \n    if(blockDataList[i].children[0]) {\n      newParentBlockData.push([newBlock.id, i]);\n    }\n\n    if(blockDataList[i].preBlockId && newPreBlockData[0]) {\n      const preBlockData = newPreBlockData.pop();\n      if(preBlockData) {\n        newBlock.preBlockId = preBlockData[0];\n        newBlockDataList[preBlockData[1]].nextBlockId = newBlock.id;\n      }\n    }\n\n    const preNextBlockId = blockDataList[i].nextBlockId;\n    if(preNextBlockId) {\n      if(blockDataList.findIndex(isBlockId(preNextBlockId)) === -1) {\n        newBlock.nextBlockId = null;\n      } else {\n        newPreBlockData.push([newBlock.id, i]);\n      }\n    } else {\n      newParentBlockData.pop();\n    };\n\n    newBlockDataList.push(newBlock);\n  }\n\n  return newBlockDataList;\n}\n\n/**\n * block child 삽입 함수\n * return UUID[]\n * @param children \n * @param insertPoint \n * @param insertChildren \n * @param deleteCount \n */\nfunction insertChild(\n  children: UUID[], \n  insertPoint: number, \n  insertChildren: UUID[], \n  deleteCount: number = 0\n):UUID[] {\n  let newChildren = [...children];\n\n  if(insertChildren[0]) {\n    \n    if(children.length < 1 || children.length === insertPoint) {\n      if(deleteCount && children.length >= 1) {\n        newChildren.pop();\n      }\n      newChildren = newChildren.concat(insertChildren);\n    } else {\n      newChildren.splice(insertPoint, deleteCount, ...insertChildren);\n    }\n\n  } else {\n    newChildren.splice(insertPoint, deleteCount);\n  }\n  return newChildren\n} \n\n/**\n * block id filter 함수\n * @param id \n */\nconst isBlockId = (id: UUID | null) => \n  (block: BlockData | RawBlockData) => \n  block.id === id;\n\n/**\n * blockList를 삽입하는 함수\n * @param preBlocks \n * @param blockDataList \n * @param preBlockId \n */\nfunction insertBlock(\n  preBlocks:Block[],\n  blockDataList: Block[],\n  preBlockId: UUID | null,\n  parentId?: UUID\n): Block[] {\n  let newBlocks: Block[] = preBlocks.map(block => Object.assign({}, block));\n  const newBlockDataList = [...blockDataList];\n  const firstPosition: number = 0;\n\n  let currentBlockId: UUID | null = newBlockDataList[firstPosition].id;\n  let newChildrenList: UUID[] = [];\n\n  const preBlockPosition: number = preBlockId? \n    newBlocks.findIndex(isBlockId(preBlockId)) : -1;\n  const preBlock: Block | null = preBlockId? \n    newBlocks[preBlockPosition] : null;\n  \n  const nextBlockPosition: number = preBlock && preBlock.nextBlockId?\n    newBlocks.findIndex(isBlockId(preBlock.nextBlockId)) : -1;\n  const nextBlock: Block | null = nextBlockPosition !== -1? \n    newBlocks[nextBlockPosition] : null;\n  \n  let parentBlockId: UUID | null = parentId\n    ? parentId \n    : (preBlock && preBlock.parentBlockId? preBlock.parentBlockId : null)\n\n  while(currentBlockId) {\n    const currentBlockPosition: number = newBlockDataList.findIndex(isBlockId(currentBlockId));\n    const currentBlock: Block = newBlockDataList[currentBlockPosition];\n\n    if(currentBlockPosition === firstPosition) {\n      \n      if(preBlock) {\n        newBlockDataList[firstPosition].preBlockId = preBlock.id;\n        newBlocks[preBlockPosition].nextBlockId = currentBlockId;\n      } else {\n        newBlockDataList[firstPosition].preBlockId = null;\n      }\n    }\n  \n    if(parentBlockId) {\n      newBlockDataList[currentBlockPosition].parentBlockId = parentBlockId;\n      newChildrenList.push(currentBlockId);\n    }\n\n    if(!currentBlock.nextBlockId) {\n      if(nextBlock) {\n        newBlockDataList[currentBlockPosition].nextBlockId = nextBlock.id;\n        newBlocks[nextBlockPosition].preBlockId = currentBlockId;\n      }\n      currentBlockId = null;\n    } else {\n      currentBlockId = currentBlock.nextBlockId;\n    }\n\n  }\n\n  if(parentBlockId) {\n    const parentBlockPosition: number = newBlocks.findIndex(isBlockId(parentBlockId));\n    const parentBlock: Block = newBlocks[parentBlockPosition];\n    const insertPosion: number  = preBlockId? \n      parentBlock.children.indexOf(preBlockId) + 1 : 0;\n    const nextBlockPosition: number = !preBlockId? \n      newBlocks.findIndex(isBlockId(parentBlock.children[0])) : -1;\n\n    if(nextBlockPosition !== -1) {\n      const newBlockLastChild: UUID = newChildrenList[newChildrenList.length - 1];\n      const newBlocklastChildPosition: number = newBlockDataList.findIndex(isBlockId(newBlockLastChild));\n      newBlocks[nextBlockPosition].preBlockId = newBlockLastChild;\n      newBlockDataList[newBlocklastChildPosition].nextBlockId = newBlocks[nextBlockPosition].id;\n    }\n\n    newBlocks[parentBlockPosition].children = insertChild(\n      parentBlock.children, \n      insertPosion,\n      newChildrenList  \n    );\n  }\n\n  newBlocks = newBlocks.concat(newBlockDataList);\n\n  return newBlocks;\n}\n\n/**\n * \n * @param blockDatas \n * @param stagedBlock \n */\nfunction updateContents(\n  blockData:BlockData<any>[], \n  stageData: StagedBlock[]\n):BlockData<any>[] {\n\n  let newBlocks = blockData.map(block => Object.assign({}, block));\n\n  stageData.forEach((block)=>{\n\n    if(newBlocks[block.blockIndex - 1] && block.id === newBlocks[block.blockIndex - 1].id) {\n      \n      if(newBlocks[block.blockIndex - 1].type === \"text\" || newBlocks[block.blockIndex - 1].type === \"title\") {\n        newBlocks[block.blockIndex - 1].property = Object.assign({}, \n          newBlocks[block.blockIndex - 1].property, {\n            contents: typeof block.contents === \"string\"? \n                      parseHtmlContents(block.contents) : block.contents\n        });\n      }\n      \n    } else {\n      console.log(\"block이 제대로 정렬되지 않았습니다.\");\n    }\n\n  });\n  \n  return newBlocks;\n}\n\nconst isNotBlockId = (id: UUID) => \n  (block:BlockData<any>) => block.id !== id;\n/**\n * block 제외 함수\n * @param blocks \n * @param id \n */\nfunction excludeBlock(blocks: BlockData<any>[], id: UUID): BlockData<any>[] {\n  const deletedId = id;\n  const deletedBlock = blocks.filter(isBlockId(deletedId))[0];\n  const preBlockId = deletedBlock.preBlockId;\n  const nextBlockId = deletedBlock.nextBlockId;\n  const parentBlockId = deletedBlock.parentBlockId;\n\n  if(deletedBlock.type === \"title\") {\n    console.log(\"title은 삭제할 수 없습니다.\")\n    return blocks\n  } \n\n  let deletedBlocks = blocks.filter(isNotBlockId(deletedId));\n\n  let newPreBlockId = preBlockId;\n  let newNextBlockId = nextBlockId;\n\n\n  if(deletedBlock.children[0]) {\n    let childPositionList:number[] = [];\n    deletedBlock.children.forEach(child => {\n      childPositionList.push(deletedBlocks.findIndex(isBlockId(child)));\n    })\n    const firstChild = childPositionList[0];\n    const lastChild = childPositionList[childPositionList.length -1];\n    if(preBlockId) {\n      deletedBlocks[firstChild].preBlockId = preBlockId;\n      newNextBlockId = deletedBlocks[firstChild].id;\n    }\n      \n    if(nextBlockId) {\n      deletedBlocks[lastChild].nextBlockId = nextBlockId;\n      newPreBlockId = deletedBlocks[lastChild].id;\n    }\n    \n    childPositionList.forEach((child)=>{\n      deletedBlocks[child].parentBlockId = parentBlockId;\n    });\n  } \n\n  if(parentBlockId) {\n    const parentBlockPosition = deletedBlocks.findIndex(isBlockId(parentBlockId));\n    const parentBlock = deletedBlocks[parentBlockPosition];\n    const deletePosition = parentBlock.children.indexOf(deletedId);\n\n    deletedBlocks[parentBlockPosition] = Object.assign({}, parentBlock, {\n      children: deletedBlock.children[0] ?\n      insertChild(parentBlock.children, deletePosition, deletedBlock.children, 1)\n      : parentBlock.children.filter((child) => child !== deletedId)\n    })\n  }\n\n  if(preBlockId) {\n    const preBlockPosition = deletedBlocks.findIndex(isBlockId(preBlockId));\n    deletedBlocks[preBlockPosition].nextBlockId = newNextBlockId;\n  }\n\n  if(nextBlockId) {\n    const nextBlockPosition = deletedBlocks.findIndex(isBlockId(nextBlockId));\n    deletedBlocks[nextBlockPosition].preBlockId = newPreBlockId;\n  }\n\n  console.log(\"deletedBlocks\",deletedBlocks, deletedId, deletedBlock, blocks);\n  return deletedBlocks;\n}\n\n/**\n * \n * @param blocks \n * @param blockIdList 지워질 blockList들은 서로 연결이 되어 있어야 함.\n */\nfunction excludeBlockList(blocks: BlockData<any>[], blockIdList: UUID[]) {\n\n  let deletedBlocks: BlockData<any>[] = blocks.map((block) => Object.assign({}, block));\n  let currentBlockId: UUID | null = blockIdList[0];\n\n  let preBlockData: [UUID, number] | null = null;\n  let nextBlockData: [UUID, number] | null = null;\n\n  while(currentBlockId) {\n    const currentBlock: BlockData<any> = blocks.filter(isBlockId(currentBlockId))[0];\n\n    let preBlockId = currentBlock.preBlockId;\n    let nextBlockId = currentBlock.nextBlockId;\n    let parentBlockId = currentBlock.parentBlockId;\n\n    if((!preBlockId && !parentBlockId) || currentBlock.type === \"title\") {\n      console.log(\"title은 삭제할 수 없습니다.\")\n      return blocks\n    } \n\n    if(parentBlockId) {\n      const parentPosition = deletedBlocks.findIndex(isBlockId(parentBlockId));\n\n      deletedBlocks[parentPosition].children = deletedBlocks[parentPosition].children.filter((child)=>\n        child !== currentBlock.id\n      );\n    }\n    \n    if(preBlockId) {\n      const findCheck = blockIdList.find((id)=> id === preBlockId);\n      if(!findCheck) {\n        const preBlockPosition = deletedBlocks.findIndex(isBlockId(preBlockId));\n        preBlockData = [preBlockId, preBlockPosition];\n      }\n    }\n\n    if(nextBlockId) {\n      const findCheck = blockIdList.find((id)=> id === nextBlockId);\n      if(!findCheck) {\n        const nextBlockPosition = deletedBlocks.findIndex(isBlockId(nextBlockId));\n        nextBlockData = [nextBlockId, nextBlockPosition];\n\n        currentBlockId = null;\n      } else {\n        currentBlockId = nextBlockId;\n      }\n    } else {\n      currentBlockId = null;\n    }\n\n  }\n\n  if(preBlockData && nextBlockData) {\n    deletedBlocks[preBlockData[1]].nextBlockId = nextBlockData[0];\n    deletedBlocks[nextBlockData[1]].preBlockId = preBlockData[0];\n  } else if(preBlockData) {\n    deletedBlocks[preBlockData[1]].nextBlockId = null;\n  } else if(nextBlockData) {\n    deletedBlocks[nextBlockData[1]].preBlockId = null;\n  } \n\n  for(let i = 0; i < blockIdList.length; i++) {\n    deletedBlocks = deletedBlocks.filter(isNotBlockId(blockIdList[i]));\n  }\n\n  return deletedBlocks;\n}\n\n// 되돌아가기를 했을때 그 전 preBlockId를 기억하고 있으면 될 것 같음.\n// 인자를 좀 더 명확하게 해야겠음.\n\n/**\n * block의 위치를 바꾸는 함수.\n * @param preBlocks \n * @param blockId \n * @param targetBlockId \n * @param type \n */\nfunction switchingBlock(\n  preBlocks:BlockData[],\n  blockId: UUID,\n  targetBlockId: UUID,\n  parentType: boolean = false\n): BlockData[] {\n\n  const currentBlock = preBlocks.filter(isBlockId(blockId))[0];\n  if(!currentBlock) {\n    console.log(\"currentBlock을 찾을 수 없습니다.\");\n    return preBlocks;\n  } \n  if(currentBlock.children[0]) {\n    if(currentBlock.children.indexOf(targetBlockId) !== -1) {\n      console.log(\"targetId가 currentId의 자식 요소입니다.\")\n      return preBlocks;\n    }\n  }\n  const newBlocks = preBlocks.filter(isNotBlockId(blockId));\n\n  let currentPreBlockPosition: number = newBlocks.findIndex(isBlockId(currentBlock.preBlockId));\n  let currentNextBlockPosition: number = newBlocks.findIndex(isBlockId(currentBlock.nextBlockId));\n  let currentParentBlockPosition: number = newBlocks.findIndex(isBlockId(currentBlock.parentBlockId));\n\n  console.log(currentPreBlockPosition, currentNextBlockPosition, currentParentBlockPosition);\n  console.log(newBlocks.map(block => Object.assign({}, block)));\n  \n  if(currentPreBlockPosition !== -1) {\n    newBlocks[currentPreBlockPosition].nextBlockId = currentBlock.nextBlockId;\n  }\n  if(currentNextBlockPosition !== -1) {\n    newBlocks[currentNextBlockPosition].preBlockId = currentBlock.preBlockId;\n  }\n  if(currentParentBlockPosition !== -1) {\n    let currentParentBlock = newBlocks[currentParentBlockPosition];\n    currentParentBlock.children = currentParentBlock.children.filter((child) => child !== currentBlock.id);\n  }\n  console.log(newBlocks.map(block => Object.assign({}, block)));\n\n  currentBlock.preBlockId = null;\n  currentBlock.nextBlockId = null;\n  currentBlock.parentBlockId = null;\n  \n  let targetBlockPosition: number = newBlocks.findIndex(isBlockId(targetBlockId));\n  let preBlock: BlockData | null = !parentType? \n    newBlocks[targetBlockPosition] : null;\n\n  let preBlockParentId: string | null = preBlock? preBlock.parentBlockId : null;\n  let parentBlockPosition: number | null = parentType?\n    newBlocks.findIndex(isBlockId(targetBlockId)) \n    : preBlockParentId? \n    newBlocks.findIndex(isBlockId(preBlockParentId))\n    : null;  \n  let parentBlock: BlockData | null = parentBlockPosition? \n    newBlocks[parentBlockPosition] \n    : null;\n\n  if(preBlock) {\n    let nextBlockId = preBlock.nextBlockId;\n    let nextBlockPosition: number = newBlocks.findIndex(isBlockId(nextBlockId));\n    console.log(\"preblock\",  preBlock);\n    preBlock.nextBlockId = currentBlock.id;\n    currentBlock.preBlockId = preBlock.id;\n    if(nextBlockPosition !== -1) {\n      newBlocks[nextBlockPosition].preBlockId = currentBlock.id;\n      currentBlock.nextBlockId = newBlocks[nextBlockPosition].id;\n    } else {\n      currentBlock.nextBlockId = null;\n    }\n  }\n\n  if(parentBlock) {\n    const insertPosition = preBlock && preBlock.parentBlockId? \n      (parentBlock.children.indexOf(preBlock.id) + 1) : 0;\n\n    // 문제가 될 수 있는 요소\n    let nextBlockId = preBlock && preBlock.nextBlockId? null : parentBlock.children[0];\n    parentBlock.children = insertChild(\n                              parentBlock.children, \n                              insertPosition,\n                              [currentBlock.id]\n                            );            \n                            \n    if(nextBlockId) {\n      let nextBlockPosition: number = newBlocks.findIndex(isBlockId(nextBlockId));\n      newBlocks[nextBlockPosition].preBlockId = currentBlock.id;\n      currentBlock.nextBlockId = nextBlockId;\n    }       \n    if(!insertPosition) {\n      currentBlock.preBlockId = null;\n    }\n  }\n\n  currentBlock.parentBlockId = parentBlock? parentBlock.id : null;\n\n  newBlocks.push(currentBlock);\n  \n  return newBlocks;\n}\n\n/**\n * block 복구\n * @param preBlocks \n * @param blockData \n */\nfunction restoreBlock(\n  preBlocks: BlockData<any>[],\n  blockData: BlockData<any>\n) {\n  \n  const changedData:ChangedData[] = []; \n\n  const currentBlock = Object.assign({}, blockData);\n  changedData.push({\n    id: currentBlock.id,\n    data: [blockData]\n  });\n\n  const newBlocks = preBlocks.map(block => Object.assign({}, block));\n\n  if(currentBlock.preBlockId) {\n    const preBlockPosition = newBlocks.findIndex(isBlockId(currentBlock.preBlockId));\n\n    newBlocks[preBlockPosition].nextBlockId = currentBlock.id;\n    changedData.push({\n      id: newBlocks[preBlockPosition].id,\n      data: [{\n        nextBlockId: newBlocks[preBlockPosition].nextBlockId\n      }]\n    });\n  }\n\n  if(currentBlock.nextBlockId) {\n    const nextBlockPosition = newBlocks.findIndex(isBlockId(currentBlock.nextBlockId));\n\n    newBlocks[nextBlockPosition].preBlockId = currentBlock.id;\n    changedData.push({\n      id: newBlocks[nextBlockPosition].id,\n      data: [{\n        preBlockId: newBlocks[nextBlockPosition].preBlockId\n      }]\n    });\n  }\n  \n  if(currentBlock.parentBlockId) {\n    const parentBlockPosition = newBlocks.findIndex(isBlockId(currentBlock.parentBlockId));\n    let insertPoint: number = 0;\n    if(currentBlock.preBlockId) {\n      insertPoint = newBlocks[parentBlockPosition].children.findIndex(child => \n        child === currentBlock.preBlockId ) + 1;\n    }\n\n    newBlocks[parentBlockPosition].children = insertChild(\n      newBlocks[parentBlockPosition].children,\n      insertPoint,\n      [currentBlock.id]\n    );\n    changedData.push({\n      id: newBlocks[parentBlockPosition].id,\n      data: [{\n        children: newBlocks[parentBlockPosition].children\n      }]\n    });\n  }\n\n  if(currentBlock.children[0]) {\n\n    for(let i = 0; i < currentBlock.children.length; i++) {\n\n      const childId = currentBlock.children[i];\n      const childPosition = newBlocks.findIndex(isBlockId(childId));\n      const childChangedData: any = [];\n\n      if(i === 0) {\n        newBlocks[childPosition].preBlockId = null;\n        childChangedData.push({\n          preBlockId: null\n        });\n      }\n\n      if(i === currentBlock.children.length -1) {\n        newBlocks[childPosition].nextBlockId = null;\n        childChangedData.push({\n          nextBlockId: null\n        });\n      }\n\n      const preParentBlockId = newBlocks[childPosition].parentBlockId;\n      if(preParentBlockId) {\n        const preParentPosition = newBlocks.findIndex(isBlockId(preParentBlockId));\n        newBlocks[preParentPosition].children = newBlocks[preParentPosition].children.filter(child => \n          child !== childId\n        );\n\n        if(childPosition === currentBlock.children.length -1) {\n          changedData.push({\n            id: preParentBlockId,\n            data: [\n              {\n                children: newBlocks[preParentPosition].children\n              }\n            ]\n          }); \n        }\n\n      }\n\n      newBlocks[childPosition].parentBlockId = currentBlock.id;\n      childChangedData.push({\n        parentBlockId: currentBlock.id\n      })\n\n      changedData.push({\n        id: newBlocks[childPosition].id,\n        data: [...childChangedData]\n      });\n\n    }\n    \n  }\n\n  newBlocks.push(currentBlock);\n\n  return {\n    blocks: newBlocks,\n    changedData\n  };\n}\n\nconst blocksUtils = {\n  createBlockData,\n  copyBlockData,\n  copyBlockDataList,\n  insertBlock,\n  insertChild,\n  updateContents,\n  excludeBlock,\n  excludeBlockList,\n  switchingBlock,\n  restoreBlock\n}\n\nexport default blocksUtils;","import { TempData, StagedBlock } from './index';\nimport { BlockData, TextProps } from '../../../../types/bklog';\n\nfunction tempDataPush(\n  tempStore: TempData[], \n  tempData: TempData, \n  limitCount: number = 5\n  ): TempData[] {\n\n  const newTempStore = [...tempStore, tempData];\n  if(limitCount < newTempStore.length) {\n    newTempStore.shift();\n  }\n\n  return newTempStore;\n}\n\nfunction getContentsToBeChanged(\n  blocks: BlockData<any>[], \n  stage: StagedBlock[]\n  ): StagedBlock[] {\n  \n  let changedBlocks:BlockData<TextProps>[] = [];\n  console.log(stage);\n  stage.forEach(data => {\n    console.log(blocks[data.blockIndex - 1]);\n    if(blocks[data.blockIndex - 1].type === \"text\") {\n      changedBlocks.push(blocks[data.blockIndex - 1]);\n    }\n  });\n  \n  console.log(changedBlocks);\n  return changedBlocks.map(block => {\n    return {\n      id: block.id,\n      contents: block.property? block.property.contents : null,\n      blockIndex: block.index\n    }\n  })\n}\n\nconst tempStoreUtils = {\n  tempDataPush,\n  getContentsToBeChanged\n}\n\nexport default tempStoreUtils;","import {\n  BlockData,\n  UUID\n} from '../../../../types/bklog';\nimport converter from './converter';\nimport * as ordering  from './ordering';\nimport blocksUtils from './blocksUtils';\nimport tempStoreUtils from './tempStoreUtils';\n\n/**\n * types\n */\nexport interface EditedBlock {\n  blockId: UUID;\n  blockIndex: number;\n  text: string;\n}\nexport interface StagedBlock{\n  id: UUID;\n  contents: any;\n  blockIndex: number;\n}\nexport interface TempData {\n  type: string;\n  data: any;\n}\nexport interface BklogState {\n  pageId: UUID;\n  userId: string;\n  editingId: string | null;\n  blocks: BlockData<any>[];\n  stage: StagedBlock[];\n  rightToEdit: boolean;\n  tempBack: TempData[];\n  tempFront: TempData[];\n}\nexport type OrderType = \"add\" | \"del\" | \"color\" | \"link\";\n\n/**\n * action Type\n */\nexport const ADD_BLOCK    = 'bklog/ADD_BLOCK' as const;\nexport const EDITABLE     = 'bklog/EDITABLE' as const; \nexport const EDIT_BLOCK   = 'bklog/EDIT_BLOCK' as const; // 임시 데이터로 이동\nexport const COMMIT_BLOCK = 'bklog/COMMIT_BLOCK' as const;\nexport const DELETE_BLOCK = 'bklog/DELETE_BLOCK' as const;\nexport const UPDATE_BLOCK = 'bklog/UPDATE_BLOCK' as const; // DB에 업데이트할 때\nexport const SWITCH_BLOCK = 'bklog/SWITCH_BLOCK' as const;\nexport const REVERT_BLOCK = 'bklog/REVERT_BLOKC' as const;\nexport const CHANGE_TEXT_STYLE = 'bklog/CHANGE_TEXT_STYLE' as const;\n\n/**\n * converter\n */\nexport const parseHtmlContents       = converter.parseHtmlContents;\nexport const addContentsStyle        = converter.addContentsStyle;\nexport const deleteContentsStyle     = converter.deleteContentsStyle;\nexport const changeStyleTextContents = converter.changeStyleTextContents;\n\n/**\n * ordering\n */\nexport const orderingBlock = ordering.default;\n\n/**\n * blocksUtils\n */\nexport const createBlockData   = blocksUtils.createBlockData;\nexport const copyBlockData     = blocksUtils.copyBlockData;\nexport const copyBlockDataList = blocksUtils.copyBlockDataList;\nexport const insertBlock       = blocksUtils.insertBlock;\nexport const insertChild       = blocksUtils.insertChild;\nexport const updateContents    = blocksUtils.updateContents;\nexport const excludeBlock      = blocksUtils.excludeBlock;\nexport const excludeBlockList  = blocksUtils.excludeBlockList;\nexport const switchingBlock    = blocksUtils.switchingBlock;\nexport const restoreBlock      = blocksUtils.restoreBlock;\n\n/**\n * tempStoreUtils\n */\nexport const tempDataPush           = tempStoreUtils.tempDataPush;\nexport const getContentsToBeChanged = tempStoreUtils.getContentsToBeChanged;","import {\n  ContentType,\n  BlockData,\n  UUID\n} from '../../../types/bklog';\n\nimport { \n  ADD_BLOCK,\n  EDITABLE,\n  EDIT_BLOCK,\n  COMMIT_BLOCK,\n  DELETE_BLOCK,\n  UPDATE_BLOCK,\n  SWITCH_BLOCK,\n  REVERT_BLOCK,\n  CHANGE_TEXT_STYLE,\n  EditedBlock,\n  BklogState,\n  OrderType,\n  orderingBlock,\n  createBlockData,\n  copyBlockData,\n  insertBlock,\n  tempDataPush,\n  updateContents,\n  changeStyleTextContents,\n  excludeBlock,\n  excludeBlockList,\n  switchingBlock,\n  restoreBlock,\n  getContentsToBeChanged\n} from './utils';\n\nimport { page } from '../../../data/db.json';\n\nimport { newDataList } from '../../../index.test';\n\n/**\n * BlockLog store\n */\nexport function addBlock(blockId?: UUID, type?: string, block?: BlockData<any>) {\n  return {\n    type: ADD_BLOCK,\n    payload: {\n      preBlockId: blockId,\n      newBlockType: type,\n      blockData: block\n    }\n  }\n}\n\nexport function editAble (id: UUID | null, index?: number) {\n  return {\n    type: EDITABLE,\n    payload: {\n      editingId: id,\n      editingIndex: index\n    }\n  }\n}\n\nexport function editBlock({ \n  blockId,\n  blockIndex,\n  text,\n}: EditedBlock) {\n  return {\n    type: EDIT_BLOCK,\n    payload: {\n      blockId,\n      blockIndex,\n      text\n    }\n  }\n}\n\nexport function commitBlock() {\n  return {\n    type: COMMIT_BLOCK\n  }\n}\n\nexport function deleteBlock(deletedId: UUID) {\n  return {\n    type: DELETE_BLOCK,\n    payload: {\n      deletedId\n    }\n  }\n}\n\nexport function updateBlock(id: UUID) {\n  return {\n    type: UPDATE_BLOCK,\n    payload: {\n      id\n    }\n  }\n}\n\nexport function changeTextStyle(\n  index: number, \n  style: ContentType, \n  startPoint: number,\n  endPoint: number,\n  order: OrderType\n  ) {\n  return {\n    type: CHANGE_TEXT_STYLE,\n    payload: {\n      changedTextStyleBlockIndex: index,\n      styleType: style,\n      startPoint,\n      endPoint,\n      order\n    }\n  }\n}\n\nexport function revertBlock() {\n  return {\n    type: REVERT_BLOCK\n  }\n}\n\nexport function switchBlock(blockId: UUID, targetBlockId: UUID, targetType: boolean) {\n  return {\n    type: SWITCH_BLOCK,\n    payload: {\n      switchedId: blockId,\n      targetBlockId,\n      targetType\n    }\n  }\n}\n\ntype BklogActions = ReturnType<typeof addBlock>\n  | ReturnType<typeof editAble>\n  | ReturnType<typeof editBlock>\n  | ReturnType<typeof commitBlock>\n  | ReturnType<typeof deleteBlock>\n  | ReturnType<typeof updateBlock>\n  | ReturnType<typeof changeTextStyle>\n  | ReturnType<typeof revertBlock>\n  | ReturnType<typeof switchBlock>\n;\n\nconst initialState:BklogState = (() => {\n  return {\n    pageId: page.id,\n    userId: page.userId,\n    blocks: orderingBlock(page.blocks),\n    editingId: null,\n    stage: [],\n    rightToEdit: true,\n    tempBack: [],\n    tempFront: []\n  };\n})();\n\nfunction bklog(state: BklogState = initialState, action: BklogActions):BklogState {\n\n  switch(action.type) {\n\n    case ADD_BLOCK:\n      const { preBlockId, newBlockType, blockData } = action.payload;\n\n      const preBlock = preBlockId? \n        state.blocks.filter(block => block.id === preBlockId)[0] \n        : state.blocks[state.blocks.length - 1];\n\n      const newBlock: BlockData<any> = blockData? \n        copyBlockData(blockData) \n        : createBlockData(\"text\", newBlockType, preBlock.id);\n\n      const addedBlocks = insertBlock(state.blocks, [newBlock], preBlock.id);\n\n      return Object.assign({}, state, {\n        blocks: orderingBlock(addedBlocks),\n        editingId: newBlock.id,\n        tempBack: tempDataPush(state.tempBack,{\n          type: ADD_BLOCK,\n          data: {\n            id: newBlock.id\n          }\n        })\n      }) \n\n    case EDITABLE: \n      const { editingId, editingIndex } = action.payload\n      \n      let editingBlockId: UUID | null;\n      \n      if(editingIndex) {\n        if(editingIndex >= 1 && editingIndex <= state.blocks.length) {\n          editingBlockId = state.blocks[editingIndex - 1].id;\n        } else {\n          editingBlockId = null\n        }\n      } else {\n        editingBlockId = editingId\n      }\n\n      return Object.assign({}, state, {\n        editingId: editingBlockId\n      })\n    \n    case EDIT_BLOCK: \n      const editedId = action.payload.blockId;\n      const text = action.payload.text;\n      const editedBlockIndex = action.payload.blockIndex;\n\n      const preStagedBlock = state.stage.filter(stagedBlock => \n          stagedBlock.id !== editedId\n        );\n\n      const newStagedBlock = {\n        id: editedId,\n        blockIndex: editedBlockIndex,\n        contents: text\n      }\n\n      return Object.assign({}, state, {\n        stage: preStagedBlock? [...preStagedBlock, newStagedBlock] : [newStagedBlock]\n      })\n\n    case CHANGE_TEXT_STYLE:\n      const { \n        changedTextStyleBlockIndex, \n        styleType, \n        startPoint, \n        endPoint,\n        order\n       } = action.payload;\n       \n      const changedTextStyleBlock = state.blocks[changedTextStyleBlockIndex -1];\n      if( changedTextStyleBlock.type !== \"text\" && changedTextStyleBlock.type !== \"title\") {\n        console.log(\"text block이 아닙니다.\")\n        return state;\n      }\n\n      const newTempData = {\n        id: changedTextStyleBlock.id,\n        contents: changedTextStyleBlock.property.contents,\n        blockIndex: changedTextStyleBlock.index\n      }\n      \n      return Object.assign({}, state, {\n        blocks: state.blocks.map((block)=> \n          block.index === changedTextStyleBlockIndex? \n          changeStyleTextContents(\n            changedTextStyleBlock, \n            styleType, \n            startPoint, \n            endPoint,\n            order\n          )\n          : block  \n        ),\n        tempBack: tempDataPush(state.tempBack, {\n          type: CHANGE_TEXT_STYLE,\n          data: [newTempData]\n        })\n      })\n      \n      \n    case COMMIT_BLOCK: \n      if(!state.stage[0]) return state;\n\n      const newTempBack = getContentsToBeChanged(state.blocks, state.stage);\n      \n      const newState = Object.assign({}, state, {\n        blocks: updateContents(state.blocks, state.stage),\n        stage: [],\n        editingId: null,\n        tempBack: tempDataPush(state.tempBack, {\n          type: COMMIT_BLOCK,\n          data: newTempBack\n        })\n      });\n\n      localStorage.setItem(\"bklog\", JSON.stringify(newState));\n\n      return newState;\n\n\n    case DELETE_BLOCK: \n      const { deletedId } = action.payload;\n      \n      if(deletedId === state.blocks[0].id) return state;\n\n      const deletedBlock = state.blocks.filter((block)=>\n        block.id === deletedId\n      )[0];\n\n      return Object.assign({}, state, {\n        blocks: orderingBlock(excludeBlock(state.blocks, deletedId)),\n        tempBack: tempDataPush(state.tempBack, {\n          type: DELETE_BLOCK,\n          data: deletedBlock\n        })\n      });\n    \n    case SWITCH_BLOCK:\n      const { switchedId, targetBlockId, targetType } = action.payload;\n      const switchedBlocks = switchingBlock(state.blocks, switchedId, targetBlockId, targetType);\n      console.log(switchedBlocks);\n\n      return Object.assign({}, state, {\n        blocks: orderingBlock(switchedBlocks)\n      });\n    \n    case REVERT_BLOCK:  \n      const testBlock = state.tempBack.pop();\n      let restoreBlocks;\n\n      if(testBlock && testBlock.data.id) {\n        restoreBlocks = restoreBlock(state.blocks, testBlock.data);\n      } \n\n      return restoreBlocks? Object.assign({}, state, {\n        blocks: orderingBlock(restoreBlocks.blocks)\n      }) : state\n      \n    default: \n\n      return state;\n  }\n\n}\n\nexport default bklog;","import { useCallback, useMemo } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { RootState } from '../store/modules';\nimport {\n  addBlock, \n  editAble,\n  editBlock,\n  commitBlock,\n  deleteBlock,\n  changeTextStyle,\n  switchBlock,\n  revertBlock\n} from '../store/modules/bklog';\nimport { BklogState, OrderType } from '../store/modules/bklog/utils';\nimport {\n  UUID,\n  ContentType,\n  BlockData\n} from '../types/bklog';\n\nfunction useBklog() {\n  \n  const state:BklogState = useSelector((state: RootState) => state.bklog);\n\n\n  // 이거가 메로리가 2중으로드는 거 같음... 아닌가? referance를 가지고 있으니까 상관없나.\n  const initBlock: BlockData<any>[] = useMemo(()=> \n    state.blocks.filter(block => block.parentBlockId === null ), [state.blocks]);\n\n  // 사파리 커밋 문제를 이걸로 해결하려고 함\n  const getEditAbleId = useMemo(() => state.editingId, [state.editingId]);\n\n  const getStagedBlocks = state.stage;\n\n  const getChilrenBlock = (blockId: UUID):BlockData<any>[] => \n    state.blocks.filter(block => block.parentBlockId === blockId); \n\n  const getBlockState = (blockId: UUID): BlockData<any>  => \n    state.blocks.filter(blockState => blockState.id === blockId)[0];\n  \n  const getStagedBlock = (blockId: UUID) =>\n    state.stage.filter(statedBlock => statedBlock.id === blockId)[0];\n\n  const getRightToEdit = useMemo(() => state.rightToEdit,[]);\n  \n  const dispatch = useDispatch();\n\n  // Block 추가\n  const onAddBlock = useCallback((\n      blockId?: UUID, \n      type?: string, \n      blockData?: BlockData<any>\n    ) => dispatch(addBlock(blockId, type, blockData)), [dispatch]);\n\n  // edit중인 block focus\n  const onEditAble = useCallback((blockId: UUID | null, index?:number) =>\n      dispatch(editAble(blockId, index))\n    ,[dispatch]);\n\n\n  // 이거를 각 블럭마다 state값으로 하려고 함.\n  const onEditBlock = useCallback((blockId: UUID, blockIndex: number,content: string) =>\n      dispatch(editBlock({blockId, blockIndex, text: content}))\n    ,[dispatch]);\n\n  const onCommitBlock = useCallback(()=>\n      dispatch(commitBlock())\n    ,[dispatch]);\n\n  const onDeleteBlock = useCallback((blockId: UUID) =>\n      dispatch(deleteBlock(blockId))\n    , [dispatch]);\n\n  const onChangeTextStyle = useCallback((\n    index: number, \n    style: ContentType,\n    startPoint: number,\n    endPoint: number,\n    order: OrderType\n    ) => \n      dispatch(changeTextStyle(index, style, startPoint, endPoint, order))\n    , [dispatch]);\n  \n  const onSwitchBlock = useCallback((blockId: UUID, preBlockId: UUID, parentType: boolean) => \n    dispatch(switchBlock(blockId, preBlockId, parentType)), [dispatch]);\n\n  const onRevertBlock = useCallback(()=> \n      dispatch(revertBlock()), [dispatch]);\n\n  return { \n    state, \n    initBlock,\n    getRightToEdit,\n    getChilrenBlock,\n    getBlockState,\n    getStagedBlocks,\n    getStagedBlock,\n    getEditAbleId, \n    onAddBlock, \n    onEditAble, \n    onEditBlock, \n    onCommitBlock, \n    onDeleteBlock,\n    onChangeTextStyle,\n    onSwitchBlock,\n    onRevertBlock\n  };\n}\n\nexport default useBklog;","import { TextContents, ContentType } from '../../../types/bklog';\nimport { \n  equalsArray, \n} from '../../../store/modules/bklog/utils/converter';\n\nconst BOLD = \"b\" as const;\nconst ITALY = \"i\" as const;\nconst UNDERBAR = \"_\" as const;\nconst FONT_COLOR = \"fc\" as const;\nconst BACKGROUND_COLOR = \"bc\" as const;\nconst ANCHOR = \"a\" as const;\nconst FONT_WEIGHT_BOLD  = \"font-weight: 700;\" as const;\nconst FONT_STYLE_ITALIC = \"font-style: italic;\" as const;\nconst BORDER_BOTTOM     = \"border-bottom: 0.05em solid;\" as const;\nconst COLOR             = \"color:\" as const;\nconst BACKGROUND_C      = \"background-color:\" as const;\n\nexport const arrayUtils = { equalsArray };\n\nexport function contentsElement(rawContents: any) {\n  let text;\n  let className:string | null = null;\n  let styles:string | null = null;\n  let aTag;\n\n  if(rawContents.length === 2) {\n    rawContents[1].forEach((content:string[]) => {\n      switch(content[0]) {\n\n        case BOLD:\n          styles = styles? styles + ` ${FONT_WEIGHT_BOLD}` : FONT_WEIGHT_BOLD;\n          break;\n\n        case ITALY:\n          styles = styles? styles + ` ${FONT_STYLE_ITALIC}` : FONT_STYLE_ITALIC;\n          break;\n\n        case UNDERBAR:\n          styles = styles? styles + ` ${BORDER_BOTTOM}` : BORDER_BOTTOM;\n          break;\n\n        case FONT_COLOR:\n          styles = styles? styles + ` ${COLOR} ${content[1]};` : `${COLOR} ${content[1]};`;\n          break;\n\n        case BACKGROUND_COLOR:\n          styles = styles? styles + ` ${BACKGROUND_C} ${content[1]};` : `${BACKGROUND_C} ${content[1]};`;\n          break;\n          \n        case ANCHOR:\n          aTag = content[1];\n      }\n    })\n    text = `<span${className? ' class=\"'+ className + '\"' : \"\"}${styles? ' style=\"' + styles + '\"' : \"\"}>${rawContents[0]}</span>`\n\n    if(aTag) {\n      let preText = text;\n      text = `<a href=\"${aTag}\">${preText}</a>`;\n    }\n  } else {\n    text = rawContents[0];\n  }\n\n  return text;\n}\n\nexport function createContentsElement(accumulator: string, rawContents: any, currentIndex: number):string {\n  return currentIndex === 1?  contentsElement(accumulator) + contentsElement(rawContents) : accumulator + contentsElement(rawContents);\n}\n\nexport function findTextStyle(\n  textContents: TextContents[], \n  position: number\n  ): ContentType[] | null | undefined {\n\n  let count: number = 0;\n  let style: ContentType[] | null | undefined = null;\n\n  for(let i = 0; i < textContents.length; i++) {\n    count += textContents[i][0].length;\n\n    if(count > position) {\n      style = textContents[i].length === 2? textContents[i][1] : null;\n      break;\n    } \n\n  }\n\n  return style;\n}\n\nexport function arrayFindIndex(array: any[], factor: any): number {\n  const JSONFactor = JSON.stringify(factor);\n\n  for(let i = 0; i < array.length; i++) {\n    const JSONArray = JSON.stringify(array[i]);\n    if(JSONArray === JSONFactor) {\n      return i;\n    }\n  }\n  return -1;\n}","// Usage:\n// let x = document.querySelector('[contenteditable]');\n// let caretPosition = getSelectionDirection(x) !== 'forward' ? getSelectionStart(x) : getSelectionEnd(x);\n// setSelectionRange(x, caretPosition + 1, caretPosition + 1);\n// let value = getValue(x);\n\n// it will not work with \"<img /><img />\" and, perhaps, in many other cases.\n\nexport function isAfter(container:any, offset:any, node:any):any {\n  let c = node;\n  while (c.parentNode !== container) {\n    c = c.parentNode;\n  }\n  let i = offset;\n  while (c !== null && i > 0) {\n    c = c.previousSibling;\n    i -= 1;\n  }\n  return i > 0;\n}\n\nexport function compareCaretPositons(node1: any, offset1: any, node2: any, offset2: any): any {\n  if (node1 === node2) {\n    return offset1 - offset2;\n  }\n  let c = node1.compareDocumentPosition(node2);\n  if ((c & Node.DOCUMENT_POSITION_CONTAINED_BY) !== 0) {\n    return isAfter(node1, offset1, node2) ? +1 : -1;\n  } else if ((c & Node.DOCUMENT_POSITION_CONTAINS) !== 0) {\n    return isAfter(node2, offset2, node1) ? -1 : +1;\n  } else if ((c & Node.DOCUMENT_POSITION_FOLLOWING) !== 0) {\n    return -1;\n  } else if ((c & Node.DOCUMENT_POSITION_PRECEDING) !== 0) {\n    return +1;\n  }\n}\n\nexport function stringifyElementStart(node: any, isLineStart: any): any {\n  if (node.tagName.toLowerCase() === 'br') {\n    if (true) {\n      return '\\n';\n    }\n  }\n  if (node.tagName.toLowerCase() === 'div') { // Is a block-level element?\n    if (!isLineStart) { //TODO: Is not at start of a line?\n      return '\\n';\n    }\n  }\n  return '';\n}\n\nexport function* positions(node:any, isLineStart = true):any {\n  // console.assert(node.nodeType === Node.ELEMENT_NODE);\n  let child = node.firstChild;\n  let offset = 0;\n  yield {node: node, offset: offset, text: stringifyElementStart(node, isLineStart)};\n  while (child != null) {\n    if (child.nodeType === Node.TEXT_NODE) {\n      yield {node: child, offset: 0/0, text: child.data};\n      isLineStart = false;\n    } else {\n      isLineStart = yield* positions(child, isLineStart);\n    }\n    child = child.nextSibling;\n    offset += 1;\n    yield {node: node, offset: offset, text: ''};\n  }\n  return isLineStart;\n}\n\nexport function getCaretPosition(contenteditable: any, textPosition: any): any {\n  let textOffset = 0;\n  let lastNode = null;\n  let lastOffset = 0;\n  for (let p of positions(contenteditable)) {\n    if (p.text.length > textPosition - textOffset) {\n      return {node: p.node, offset: p.node.nodeType === Node.TEXT_NODE ? textPosition - textOffset : p.offset};\n    }\n    textOffset += p.text.length;\n    lastNode = p.node;\n    lastOffset = p.node.nodeType === Node.TEXT_NODE ? p.text.length : p.offset;\n  }\n  return {node: lastNode, offset: lastOffset};\n}\n\nexport function getTextOffset(contenteditable: any, selectionNode: any, selectionOffset: any): any {\n  let textOffset = 0;\n  for (let p of positions(contenteditable)) {\n    // console.log(selectionNode, selectionNode.nodeType)\n    if(!selectionNode || !selectionNode.nodeType) {\n      return textOffset += p.text.length;\n    }\n    if (selectionNode.nodeType !== Node.TEXT_NODE && selectionNode === p.node && selectionOffset === p.offset) {\n      return textOffset;\n    }\n    if (selectionNode.nodeType === Node.TEXT_NODE && selectionNode === p.node) {\n      return textOffset + selectionOffset;\n    }\n    textOffset += p.text.length;\n  }\n  return compareCaretPositons(selectionNode, selectionOffset, contenteditable, 0) < 0 ? 0 : textOffset;\n}\n\nexport function getValue(contenteditable: any): any{\n  let value = '';\n  for (let p of positions(contenteditable)) {\n    value += p.text;\n  }\n  return value;\n}\n\nexport function setSelectionRange(contenteditable: any, start: any, end: any): any {\n  let selection:any = window.getSelection();\n  let s = getCaretPosition(contenteditable, start);\n  let e = getCaretPosition(contenteditable, end);\n  selection.setBaseAndExtent(s.node, s.offset, e.node, e.offset);\n}\n\n//TODO: Ctrl+A - rangeCount is 2\nexport function getSelectionDirection(contenteditable: any): any {\n  let selection:any = window.getSelection();\n  let c = compareCaretPositons(selection.anchorNode, selection.anchorOffset, selection.focusNode, selection.focusOffset);\n  return c < 0 ? 'forward' : 'none';\n}\n\nexport function getSelectionStart(contenteditable: any): any {\n  let selection: any = window.getSelection();\n  let c = compareCaretPositons(selection.anchorNode, selection.anchorOffset, selection.focusNode, selection.focusOffset);\n  return c < 0 ? getTextOffset(contenteditable, selection.anchorNode, selection.anchorOffset) : getTextOffset(contenteditable, selection.focusNode, selection.focusOffset);\n}\n\nexport function getSelectionEnd(contenteditable: any): any {\n  let selection: any = window.getSelection();\n  let c = compareCaretPositons(selection.anchorNode, selection.anchorOffset, selection.focusNode, selection.focusOffset);\n  return c < 0 ? getTextOffset(contenteditable, selection.focusNode, selection.focusOffset) : getTextOffset(contenteditable, selection.anchorNode, selection.anchorOffset);\n}","import React, { useMemo } from 'react';\nimport { placeholder } from '@babel/types';\n\ninterface ContentEditableEle {\n  className: string;\n  onKeyPress?: any;\n  onKeyUp?: any;\n  onClick?: any;\n  onMouseUp?: any;\n  onMouseDown?: any;\n  onMouseMove?: any;\n  onFocus?:any;\n  onBlur?:any;\n  placeholder?: string;\n  dangerouslySetInnerHTML?: {\n    __html: any\n  }\n  contents?: string;\n}\n\nconst ContentEditableEle = React.forwardRef<HTMLDivElement, ContentEditableEle>(({\n  className,\n  onKeyPress, \n  onKeyUp,\n  onClick,\n  onMouseUp,\n  onMouseDown,\n  onMouseMove,\n  onFocus,\n  onBlur,\n  dangerouslySetInnerHTML,\n  contents,\n  placeholder\n}, ref) => {\n  \n  return (\n    <div \n      className={`bk-contentEditable ${className? className : \"\"}`}\n      ref={ref}\n      onKeyUp={onKeyUp}\n      onKeyPress={onKeyPress}\n      onClick={onClick}\n      onMouseUp={onMouseUp}\n      onMouseDown={onMouseDown}\n      onMouseMove={onMouseMove}\n      onFocus={onFocus}\n      onBlur={onBlur}\n      contentEditable={true}\n      dangerouslySetInnerHTML={dangerouslySetInnerHTML}\n      placeholder={placeholder} \n    >\n      { contents }\n    </div>\n  )\n})\n\nexport default ContentEditableEle;","import React from 'react';\n\ninterface ColorStyleToggleButtonProps {\n  colorCode: number[];\n  onStyleChange: any;\n  addDelToggle: any;\n}\n\n\nfunction ColorStyleToggleButton({\n  colorCode,\n  onStyleChange,\n  addDelToggle\n}: ColorStyleToggleButtonProps) {\n  // 붙혀야 commit 해당 색을 찾을 수 있음.\n  const RGBA = `rgba(${colorCode[0]},${colorCode[1]},${colorCode[2]},${colorCode[3]})`\n\n  const btnStyle = {\n    color: RGBA\n  }\n\n  const addDel = addDelToggle([\"fc\", RGBA])? \"del\" : \"color\";\n\n  const handleClick = ()=> {\n    onStyleChange([\"fc\",RGBA], addDel);\n  }\n\n  return (\n    <button style={btnStyle} onClick={handleClick}>\n      Text\n      { addDel === \"del\"? \"v\" : null}\n    </button>\n  )\n}\n\nconst colorCodes:number[][] = [\n  [191, 63, 63, 1],\n  [191, 127, 63, 1],\n  [191, 191, 63, 1],\n  [127, 191, 63, 1],\n  [63, 191, 63, 1],\n  [63, 191, 127, 1],\n  [63, 127, 191, 1],\n  [63, 63, 191, 1],\n  [127, 63, 191, 1],\n  [191, 63, 191, 1],\n  [191, 63, 127, 1]\n];\n\ninterface ColorStyleToggleProps {\n  addDelToggle: any;\n  onStyleChange: any;\n}\n\nfunction ColorStyleToggle(\n  { addDelToggle, onStyleChange }: ColorStyleToggleProps\n  ) {\n\n  return (\n    <div className=\"bk-color-menu\">\n      {\n        colorCodes.map((code, key) => \n          <ColorStyleToggleButton \n            key={key}\n            colorCode={code}\n            onStyleChange={onStyleChange}\n            addDelToggle={addDelToggle}\n          />\n        )\n      }\n    </div>\n  )\n}\n\nexport default ColorStyleToggle;","import React, { useMemo, useEffect, useState } from 'react';\nimport useBKlog from '../../../hooks/useBKlog';\nimport { \n  BlockData, \n  ContentType\n} from '../../../types/bklog';\nimport { \n  findTextStyle,\n  arrayFindIndex\n} from '../utils';\n\nimport ColorStyleToggle  from './ColorStyleToggle';\n\nconst textBlockType = [\n  \"h1\",\n  \"h2\",\n  \"h3\",\n  \"h4\",\n  \"p\"\n];\n\nfunction TextBlockTypeSelection() {\n  return (\n    <select>\n      { textBlockType.map(((type, idx) => <option key={idx}>{ type }</option>)) }\n    </select>\n  )\n}\n\ninterface TextStyleToggleButtonProps {\n  onStyleChange: any;\n  addDelToggle: boolean;\n  styleType: string;\n}\n\nfunction TextStyleToggleButton({\n  onStyleChange,\n  addDelToggle,\n  styleType\n}: TextStyleToggleButtonProps) {\n\n  const addDelClassName = addDelToggle? \"del\" : \"add\";\n\n  const handleClick = () => {\n    onStyleChange([styleType], addDelClassName)\n  }\n\n  return (\n    <button \n      className={`bk-textStyleToggle ${addDelClassName}`}\n      onClick={handleClick}\n    >\n      { styleType }\n    </button>\n  )\n}\n\ninterface TextStyleTogglesProps {\n  blockIndex: number;\n  startPosition: number;\n  endPosition: number;\n  contents: any;\n  reBlockFocus: any;\n}\n\nfunction TextStyleToggles({\n  blockIndex, \n  startPosition,\n  endPosition,\n  contents,\n  reBlockFocus\n}: TextStyleTogglesProps) {\n  const [ currentStyle, setStyle ] = useState(findTextStyle(contents, startPosition));\n  const { onChangeTextStyle, onCommitBlock } = useBKlog();\n\n  const toggleProps:string[] = [\"b\", \"i\", \"_\"];\n\n  const onStyleChange = (styleType: ContentType, toggle: any) => {\n    onCommitBlock();\n    onChangeTextStyle(\n      blockIndex, \n      styleType,\n      startPosition, \n      endPosition,\n      toggle\n    )\n    reBlockFocus();\n  }\n\n  const testUnder = () => {\n    onChangeTextStyle(\n      blockIndex, \n      [\"fc\", \"rgba(0, 244, 255, 1)\"],\n      startPosition, \n      endPosition,\n      \"del\"\n    );\n    reBlockFocus();\n  }\n\n  const addDelToggle = (prop:any):boolean => {\n    return arrayFindIndex(\n      currentStyle? \n      currentStyle : [], \n      prop\n      ) !== -1? true : false;\n  }\n\n  useEffect(()=> {\n    setStyle(findTextStyle(contents, startPosition));\n  }, [contents, startPosition]);\n\n  return (\n    <div \n      style={{left: `${startPosition * 16}px`}}\n      className=\"bk-style-toggles absolute bg-white -top-full border\"\n    >\n      <TextBlockTypeSelection \n      />\n      {\n        toggleProps.map((prop, idx)=> \n          <TextStyleToggleButton \n            key={idx}\n            onStyleChange={onStyleChange}\n            styleType={prop}\n            addDelToggle={addDelToggle([prop])}\n          />\n        )\n      }\n      <ColorStyleToggle\n        addDelToggle={addDelToggle}\n        onStyleChange={onStyleChange}\n      />\n    </div>\n  )\n}\n\nexport default TextStyleToggles;","import React, { useEffect, useRef, useState, useMemo } from 'react';\n\nimport useBKlog from '../../../hooks/useBKlog';\nimport { \n  BlockData\n} from '../../../types/bklog';\nimport { \n  contentsElement,\n  createContentsElement\n} from '../utils';\nimport { \n  getSelectionStart,\n  getSelectionEnd,\n  setSelectionRange\n} from '../utils/selectionText';\n\nimport ContentEditableEle from './ContentEditableEle';\nimport TextStyleToggle from './TextStyleToggle';\n\nimport './block.scss';\n\ninterface BlockProps {\n  blockData: BlockData<any>;\n}\n\nfunction Block({ blockData }:BlockProps) {\n\n  const [ editing, setEditing ] = useState<boolean>(true);\n  const [ cursorStart, setCursorStart ] = useState<number>(0);\n  const [ cursorEnd, setCursorEnd ] = useState<number>(0);\n\n  const [ styleToggle, setStyleToggle ] = useState<boolean>(false);\n\n  const blockRef = useRef<HTMLDivElement>(null);\n\n  const { \n    getRightToEdit,\n    getEditAbleId,\n    onAddBlock, \n    onDeleteBlock,\n    getChilrenBlock,\n    onEditAble,\n    onEditBlock,\n    onCommitBlock\n  } = useBKlog();\n\n  const createMarkup = useMemo(()=> {\n    const htmlElement = blockData.property && blockData.property.contents[0]?\n    (blockData.property.contents.length === 1? \n      contentsElement(blockData.property.contents[0])\n      : blockData.property.contents.reduce(createContentsElement)\n    ) : \"\";\n\n    return {\n      __html: htmlElement\n    }\n  }, [blockData.property]);\n  \n  // 위치 변경시 어떻게 리프레쉬 될지 고민해야 함.\n  const childrenBlock = blockData.children[0]? \n    getChilrenBlock(blockData.id) : null;\n\n\n  // keyboard methods\n  const handleKeyUp = (e:any) => {  \n    setCursorStart(getSelectionStart(e.target));\n    setCursorEnd(getSelectionEnd(e.target));\n\n    switch(e.key) {\n \n      case \"Enter\":\n        setCursorStart(0);\n        setCursorEnd(0);\n        e.preventDefault();\n        break;\n\n      case \"ArrowUp\": \n      // cursor가 앞으로 튐\n        \n        if(cursorStart === 0) {\n          e.preventDefault();\n          setCursorStart(0);\n          setCursorEnd(0);\n          onEditAble(null, blockData.index - 1);\n        }\n        \n        break;\n\n      case \"ArrowDown\":\n\n        if(cursorEnd === e.target.innerText.length) {\n          setCursorStart(0);\n          setCursorEnd(0);\n          e.preventDefault();\n          onEditAble(null, blockData.index + 1);\n        }\n        \n        break;\n\n      case \"Backspace\":\n        if(!e.target.innerHTML && cursorStart === 0 && cursorEnd === 0) {\n          onCommitBlock();\n          onDeleteBlock(blockData.id);\n          if(blockData.index > 1) onEditAble(null, blockData.index-1);\n          break;\n        } else {\n          onEditBlock(blockData.id, blockData.index, e.target.innerHTML);\n          break;\n        }\n      \n      case \" \":\n        setCursorEnd(0);\n        onEditBlock(blockData.id, blockData.index, e.target.innerHTML);\n        onCommitBlock();\n        break;\n      \n      default:\n        onEditBlock(blockData.id, blockData.index, e.target.innerHTML);\n\n    }\n\n  }\n\n  // const moveStartPoint = (ele: any) => {\n  //   setCursorStart(0);\n  //   setCursorEnd(0);\n  //   setSelectionRange(ele, 0, 0);\n  // }\n\n  const moveEndPoint = (ele: any) => {\n    const length = ele.innerText.length;\n    setCursorStart(length);\n    setCursorEnd(length);\n    setSelectionRange(ele, length, length);\n  }\n\n  const refreshPoint = (\n    ele:any, \n    cursorStart: number, \n    cursorEnd?: number | null\n    ) => {\n    setSelectionRange(ele, cursorStart, cursorEnd? cursorEnd : cursorStart);\n  }\n\n  const handleKeyPress = (e:any) => {\n    if(e.key === \"Enter\") {\n      e.preventDefault();\n      onAddBlock(blockData.id, blockData.property? blockData.property.type : null);\n    }\n  }\n\n  const handleClick = (e: any) => {\n    const parentNode = e.target.parentNode;\n\n    if(parentNode.tagName === \"A\") {\n      window.open(parentNode.href);\n    }\n  }\n\n  // mouse methods\n  const handleMouseUp = () => {\n    const getStartPosition = getSelectionStart(blockRef.current);\n    const getEndPosition = getSelectionEnd(blockRef.current);\n    setCursorStart(getStartPosition);\n    setCursorEnd(getEndPosition);\n  }\n\n  // Focus methods\n  const handleBlur = (e:any) => {\n    if (e.currentTarget === e.target) {\n      // console.log('unfocused self 1');\n    } else {\n      // console.log('unfocused child 2', e.target);\n    }\n    if (!e.currentTarget.contains(e.relatedTarget)) {\n      // Not triggered when swapping focus between children\n      setCursorStart(0);\n      setCursorEnd(0);\n      onCommitBlock();\n    }\n  }\n\n  const handleFocus = (ele: any) => {\n    ele.focus();\n  }\n\n  const isFocus = (e: any) => {\n    if(!styleToggle) {\n      moveEndPoint(blockRef.current);\n    } else if((cursorStart | cursorEnd)) {\n      refreshPoint(blockRef.current, cursorStart, cursorEnd);\n    } \n    onEditAble(blockData.id);\n  }\n\n  const reBlockFocus = ()=> {\n    handleFocus(blockRef.current);\n  }\n\n  useEffect(()=> {\n    const focused = document.activeElement;\n    \n    if((cursorStart | cursorEnd) && focused === blockRef.current) {\n      refreshPoint(blockRef.current, cursorStart, cursorEnd);\n    }\n\n  }, [blockData.property])\n\n  useEffect(()=> {\n    if(getEditAbleId === blockData.id) {\n      if(blockRef.current) handleFocus(blockRef.current);\n    }\n  },[getEditAbleId]);\n\n  useEffect(()=> {\n    if(blockData.type === \"container\") {\n      if(!blockData.children[0]) onDeleteBlock(blockData.id);\n    }\n  }, [blockData.children])\n\n  useEffect(()=> {\n    if(cursorEnd - cursorStart >= 1) {\n      setStyleToggle(true);\n    } else {\n      setStyleToggle(false);\n    }\n  }, [cursorStart, cursorEnd]);\n\n  return (\n    <div \n      data-index={blockData.index} \n      className=\"block-zone\"\n    >\n       <div \n        className=\"bk-block relative pr-8\"\n        onBlur={handleBlur}\n       > \n        { \n          blockData.property && blockData.type !== \"container\" ? \n            <ContentEditableEle \n              className={blockData.property.type}\n              dangerouslySetInnerHTML={createMarkup}\n              ref={blockRef}\n              onKeyPress={handleKeyPress}\n              onKeyUp={handleKeyUp}\n              onMouseDown={handleClick}\n              onMouseUp={handleMouseUp}\n              onFocus={isFocus}\n              placeholder=\"입력해주세요...\"\n            />\n          : null\n        }\n        {/* <button \n          className=\"bk-del absolute right-0\" \n          onClick={()=>{onDeleteBlock(blockData.id)}}> \n          삭제 \n        </button> */}\n        {\n          styleToggle? \n          <TextStyleToggle\n            blockIndex={blockData.index}\n            startPosition={cursorStart}\n            endPosition={cursorEnd}\n            contents={blockData.property.contents}\n            reBlockFocus={reBlockFocus}\n          /> : null\n        }\n      </div>\n          {\n            childrenBlock ? \n            childrenBlock.map((child)=> \n              <Block \n                blockData={child}\n                key={child.id}\n              />\n            ) : null\n          }\n    </div>\n  )\n}\n\nexport default Block;\n","import Block from './Block';\n\nexport default Block;","import React from 'react';\nimport { Link } from 'react-router-dom';\n\ninterface EditorBlockProps {\n  penName: string;\n  userPhoto: string | null;\n  bio: string;\n}\n\nconst classes = [\n  \"user-block px-4 pt-4 bg-purple-50\",\n  \"profile-text-block\",\n  \"penName font-semibold text-xl text-gray-600\",\n  \"bi text-sm font-medium text-gray-600\",\n  \"profile-image-block w-full h-18 pt-6\",\n  \"avatar w-24 h-12 m-auto relative\",\n  \"w-24 h-24 absolute hover:cursor-pointer rounded-full overflow-hidden border\",\n  \"w-full h-full\",\n  \"w-full h-full\"\n]\n\nfunction EditorBlock({ penName, bio ,userPhoto }: EditorBlockProps) {\n  return (\n    <div className={classes[0]}>\n      <div className={classes[1]}>\n        <div className={classes[2]}>\n          { penName }\n        </div>\n        <div className={classes[3]}>\n          { bio }\n        </div>\n      </div>\n      <div className={classes[4]}>\n        <div className={classes[5]}>\n          <Link \n            to={`/bklog/${penName}`} \n            className={classes[6]} \n            title={`${penName} page 이동`}\n          >\n            {\n              userPhoto? \n              <img className={classes[7]} src={userPhoto} alt={penName} />\n              : <div className={classes[8]}>{penName[0]}</div>\n            }\n          </Link>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default EditorBlock;","import React, { useState, useEffect } from 'react';\nimport useAuth from '../../../hooks/useAuth';\n\nimport EditorBlock from './EditorBlock';\n\nimport './profile.scss';\nimport usePage from '../../../hooks/usePage';\n\nfunction Profile() {\n\n  const {\n    pageEditor\n  } = usePage();\n\n  return (\n    <div className={`user-profile flex-none w-full whitespace-nowrap border-b mb-12`}>\n      { \n        pageEditor? \n        <>\n          <EditorBlock\n            penName={pageEditor.penName}\n            userPhoto={pageEditor.userPhoto}\n            bio={pageEditor.bio}\n          />\n        </>\n        : <div></div>\n      }\n    </div>\n  )\n}\n\nexport default Profile;","import Profile from './Profile';\n\nexport default Profile;","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faSortDown } from '@fortawesome/free-solid-svg-icons';\nimport usePage from '../../hooks/usePage';\nimport { UserProfile } from '../../store/modules/auth/utils';\nimport { Page } from '../../store/modules/page/utils';\n\ninterface PageListProps {\n  pageEditor: UserProfile;\n  pageList: Page[];\n}\n\nfunction PageList({ pageEditor, pageList }: PageListProps) {\n\n  return (\n    <div className=\"page-list flex-1 overflow-auto pt-1\">\n      <div className=\"pl-4 text-base font-semibold\">\n        Page list\n      </div>\n      <ul className=\"list p-4 font-semibold text-sm text-gray-600\">\n        {\n          pageList? pageList.map((page, idx) =>\n            <li key={idx} className=\"h-auto flex justify-between px-2\">\n              <div className=\"h-8 leading-8 w-5/6 flex-none\">\n                <Link to={`/bklog/${pageEditor.penName}/${page.pageId}`}>\n                  {` ${page.pageTitle}`}\n                </Link>\n              </div>\n               {/**\n                누르면 색이 바뀌게 하면 될거 같음.\n              */}\n              <button className=\"h-8 pb-2 w-8 outline-none click:outline-none text-gray-300 hover:text-gray-600\">\n                <FontAwesomeIcon icon={faSortDown} />\n              </button>\n            </li>  \n          ) : <li></li>\n        }\n        \n      </ul>\n      <ul>\n        <li>\n          \n        </li>\n      </ul>\n    </div>\n  )\n}\n\nexport default PageList;","import React from 'react';\nimport classNames from 'classnames';\nimport Profile from './profile';\nimport PageList from './Page-list';\nimport './sidebar.scss';\nimport usePage from '../../hooks/usePage';\n\nfunction Sidebar() {\n\n  const { pageState } = usePage();\n\n  return (\n    <div className={\n      classNames(\n        \"sidebar h-full flex-none gnb-box overflow-hidden\",\n        {\"off\": !pageState.toggle}\n      )}\n    >\n      <div className=\"h-full py-2 pl-2\">\n        <nav className={` h-full rounded-md shadow-md bg-white overflow-hidden relative flex flex-col`}>\n          <Profile />\n          <PageList\n            pageEditor={pageState.pageEditor}\n            pageList={pageState.pageList}\n          />\n        </nav>\n      </div>\n    </div>\n  )\n}\n\nexport default Sidebar;","import Sibebar from './Sidebar';\n\nexport default Sibebar;","import React, { useEffect, useState } from 'react';\nimport { useIdleTimer } from 'react-idle-timer';\nimport classNames from 'classnames';\nimport useBKlog from '../hooks/useBKlog';\nimport Block from '../components/bklog/block';\n\nimport { BlockData } from '../types/bklog';\n\nimport { TEST_CASE_01 } from '../index.test';\nimport Sibebar from '../components/sidebar';\nimport usePage from '../hooks/usePage';\n\nfunction BklogContainer() { \n  \n  const [count, setCount] = useState(1);\n  \n  const { \n    state, \n    initBlock, \n    onAddBlock, \n    onCommitBlock, \n    onChangeTextStyle,\n    onSwitchBlock,\n    onRevertBlock\n  } = useBKlog();\n\n\n  const click = () => {\n    onAddBlock(undefined, undefined, {\n      index: 0,\n      id: \"d5cc2725-97ec-494b-bc80-c16f96379e61\",\n      type: \"text\",\n      parentBlockId: null,\n      preBlockId: null,\n      nextBlockId: null,\n      property: {\n        type:  \"BKlog-h1\",\n        styles: {\n          color: null,\n          backgroundColor: null\n        },\n        contents: [\n          [\"블록 1입니다.\"],\n          [\"저\", [[\"b\"], [\"fc\", \"#c0f\"], [\"bc\", \"#000\"], [\"i\"],[\"a\", \"https://www.naver.com\"]]],\n          [\"는 \", [[\"i\"]]],\n          [\"황준희\", [[\"b\"]]],\n          [\" 입니다.\", [[\"fc\", \"#f00\"]]]\n        ]\n      },\n      children: [\n        \"2453d55f-66f0-4ad0-b796-0dbcd8d82ce8\"\n      ]\n    });\n  }\n\n  const handleOnIdle = () => {\n    console.log('last active', getLastActiveTime());\n    if(state.stage[0]) {\n      console.log('commit');\n      onCommitBlock();\n    }\n  }\n  const handleClick = () => {\n    onChangeTextStyle (1, [\"bc\", \"#fc0\"], 2, 10, \"color\");\n  }\n\n  const testHandleClick = () => {\n    onSwitchBlock(state.blocks[3].id, state.blocks[7].id, false);\n    setCount(count+1);\n  }\n\n  const revertHandleClick = () => {\n    onRevertBlock();\n  }\n  // const handleOnActive = (event: any) => {\n  //   console.log('user is active', event)\n  //   console.log('time remaining', getRemainingTime())\n  // }\n\n  // const handleOnAction = (e: any) => {\n  //   console.log('user did something', e)\n  // }\n\n  const { getLastActiveTime } = useIdleTimer({\n    timeout: 10 * 60 * 5,\n    onIdle: handleOnIdle,\n    debounce: 500\n  })\n\n  const blockData:any = initBlock[0]? initBlock : null;\n\n  // useEffect(() => {\n  //   console.log(\"case: blockList 붙혀넣기\", TEST_CASE_01);\n  //   console.log(\"adsd\");\n  // }, []);\n\n  const { pageToggle } = usePage();\n\n  return (\n    <div className=\"flex h-full relative overflow-auto\">\n      <Sibebar />\n      <div className={classNames(\n        \"flex-auto w-full h-full py-2 pr-2 ml-2\"\n      )}>\n        <div className=\"blocklog items-center overflow-auto w-full notranslate text-gray-700 bg-white h-full rounded-md shadow-md\">\n          <div className=\"cover mb-8\"></div>\n          <div className=\"m-auto h-full block-container\">\n            {\n              blockData?\n              blockData.map((block: BlockData<any>)=> \n                <Block \n                  blockData={block}\n                  key={block.id}\n                />\n              ) : <div>\"\"</div>\n            }\n            {\n              blockData.length <= 1? \n              <div className=\"bk-zone\"> \n                <div \n                  className=\"bk-block\" \n                  placeholder=\"입력해주세요...\"\n                  onFocus={()=>onAddBlock()}\n                  onClick={()=>onAddBlock()}\n                  contentEditable=\"true\"\n                ></div>\n              </div> : null\n            }\n            <button onClick={click}>블럭 추가</button>\n            <button onClick={handleClick}>스타일 추가</button>\n            <button onClick={testHandleClick}>스위칭</button>\n            <button onClick={revertHandleClick}>되돌리기</button>\n          </div>\n        </div>\n      </div>\n    </div>\n    \n  )\n}\n\nexport default BklogContainer;","import React, { useState, useEffect } from 'react';\nimport { RouteComponentProps } from 'react-router';\nimport classNames from 'classnames';\n\nimport BklogContainer from '../containers/BklogContainer';\nimport useAuth from '../hooks/useAuth';\n\ninterface MatchParams {\n  id: string;\n}\n\nfunction BkPage({ match }: RouteComponentProps<MatchParams>) {\n\n  const {\n    onCheckToken\n  } = useAuth();\n\n  console.log(match.params.id, match);\n\n  useEffect(()=> {\n    onCheckToken();\n  },[]);\n\n  return (\n    <div className={classNames(\"bk-page\", \"h-full\", \"overflow-scroll\")}>\n      <BklogContainer />\n    </div>\n  );\n}\n\nexport default BkPage;","import React, { useState } from \"react\";\n\ninterface Node {\n  id: string;\n  type: string; // class에 들어가거나 타입에 따라 작동 방식을 넣을 것.\n  content: string; \n}\n\ninterface NodeDomDefaultProps {\n  node: Node;\n  addNode: any\n}\n\n\nfunction NodeDom({ node, addNode }:NodeDomDefaultProps) {\n\n  const { id, type, content }  = node;\n  const [ editable, setAble ] = useState<boolean>(false);\n\n  const setEdit = (e:any) => {\n    if(e.key === \"Enter\") {\n      setAble(false);\n      addNode(e);\n    }\n  }\n  const editing = () => {\n    setAble(true);\n  }\n\n  return (\n    <div \n      className={type} \n      data-id={id} \n      contentEditable={editable}\n      onKeyPress={setEdit}\n      onClick={editing}\n    >\n      {content}\n    </div>\n  )\n}\n\nfunction Editor() {\n\n  const [ nodeData, setNodeData ] = useState<Node[]>([{\n    type: \"text\",\n    content: \"asdsd\",\n    id: \"123\"\n  }]);\n\n  const addNode = (e:any) => {\n    console.log(e.key);\n    if(e.key === \"Enter\") {\n      const data = nodeData.concat();\n      data.push({\n        type: \"text\",\n        content: \"asdsd\",\n        id: \"123\"\n      })\n      console.log(data);\n      setNodeData(data);\n    }\n  }\n\n  return (\n    <div>\n      {\n        nodeData? \n        nodeData.map((node, idx) => \n          <NodeDom \n            node={node}\n            key={idx}\n            addNode={addNode}\n          />\n        )\n        : \"Loading...\"\n      }\n      <textarea onKeyPress={addNode}></textarea>\n    </div>\n  )\n}\n\nexport default Editor;","import React from 'react';\n\ninterface UserBlockProps {\n  className?: string;\n  penName: string;\n  userPhoto: string;\n  onClick: any;\n}\n\nfunction UserBlock({ \n  className, \n  penName, \n  userPhoto, \n  onClick\n}: UserBlockProps ) {\n  return (\n    <button onClick={onClick} className={`${className} max-w-xs rounded-xl flex items-center text-sm py-1 px-2`} id=\"user-menu\">\n      <span className=\"sr-only\">{penName}</span>\n      {\n        userPhoto? \n        <img className=\"h-8 w-8 rounded-full\" src={userPhoto} alt={penName} />\n        : <div className=\"h-8 w-8 rounded-full bg-blue-400 leading-8\">{penName[0]}</div>\n      } \n      <span className=\"ml-4\">{penName}</span>\n    </button>\n  )\n}\n\nexport default UserBlock;","import React from 'react';\nimport classNames from 'classnames';\nimport useBase from '../../hooks/useBase';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCircle, faMoon } from '@fortawesome/free-solid-svg-icons';\n\nfunction DarkModeToggle() {\n\n  const { baseState: { dark }, onChangeMode } = useBase();\n\n  const handleClickToggle = () => {\n    onChangeMode();\n  }\n\n  return (\n    <div className=\"dark-mode-toggle\">\n      <button \n        onClick={handleClickToggle}\n        className={classNames(\n          \"mode-field hover:bg-yellow-300 transition-all bg-gray-200 dark:bg-gray-700 dark:hover:bg-indigo-900 w-16 h-8 rounded-full p-1 border-none\",\n          \"text-2xl leading-6 text-left text-white dark:text-gray-500 hover:text-yellow-50 dark:hover:text-yellow-300\"\n        )}\n      >\n        <span className=\"sr-only\">Dark mode toggle</span>\n        <FontAwesomeIcon className={classNames(\"transform transition-all\", {\"translate-x-8\": dark})} icon={dark? faMoon : faCircle} />\n      </button>\n    </div>\n  )\n}\n\nexport default DarkModeToggle;","import React, { useState, useEffect } from 'react';\nimport classNames from 'classnames';\nimport useAuth from '../../hooks/useAuth';\nimport UserBlock from './user/Userblock';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faBars } from '@fortawesome/free-solid-svg-icons';\nimport usePage from '../../hooks/usePage';\nimport { Link } from 'react-router-dom';\nimport DarkModeToggle from './DarkModeToggle';\n\n\nfunction dummyUserBlock() {\n  return (\n    <div>\n\n    </div>\n  )\n}\n\nconst LinkClasses = \"hover:bg-purple-500 hover:text-white px-3 py-2 rounded-md text-sm font-medium\";\n\nfunction GlobalNav() {\n\n  const [ onUserMenu, setOnUserMenu ] = useState<boolean>(false); \n\n  const {\n    pageToggle,\n    onChangeToggle\n  } = usePage();\n\n  const { \n    authState: { loading, user },\n    onSignOutUser\n  } = useAuth();\n\n  const handleClickToggle = () => {\n    onChangeToggle();\n  }\n\n  const handleClickUserMenu = () => {\n    setOnUserMenu(!onUserMenu);\n  }\n\n  const handleClickToggleFalse = (e: any) => {\n    setOnUserMenu(false);\n  }\n\n  const handleClickSignOut = () => {\n    onSignOutUser();\n  }\n\n  return (\n    <nav className=\"bg-white dark:bg-black absolute left-0 top-0 z-10 shadow w-full\">\n      <div className=\"w-full pr-4 pl-1\">\n        <div className=\"flex items-center justify-between h-14\">\n\n        <div className=\"hidden md:block\">\n          <div className=\"flex items-center space-x-4\">\n          <div className=\"flex-shrink-0\">\n            <button \n              className={classNames(\"w-12 h-12 text-xl rounded\", {\"text-white bg-purple-500 shadow\": pageToggle}, {\"text-gray-500 hover:text-purple-500\": !pageToggle})}\n              onClick={handleClickToggle}\n            >\n              <FontAwesomeIcon icon={faBars} />\n            </button>\n          </div>\n\n            <div className=\"ml-0 relative\">\n              <div>\n                {\n                  user?\n                  <UserBlock\n                    className={classNames({\"hover:bg-purple-500 hover:text-white outline-none\": onUserMenu})}\n                    userPhoto={user.userPhoto}\n                    penName={user.penName}\n                    onClick={handleClickUserMenu}\n                  />\n                  : loading?\n                    <button className=\"max-w-xs rounded-full flex items-center text-sm\" id=\"user-menu\" aria-haspopup=\"true\">\n                      <span className=\"sr-only\"></span>\n                      <div className=\"h-8 w-8 rounded-full leading-8 bg-gray-200\"></div>\n                    </button> \n                  : <div className=\"flex items-center\">\n                      <div className=\"hidden md:block\">\n                        <div className=\"flex items-baseline space-x-4 text-gray-700 dark:text-gray-100\">\n            \n                          <Link className={LinkClasses} to=\"/auth/sign-in\">Sign In</Link>\n                          <Link className={LinkClasses} to=\"/auth/sign-up\">Sign up</Link>\n            \n                        </div>\n                      </div>\n                    </div>\n                }\n              \n              </div>\n              {\n                onUserMenu && user? \n                <div onMouseLeave={handleClickToggleFalse} className=\"origin-top-right absolute left-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5\" role=\"menu\" aria-orientation=\"vertical\" aria-labelledby=\"user-menu\">\n                  <Link to={`/bklog/${user.penName}`} className=\"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\">My Page</Link>\n                  <a href=\"#\" className=\"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\" role=\"menuitem\">View Profile</a>\n                  <button \n                    className=\"block text-left w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                    onClick={handleClickSignOut}\n                  > Sign out </button>\n                </div> : null\n              }\n              \n            </div>\n\n            <div className=\"hidden md:block\">\n              <div className=\"flex items-baseline space-x-4 text-gray-700 dark:text-gray-100\">\n\n                <Link className={LinkClasses} to=\"/home\">Home</Link>\n\n              </div>\n            </div>\n                \n\n          </div>\n        </div>\n\n        <div className=\"flex items-center\">\n          <DarkModeToggle />\n        </div>\n\n        </div>\n      </div>\n    </nav>\n  )\n}\n\nexport default GlobalNav;","import GlobalNav from './GlobalNav';\n\nexport default GlobalNav;","import React from 'react';\nimport { BrowserRouter as Router, Switch, Route, HashRouter, Redirect} from 'react-router-dom';\nimport AuthPage from './pages/AuthPage';\nimport useBase from './hooks/useBase';\nimport Home from './pages/HomePage';\nimport BkPage from './pages/BkPage';\nimport Editor from './components/editor/index';\nimport GlobalNav from './components/gnb';\nimport classNames from 'classnames';\nimport './assets/App.scss';\n\nfunction App() {\n\n  const { baseState: { dark } } = useBase();\n\n  return (\n    <div className={classNames(\n      \"App w-full h-screen\",\n      {\"dark\": dark},\n      {\"light\": !dark}\n    )}>\n      <div className=\"w-full h-full pt-14 bg-gray-100 dark:bg-gray-900 text-gray-700 dark:text-gray-100\">\n      <Router basename=\"/\">\n        <GlobalNav />\n        <Switch>\n          <Route path=\"/\" exact>\n            <Redirect to=\"/bklog\" />\n          </Route>\n          <Route path=\"/home\" component={Home} />\n          <Route path=\"/edit\" component={Editor} />\n          <Route path=\"/bklog\" component={BkPage} />\n          <Route path=\"/auth\" component={AuthPage} />\n        </Switch>\n      </Router>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","import { BaseState, BaseActions, CHANGE_DARK_MODE, SERVER_DISCONNECTED } from \"./utils\";\n\nconst initState: BaseState = {\n  dark: false,\n  error: null\n}\n\nfunction base(state: BaseState = initState, action: BaseActions) {\n  switch(action.type) {\n    case CHANGE_DARK_MODE:\n      return Object.assign({}, state, {\n        dark: !state.dark\n      });\n\n    case SERVER_DISCONNECTED:\n      return Object.assign({}, state, {\n        error: action.payload.error\n      });\n\n    default: \n      return state;\n  }\n}\n\nexport default base;\n","import { \n  AuthState, \n  AuthActions,\n  SIGNINUSER, \n  SIGNOUTUSER, \n  SIGNINUSER_SUCCESS,\n  SIGNINUSER_ERROR,\n  SIGNOUTUSER_SUCCESS,\n  SIGNOUTUSER_ERROR,\n  RESIGNINUSER,\n  RESIGNINUSER_SUCCESS,\n  RESIGNINUSER_ERROR,\n  SIGNUPUSER,\n  SIGNUPUSER_SUCCESS,\n  SIGNUPUSER_ERROR,\n  RESET_AUTH,\n} from './utils';\n\nconst initialState = (): AuthState  => {\n  return {\n    loading: false,\n    user: null,\n    error: {\n      signInUser: null,\n      signUpUser: {\n        emailValid: false,\n        passwordValid: false,\n        penNameValid: false,\n        emailUsed: false,\n        penNameUsed: false\n      },\n      signOutUser: null\n    }\n  }\n};\n\nconst initialError = ()=> {\n  return  {\n    signInUser: null,\n    signUpUser: {\n      emailValid: false,\n      passwordValid: false,\n      penNameValid: false,\n      emailUsed: false,\n      penNameUsed: false\n    },\n    signOutUser: null\n  }\n};\n\n\n//server와 연결이 끊겼을 때 error 핸들링 필요.\nexport default function auth(state: AuthState = initialState(), action: AuthActions) {\n  switch (action.type) {\n    case SIGNUPUSER:\n      return Object.assign({}, initialState, { loading: true, \n        error: initialError()\n      });\n    case SIGNUPUSER_SUCCESS:\n      return Object.assign({}, state, { loading: false });\n    case SIGNUPUSER_ERROR: \n      return Object.assign({}, state, { \n        loading: false,\n        error: Object.assign({}, state.error, {\n          signUpUser: action.payload.error\n        })\n       });\n\n    case SIGNINUSER:\n    case RESIGNINUSER:\n      return Object.assign({}, initialState, { loading: true,\n        user: null, \n        error: initialError()\n      });\n\n    case SIGNINUSER_SUCCESS:\n    case SIGNINUSER_ERROR:\n    case RESIGNINUSER_SUCCESS:\n    case RESIGNINUSER_ERROR:\n      console.log(\"aaa\", action);\n      const { userInfo, error } = action.payload;\n      return Object.assign({}, state, {loading: false, \n        user: userInfo, \n        error: Object.assign({}, state.error, {\n          signInUser: error\n        })\n      });\n\n    case SIGNOUTUSER:\n      return initialState();\n\n    case SIGNOUTUSER_SUCCESS:\n      return Object.assign({}, state, { loading: false });\n      \n    case SIGNOUTUSER_ERROR: \n      return Object.assign({}, state, { loading: false, \n        error: Object.assign({}, state.error, {\n          signOut: \"서버와 통신이 불안정합니다.\"\n        })\n      });\n\n    case RESET_AUTH:\n      return initialState();\n  \n    default:\n      console.log(state);\n      return state;\n  }\n}","import { takeEvery, call, put } from 'redux-saga/effects';\nimport { \n  authFetchGet, \n  authFetchPost, \n  SIGNINUSER, \n  SIGNOUTUSER, \n  UserAuthInfo, \n  User,\n  RequiredUserInfo,\n  ResSignUpUser,\n  SIGNUPUSER,\n  RESIGNINUSER,\n  REISSUETOKEN,\n  SIGNINUSER_ERROR,\n  RESET_AUTH\n} from './utils/index';\nimport { ResType } from '../../../utils/api-utils';\nimport { SERVER_DISCONNECTED } from '../base/utils';\n\nfunction createPromiseSateAuth(type: string, promiseCreator: any) {\n  const [SUCCESS, ERROR] = [`${type}_SUCCESS`, `${type}_ERROR`];\n  return function* saga(action: any) {\n    try {\n      const response = yield call(promiseCreator, action.payload);\n\n      const payload = response.data? response.data : null;\n      const success = response.data? response.data.success : false;\n      const error = response.data? \n        response.data.error? \n        response.data.error \n        : null \n        : response.error;\n\n      if(payload) {\n        delete payload.success;\n      }\n      \n      if(success) {\n        yield put({ type: SUCCESS, payload });\n      } else {\n\n        if(error.accessTokken) {\n          yield put({ type: REISSUETOKEN, payload: action });\n        } else {\n          if(payload) {\n            yield put({ type: ERROR, payload });\n          } else {\n            yield put({ type: ERROR, payload: { error }});\n          }\n          \n        }\n  \n      }\n    } catch(e) {\n      yield put({ type: RESET_AUTH });\n      yield put({ type: SERVER_DISCONNECTED, payload: {\n        error: e\n      }});\n\n    }\n  }\n}\n\n\nasync function signInUser(userAuthInfo: UserAuthInfo): Promise<ResType<User>> {\n  return await authFetchPost(\"sign-in\", userAuthInfo);\n}\n\nasync function signOutUser(): Promise<ResType> {\n  return await authFetchGet(\"sign-out\");\n}\n\nasync function signUpUser(requiredUserInfo: RequiredUserInfo): Promise<ResType<ResSignUpUser>> {\n  return await authFetchPost(\"sign-up\", requiredUserInfo);\n}\n\nasync function reSignInUser(): Promise<ResType<User>> {\n  return await authFetchGet(\"resign-in\");\n}\n\nasync function validationAccessToken(): Promise<ResType> {\n  return await authFetchGet(\"check-token\");\n}\n\nasync function reissueToken(): Promise<ResType> {\n  return await authFetchGet(\"reissue-token\");\n}\n\n\nfunction* reissueTokenSaga(action: any) {\n  try {\n    console.log(action);\n    const response = yield call(reissueToken);\n    const data = response.data? response.data : null;\n    const success = response.data? response.data.success : null;\n\n    if(success) {\n      console.log(\"success\", action, data);\n      if(action.payload) {\n        yield put({ type: action.payload.type, payload: action.payload.payload });\n      }\n      \n    } else {\n      console.log(\"error1\", action);\n      yield put({ type: SIGNINUSER_ERROR, payload: {\n        userInfo: null,\n        error: null\n      }});\n\n      if(action.payload) {\n        yield put({ type: `${action.action.type}_ERROR`, payload: {\n          error: {\n            auth: true\n          }\n        }});\n      }\n    }\n\n  } catch(e) {\n    console.log(\"error2\", e);\n    yield put({ type: SERVER_DISCONNECTED, payload: {\n      error: e\n    }})\n    if(action.payload) {\n      yield put({ type: `${action.payload.type}_ERROR`, payload: {\n        error: e\n      }});\n    }    \n  }\n}\n\nconst signInUserSaga = createPromiseSateAuth(SIGNINUSER, signInUser);\nconst signOutUserSaga = createPromiseSateAuth(SIGNOUTUSER, signOutUser);\nconst signUpUserSaga = createPromiseSateAuth(SIGNUPUSER, signUpUser);\nconst reSignInUserSaga = createPromiseSateAuth(RESIGNINUSER, reSignInUser);\n\nexport default function* authSaga() {\n  yield takeEvery(SIGNINUSER, signInUserSaga);\n  yield takeEvery(SIGNOUTUSER, signOutUserSaga);\n  yield takeEvery(SIGNUPUSER, signUpUserSaga);\n  yield takeEvery(RESIGNINUSER, reSignInUserSaga);\n  yield takeEvery(REISSUETOKEN, reissueTokenSaga);\n}","import { combineReducers } from 'redux';\nimport { all } from 'redux-saga/effects';\n\nimport base  from './base';\nimport bklog from './bklog';\nimport auth  from './auth';\nimport page  from './page';\n\nimport authSaga from './auth/authSaga';\n\nconst rootReducer = combineReducers({\n  base,\n  auth,\n  bklog,\n  page\n});\n\nexport function* rootSage() {\n  yield all([authSaga()]); \n}\n\n\nexport default rootReducer;\n\nexport type RootState = ReturnType<typeof rootReducer>;","import { createStore, applyMiddleware, compose } from 'redux';\nimport rootReducer, { rootSage } from './modules';\nimport createSagaMiddleware from 'redux-saga';\n\nconst sagaMiddleware = createSagaMiddleware();\n\n// const middleware = (store: any) => (next: any) => (action: any) => {\n//   console.log(action);\n//   const result = next(action);\n//   return result;\n// }\n\ndeclare global {\n  interface Window {\n    __REDUX_DEVTOOLS_EXTENSION_COMPOSE__?: typeof compose;\n  }\n}\n\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\nconst configureStore = (() => {\n  const store = createStore(rootReducer, composeEnhancers(\n    applyMiddleware(sagaMiddleware)\n  ));\n  sagaMiddleware.run(rootSage);\n\n  return store;\n})();\n\nexport default configureStore;","import React from 'react';\nimport App   from './App';\nimport { Provider } from 'react-redux';\nimport configureStore from './store';\n\nfunction Root() {\n  return (\n    <Provider store={configureStore}>\n      <App />\n    </Provider>\n  )\n}\n\nexport default Root;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Root from './Root';\n\nimport './assets/index.css';\n\nReactDOM.render(\n  <Root />,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}