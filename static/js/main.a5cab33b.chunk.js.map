{"version":3,"sources":["utils/api-utils/cookieUtils.ts","utils/api-utils/api.ts","utils/api-utils/index.ts","store/modules/auth/utils/apiUtils.ts","store/modules/auth/utils/actions.ts","store/modules/auth/utils/index.ts","hooks/useAuth.ts","components/auth/InputComponent.tsx","hooks/useChange.ts","components/auth/sign-in/SignInForm.tsx","components/auth/sign-in/SignIn.tsx","components/auth/sign-in/index.ts","components/auth/sign-up/SignUpForm.tsx","components/auth/sign-up/SignUp.tsx","components/auth/sign-up/index.ts","store/modules/page/index.ts","hooks/usePage.ts","store/modules/page/utils/index.ts","pages/AuthPage.tsx","hooks/useBase.ts","store/modules/base/utils/index.ts","pages/HomePage.tsx","store/modules/bklog/utils/actions.ts","store/modules/bklog/utils/apiUtils.ts","store/modules/bklog/utils/index.ts","store/utils/acyncUtils.ts","store/utils/reducerUtils.ts","store/utils/index.ts","components/newBlock/reducer/utils/actions.ts","components/newBlock/utils/token/index.ts","components/newBlock/reducer/utils/blockUtils.ts","components/newBlock/reducer/utils/converter.ts","components/newBlock/reducer/utils/ordering.ts","components/newBlock/reducer/utils/sideUtils.ts","components/newBlock/reducer/utils/index.ts","components/newBlock/reducer/handler.ts","components/newBlock/reducer/index.ts","components/newBlock/hooks/useBlock.ts","utils/token/index.ts","hooks/useBKlog.ts","hooks/useSocket.ts","components/newBlock/hooks/useConnectRedux.ts","components/newBlock/hooks/useBlockBase.ts","components/newBlock/components/ChildrenBlock.tsx","components/newBlock/components/zone/BaseBlockZone.tsx","components/newBlock/utils/index.ts","components/newBlock/utils/selectionText.ts","components/newBlock/hooks/useTextBlock.ts","components/newBlock/components/elements/text/base/ContentEditableEle.tsx","components/newBlock/components/elements/text/base/ColorStyleToggle.tsx","components/newBlock/hooks/useChange.ts","components/newBlock/components/elements/text/base/TextBlockTypeSelection.tsx","components/newBlock/components/elements/text/base/TextStyleToggleButton.tsx","components/newBlock/components/elements/text/base/TextStyleToggle.tsx","components/newBlock/components/elements/text/TextBlockEle.tsx","components/newBlock/components/elements/text/index.ts","components/newBlock/components/elements/text/TextBlock.tsx","components/newBlock/components/Block.tsx","components/newBlock/index.ts","components/newBlock/BlockEditor.tsx","components/sidebar/profile/EditorBlock.tsx","components/sidebar/profile/Profile.tsx","components/sidebar/profile/index.ts","components/sidebar/Page-list.tsx","components/sidebar/Sidebar.tsx","components/sidebar/index.ts","containers/BklogContainer.tsx","pages/BKPage.tsx","components/gnb/user/Userblock.tsx","components/gnb/DarkModeToggle.tsx","components/gnb/GlobalNav.tsx","components/gnb/index.ts","App.tsx","store/modules/base/index.ts","store/modules/bklog/handler.ts","store/modules/bklog/index.ts","store/modules/auth/index.ts","store/modules/auth/authSaga.ts","store/modules/bklog/saga.ts","store/modules/index.ts","store/index.ts","Root.tsx","index.tsx"],"names":["ApiError","error","type","code","message","detail","this","build","Api","baseUrl","_ajax","axios","create","baseURL","_initializeAjax","interceptors","response","use","data","Promise","reject","request","console","log","ajaxInfo","resolve","then","result","catch","Rest","restObject","Object","assign","url","qs","stringify","addQueryPrefix","call","_restConvert","api","BaseRestFetch","authFetchPost","restApi","method","withCredentials","authFetchGet","query","actions","signUpUser","requiredUserInfo","SIGNUPUSER","payload","signUpUserSuccess","SIGNUPUSER_SUCCESS","signUpUserError","SIGNUPUSER_ERROR","signInUser","userAuthInfo","SIGNINUSER","signInUserError","SIGNINUSER_ERROR","signInUserSuccess","SIGNINUSER_SUCCESS","signOutUser","SIGNOUTUSER","signOutUserError","SIGNOUTUSER_ERROR","signOutUserSuccess","SIGNOUTUSER_SUCCESS","reSignInUser","RESIGNINUSER","reSignInUserError","RESIGNINUSER_ERROR","reSignInUserSuccess","RESIGNINUSER_SUCCESS","reissueToken","REISSUETOKEN","reissueTokenError","REISSUETOKEN_ERROR","resetAuth","RESET_AUTH","authApiUtils","useAuth","state","useSelector","auth","dispatch","useDispatch","onSignUpUser","useCallback","onSignInUser","onReSignInUser","onSignOutUser","onReissueToken","onCheckToken","a","success","user","authState","InputComponent","boxClass","labelClass","onChange","value","placeholder","label","className","name","id","autoComplete","children","htmlFor","useChange","defaultValue","useState","setValue","setError","e","target","SignInForm","email","handleInputEmail","errorEmail","handleErrorEmail","password","handleInputPwd","errorPwd","handleErrorPwd","inputProps","style","handleClickSubmit","preventDefault","useEffect","onSubmit","action","map","props","key","classNames","onClick","icon","faLock","SignIn","createErrorMessage","used","valid","SignUpForm","lastName","handleInputLName","errorLastName","handleErrorLName","firstName","handleInputFName","errorFirstName","handleErrorFName","penName","handleInputPName","errorPenName","handleErrorPName","emailUsed","emailValid","passwordValid","penNameUsed","penNameValid","errorMessage","handleSubmit","SignUp","initialState","toggle","loading","pageEditor","profileId","bio","userPhoto","pageList","pageId","pageTitle","usePage","page","pageToggle","pageState","onChangeToggle","changeToggle","onChangePageTitle","title","changePageTitle","AuthPage","to","path","useBase","base","baseState","onChangeMode","Home","RESET_BKLOG","CLEAR_BKLOG_STATE","GET_PAGE","modifyData","ADD_PUSH_MODIFY_DATA","reqData","UPDATE_BKLOG","preId","UPDATE_VERSION","isUpdate","CHANGE_UPDATE_STATE","GET_PAGE_SUCCESS","GET_PAGE_ERROR","UPDATE_BKLOG_SUCCESS","UPDATE_BKLOG_ERROR","UPDATE_VERSION_SUCCESS","UPDATE_VERSION_ERROR","resetBklog","clearBklogState","getPage","addPushModifyData","updateBklog","updateVersion","changeUpdateState","bklogFetchGet","bklogFetchPost","allResetSaga","put","acyncUtils","createPromiseSaga","promiseCreator","errorType","successType","SUCCESS","ERROR","get","reducerUtils","updateObject","oldObject","newValues","createReducer","handlers","hasOwnProperty","createAction","actionBlock","initBlockState","rawBlockData","INIT_BLOCK_STATE","resetBlock","RESET_BLOCK","addBlock","addBlockList","targetPosition","nextEditInfo","ADD_BLOCK","addTextBlock","index","innerHTML","cursorStart","cursorEnd","ADD_TEXT_BLOCK","changeEditingId","CHANGE_EDITING_ID","editBlock","blockId","blockIndex","contents","EDIT_BLOCK","commitBlock","COMMIT_BLOCK","changeBlockContents","CHANGE_BLOCK_CONTENTS","deleteBlock","removedBlockList","DELETE_BLOCK","deleteTextBlock","textLength","DELETE_TEXT_BLOCK","updateBlock","UPDATE_BLOCK","changeTextStyle","styleType","startPoint","endPoint","order","CHANGE_TEXT_STYLE","revertBlock","front","REVERT_BLOCK","switchBlock","changedBlockIdList","container","SWITCH_BLOCK","setClipboard","SET_CLIPBOARD","clearClipboard","CLEAR_CLIPBOARD","setTempClip","SET_TEMPCLIP","clearTempClip","CLEAR_TEMPCLIP","chageEditorState","CHANGE_EDITOR_STATE","changeTargetPosition","CHANGE_TARGET_POSITION","testClipAdd","TEST_CLIPBOARD","resetEditorState","cliping","EDITOR_STATE_RESET","changeFetchState","fetch","CHANGE_FETCH_STATE","changeStyleType","blockInfo","CHANGE_STYLE_TYPE","clearModifyData","CLEAR_MODIFYDATA","clearNextBlockInfo","CLEAR_NEXTBLOCKINFO","setNextBlockInfo","nextBlockInfo","SET_NEXTBLOCKINFO","Token","token","uuidv4","split","copyToNewObjectArray","array","object","createBlockData","position","styles","parentId","getUUID","blockFindInfex","block","resetToTargetPosition","blockDataList","preBlockDataList","concat","newBlockDataList","targetPositionArg","preBlockListLength","length","stack","stackLength","currentPosition","shift","push","join","positionLength","blockStact","pop","removeBlockInList","blockList","targetBlockList","tempData","update","blocks","blockLength","createTempData","removedIdList","i","setDeleteModifyDataOfBlock","indexOf","includes","newPosition","findIndex","tempDataBlock","undefined","orderingBlock","filter","idList","divideBlock","changeBlockPosition","containerBlockList","setedPosition","prePosition","setPosition","newBlockList","splice","idx","blockUtils","reissueBlockId","addToStage","stage","preStagedBlockList","stagedBlock","newStagedBlock","updateBlockContents","preContents","parseHtmlContents","setUpdateModifyDataOfBlock","changeBlockTextStyle","changedBlock","changeStyleTextContents","addBlockInList","delete","setCreateModifyDataOfBlock","updateTempData","removeTextBlockInList","preBlocks","preIndex","preBlockList","newContents","mergeTextContents","tempIndex","modifyIndex","createModifyData","switchBlockList","blockIdList","targetIndex","restoreBlock","restoreData","entries","toBeCreatedBlock","sortBlock","changeBlockStyleType","updateBlockData","updatedData","set","commentIdList","preBlock","convertType","prop","convertProperty","specialCharacters","text","convertedWord","word","count","equalsArray","aryA","aryB","Array","isArray","targetBList","targetA","JSON","targetBListLength","ii","targetB","arrayFindIndex","factor","addContentsStyle","preTexts","insertText","forEach","content","deleteContentsStyle","stylePosition","newStyle","textStylePosition","newText","converter","saveToggle","propertyToggle","linkToggle","propertys","property","changedTextStyleBlock","changedTextContents","sliceTextContents","partTexts","frontTexts","backTexts","texts","textsLength","toBeMergedContents","targetContents","copyToBeMergedContents","copyTargetContents","frontContent","backContent","sort","b","ary1","ary2","aNum","Number","bNum","preBlockListlength","stackId","stackIdLength","currentPositionLength","reducer","acc","cur","orderingBlockUtils","initBlock","setBlockList","reduce","command","modifyDataReducer","sideStoreUtils","tempDataPush","tempStore","limitCount","newTempStore","getContentsToBeChanged","changedBlocks","updateModifyData","preModifyData","newModifyData","newModifyDataList","convertModifyData","modifyDataList","replaceModifyData","currentData","replaceData","updateData","createData","deleteData","deleteCheck","changeEditorState","blockHandlers","initialBlockState","isFetch","editingBlockId","tempBack","tempFront","back","blockContents","newBlock","removeBlockIdList","toBeDeletedBlock","tempClipData","isGrab","isHoldingDown","isCliping","clipBoard","blockReducer","useBlock","useReducer","useMemo","onInitBlockState","onChangeEditorState","onChangeEditingId","onEditBlock","onCommitBlock","onChangeBlockContents","onAddBlock","onAddTextBlock","onDeleteBlock","onDeleteTextBlock","onChangeTextStyle","onSwitchBlock","onRevertBlock","onChangeTargetPosition","onSetTempClip","onClearTempClip","onResetEditorState","onChangeStyleType","onChangeFetchState","fetchState","onClearModifyData","onUpdateBlock","onClearNextBlockInfo","onSetNextBlockInfo","useBklog","bklogState","bklog","onClearBklogState","onGetPage","onResetBklog","onAddPushModifyData","onUpdateBklog","pageInfo","pushModifyData","pageVersions","current","version","next","onUpdateVersion","onChangeUpdateState","isUpdated","useSocket","currentSocket","setCurrentSocket","io","useConnectRedux","useBlockReducer","socket","newVersion","setVersion","updated","setUpdated","isFetching","isRefresh","currentVersion","eventSocket","on","userInfo","emit","pullModifyData","editingId","timer","setTimeout","clearTimeout","calculatrionPosition","arg","useBlockBase","blockData","parentInfo","isHover","setHover","selected","setSelect","down","setDown","right","setRight","parentSelected","childrenBlockData","downPosition","rightPosition","handleSelectMouseEnter","handleSelectMouseLeave","handleSelectMouseUp","handleGrabMouseDown","child","handleContentsHover","handleContentsBlur","handleContentsMouseLeave","ChildrenBlock","BaseBlockZone","onMouseOver","onMouseLeave","faPlus","onMouseDown","faGripVertical","onMouseEnter","onMouseUp","contentsElement","rawContents","aTag","preText","createContentsElement","accumulator","currentIndex","findTextStyle","textContents","positions","isAfter","offset","node","c","parentNode","previousSibling","compareCaretPositons","node1","offset1","node2","offset2","compareDocumentPosition","Node","DOCUMENT_POSITION_CONTAINED_BY","DOCUMENT_POSITION_CONTAINS","DOCUMENT_POSITION_FOLLOWING","DOCUMENT_POSITION_PRECEDING","stringifyElementStart","isLineStart","tagName","toLowerCase","firstChild","nodeType","TEXT_NODE","nextSibling","getCaretPosition","contenteditable","textPosition","textOffset","lastNode","lastOffset","p","getTextOffset","selectionNode","selectionOffset","setSelectionRange","start","end","selection","window","getSelection","s","setBaseAndExtent","getSelectionStart","anchorNode","anchorOffset","focusNode","focusOffset","getSelectionEnd","useTextBlock","editable","setEditable","setCursorStart","setCursorEnd","styleToggle","setStyleToggle","blockContentsRef","useRef","createMarkup","__html","handleKeyUp","ctrlKey","contentsLength","innerText","moveEndPoint","ele","refreshPoint","handleClick","open","href","handleBlur","relatedTarget","currentTarget","contains","handleFocus","element","focus","focused","document","activeElement","handleKeyPress","handleKeyDown","cursorStartPoint","cursorEndPoint","nextEditIndex","handleMouseUp","getStartPosition","getEndPosition","isFocus","reBlockFocus","ContentEditableEle","React","forwardRef","ref","onKeyPress","onKeyUp","onKeyDown","onCopy","onPaste","onMouseMove","onFocus","onBlur","dangerouslySetInnerHTML","contentEditable","ColorStyleToggleButton","colorCode","onStyleChange","addDelToggle","RGBA","btnStyle","color","addDel","colorCodes","ColorStyleToggle","callback","textBlockType","TextBlockTypeSelection","handleValue","handleChange","TextStyleToggleButton","addDelClassName","TextStyleToggles","startPosition","endPosition","currentStyle","setStyle","contentType","JSONProps","left","TextBlockEle","TextStyleToggle","TextBlock","Block","BlockEditor","editorRef","dragRef","handleOnIdle","handleMouseDown","setAttribute","clientX","clientY","handleMouseMove","handleDrag","handleMouseLeave","metaKey","useIdleTimer","timeout","onIdle","debounce","getLastActiveTime","onDrag","root","hidden","classes","EditorBlock","src","alt","Profile","PageList","faSortDown","Sidebar","Sibebar","BklogContainer","BkPage","match","params","UserBlock","DarkModeToggle","dark","faMoon","faCircle","LinkClasses","GlobalNav","onUserMenu","setOnUserMenu","faBars","aria-haspopup","role","aria-orientation","aria-labelledby","App","basename","exact","component","initState","isLoading","pageVersion","pageStar","pageComments","blockComments","editingUserList","handler","reissueTokenSaga","authSaga","signInUserSaga","signOutUserSaga","signUpUserSaga","reSignInUserSaga","takeEvery","bklogSaga","getPageSaga","updateBklogSaga","updateVersionSaga","versions","commonSaga","rootSage","all","rootReducer","combineReducers","signOut","sagaMiddleware","createSagaMiddleware","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","configureStore","store","createStore","applyMiddleware","run","Root","ReactDOM","render","getElementById"],"mappings":"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AOA,GACL,IAAK,MACH,MA7CO,IA8CT,IAAK,SACH,MA9CQ,IA+CV,QACE,OAAOA,GASb,SAASE,GACPC,EACAjE,GAQA,IALA,IACIkE,EADAC,EAAcF,EAAKjE,GAEnBoE,EAAQpE,EAAI,EACZnB,EAASoF,EAAKpF,OAEI,MAAhBoF,EAAKG,IAAkC,MAAhBH,EAAKG,IAAkBA,EAAQvF,IAC1DsF,GAAQF,EAAKG,GACM,MAAhBH,EAAKG,KACRA,IAGF,GAAmB,MAAhBH,EAAKG,GACN,OAAOD,GACL,IAAK,SACHD,EAAa,IACb,MACF,IAAK,QACHA,EAAgB,IAChB,MACF,IAAK,OACHA,EAAgB,IAChB,MACF,IAAK,OACHA,EAAgB,IAChB,MACF,IAAK,SACHA,EAAgB,IAChB,MACF,IAAK,UACHA,EAAgB,OAChB,MACF,IAAK,SACHA,EAAgB,SAChB,MACF,IAAK,UACHA,EAAgB,SAChB,MACF,IAAK,WACHA,EAAgB,OAChB,MACF,IAAK,QACHA,EAAgB,SAChB,MACF,IAAK,WACHA,EAAgB,IAChB,MACF,IAAK,SACHA,EAAgB,OAChB,MACF,IAAK,QACHA,EAAgB,OAChB,MACF,IAAK,SACHA,EAAgB,SAChB,MACF,IAAK,SACHA,EAAgB,OAChB,MACF,IAAK,UACHA,EAAgB,SAChB,MACF,IAAK,QACHA,EAAgB,SAChB,MACF,IAAK,QACHA,EAAgB,IAChB,MACF,IAAK,QACHA,EAAgB,IAChB,MACF,IAAK,SACHA,EAAgBC,EAChB,MACF,IAAK,QACHD,EAAgB,OAChB,MACF,IAAK,WACHA,EAAgB,OAChB,MACF,IAAK,SACHA,EAAgB,OAChB,MACF,IAAK,SACHA,EAAgB,OAChB,MACF,IAAK,SACHA,EAAgB,OAChB,MACF,IAAK,UACHA,EAAgB,OAChB,MACF,IAAK,UACHA,EAAgB,SAChB,MACF,IAAK,SACHA,EAAgB,OAChB,MACF,IAAK,WACHA,EAAgB,OAChB,MACF,IAAK,UACHA,EAAgB,OAChB,MACF,IAAK,SACHA,EAAgB,OAChB,MACF,IAAK,UACHA,EAAgB,SAChB,MACF,IAAK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","file":"static/js/main.a5cab33b.chunk.js","sourcesContent":["function getCookieList() {\n  return document.cookie;\n}\n\nfunction getCookie(name: string): string | null {\n  const cookieList:any = document.cookie;\n    \n  if(cookieList) {\n    const cookieValue = cookieList? \n      cookieList\n      .split(\"; \")\n      .find((row: any) => row.startsWith(name))\n      .split(\"=\")[1] : null;\n\n    return cookieValue;\n  } else {\n    return null;\n  }\n}\n\nconst CookieUtils = {\n  getCookie,\n  getCookieList\n}\n\nexport default CookieUtils;","import axios, { AxiosRequestConfig, AxiosInstance, AxiosResponse, AxiosError } from 'axios';\nimport { stringify } from 'qs';\nimport { ApiErrorType, IRestObject, IGqlObject } from '.';\n\nexport class ApiError implements ApiErrorType {\n  type: string = \"unknown\";\n  code: string | number = \"000\";\n  message: string = \"알 수 없는 오류입니다.\";\n  detail: string = \"unknown\";\n\n  constructor(error?: any) {\n    if(error) this.build(error);\n  }\n\n  build(error: any) {\n    if(error.type) this.type = error.type;\n    if(error.code) this.code = error.code;\n    if(error.message) this.message = error.message;\n    if(error.detail) this.detail = error.detail;\n\n    return this;\n  }\n\n  setType(type: string): ApiError {\n    this.type = type;\n    return this;\n  }\n\n  setCode(code: string | number): ApiError {\n    this.code = code;\n    return this;\n  }\n\n  setMessage(message: string): ApiError {\n    this.message = message;\n    return this;\n  }\n\n  setDetail(detail: string): ApiError {\n    this.detail = detail;\n    return this;\n  } \n\n  get get(): ApiErrorType {\n    return {\n      type: this.type,\n      code: this.code,\n      message: this.message,\n      detail: this.detail\n    }\n  }\n}\n\nexport class Api {\n  _ajax  : AxiosInstance;\n  baseUrl: string;\n\n  constructor (baseUrl: string) {\n    this.baseUrl = baseUrl;\n    this._ajax = axios.create({\n      baseURL: baseUrl\n    })\n\n    this._initializeAjax();\n  }\n\n  _initializeAjax () {\n    this._ajax.interceptors.response.use((response: AxiosResponse) => {\n      return response.data;\n    }, (error: AxiosError) => {\n      if(error.response) {\n\n        if(error.response.data.error) {\n          return Promise.reject(new ApiError().build(error.response.data.error));\n        } else {\n          return Promise.reject(new ApiError().build(error.response.data));\n        }\n\n      } else if (error.request){\n        // 요청이 이루어 졌으나 응답을 받지 못했습니다.\n        // `error.request`는 브라우저의 XMLHttpRequest 인스턴스 또는\n        // Node.js의 http.ClientRequest 인스턴스입니다.\n        console.log(error.request);\n        return Promise.reject({ \n          message: error.message,\n          detail: \"response not\"\n         });\n      } else {\n        console.log(error);\n        return Promise.reject({ message: error.message });\n      }\n    });\n  }\n\n  call (ajaxInfo: AxiosRequestConfig): Promise<any> {\n    return new Promise((resolve, reject) => {\n      this._ajax(ajaxInfo)\n      .then((result: any) => {\n        resolve(result);\n      })\n      .catch((error: ApiError) => {\n        reject(error);\n      });\n    });\n  };\n}\n\nexport class Rest extends Api {\n\n  constructor (baseUrl: string) {\n    super(baseUrl)\n  }\n\n  _restConvert (restObject: IRestObject) {\n    return Object.assign({}, restObject, {\n      url: (() => {\n        if (restObject.qs) {\n          return `${restObject.url}${stringify(restObject.qs, { addQueryPrefix: true })}`\n        } else {\n          return restObject.url\n        }\n      })()\n    }) as AxiosRequestConfig;\n  }\n\n  restApi (restObject: IRestObject): Promise<any> {\n    return new Promise((resolve, reject) => {\n      this.call(this._restConvert(restObject))\n      .then((result: AxiosResponse) => {\n        resolve(result);\n      })\n      .catch((error: any) => {\n        reject(error);\n      })\n    })\n  }\n}\n\nexport default {\n  Api,\n  Rest,\n  ApiError\n}","import apiUtils    from './apiUtils';\nimport cookieUtils from './cookieUtils';\nimport { AxiosRequestConfig } from 'axios';\nimport api from './api';\n\nexport type ResType<T = any> = T;\n\nexport interface RequestArg<Data = any , Params = any> {\n  method: AxiosRequestConfig[\"method\"];\n  url: string;\n  data?: Data;\n  params?: Params;\n  withCredentials?: boolean;\n}\n\nexport interface ApiErrorType {\n  type: string;\n  code: string | number;\n  message: string;\n  detail: string;\n}\n\nexport interface IRestObject {\n  url    : string,\n  method : string,\n  header?: string,\n  qs    ?: any,\n  data  ?: any,\n  withCredentials?: boolean\n}\n\nexport interface IGqlObject {\n  variables?: object,\n  query     : string\n}\n\n/**\n * Api Utils\n */\nexport const baseFetch = apiUtils.baseFetch;\n\n/**\n * Cookie Utils\n */\nexport const getCookie = cookieUtils.getCookie;\nexport const getCookieList = cookieUtils.getCookieList;\n\n/**\n * Api\n */\nexport const Api      = api.Api;\nexport const Rest     = api.Rest;\nexport const ApiError = api.ApiError;\n\nconst API_SERVER_URL = \"http://localhost:4500/v2\"\n\nexport const BaseRestFetch = new Rest(API_SERVER_URL);","import { BaseRestFetch } from \"../../../../utils/api-utils\";\n\nfunction authFetchGet(url: string, query?: any) {\n  return BaseRestFetch.restApi({\n    method: \"get\",\n    url: `auth/${url}`,\n    withCredentials: true,\n    qs: query\n  });\n}\n\nfunction authFetchPost(url: string, data: object) {\n  return BaseRestFetch.restApi({\n    method: \"post\",\n    url: `auth/${url}`,\n    withCredentials: true,\n    data\n  });\n}\n\nexport default { authFetchPost, authFetchGet };\n","import { \n  RequiredUserInfo, \n  SIGNUPUSER, \n  UserAuthInfo, \n  SIGNINUSER, \n  User, \n  SIGNINUSER_SUCCESS, \n  SIGNINUSER_ERROR, \n  SIGNOUTUSER,\n  SIGNOUTUSER_SUCCESS,\n  SIGNOUTUSER_ERROR,\n  RESIGNINUSER,\n  RESIGNINUSER_SUCCESS,\n  RESIGNINUSER_ERROR,\n  SIGNUPUSER_SUCCESS,\n  SIGNUPUSER_ERROR,\n  REISSUETOKEN_ERROR,\n  REISSUETOKEN,\n  RESET_AUTH\n } from \".\";\n\nconst signUpUser = ( requiredUserInfo: RequiredUserInfo ) => {\n  return {\n    type: SIGNUPUSER,\n    payload: requiredUserInfo\n  }\n}\n\nconst signUpUserSuccess = () => {\n  return {\n    type: SIGNUPUSER_SUCCESS\n  }\n}\n\nconst signUpUserError = (error: any) => {\n  return {\n    type: SIGNUPUSER_ERROR,\n    payload: {\n      error\n    }\n  }\n}\n\nconst signInUser = ( userAuthInfo: UserAuthInfo ) => {\n  return {\n    type: SIGNINUSER,\n    payload: userAuthInfo\n  }\n}\n\nconst signInUserSuccess = (payload: User) => {\n  return {\n    type: SIGNINUSER_SUCCESS,\n    payload\n  }\n};\n\nconst signInUserError = (payload: User) => {\n  return {\n    type: SIGNINUSER_ERROR,\n    payload\n  }\n}\n  \nconst signOutUser = () => {\n  return {\n    type: SIGNOUTUSER\n  }\n}\n\nconst signOutUserSuccess = () => {\n  return {\n    type: SIGNOUTUSER_SUCCESS\n  }\n}\n\nconst signOutUserError = () => {\n  return {\n    type: SIGNOUTUSER_ERROR\n  }\n};\n\nconst reSignInUser = () => {\n  return {\n    type: RESIGNINUSER\n  }\n}\n\nconst reSignInUserSuccess = (payload: User) => {\n  return {\n    type: RESIGNINUSER_SUCCESS,\n    payload\n  }\n};\n\nconst reSignInUserError = (payload: User) => {\n  return {\n    type: RESIGNINUSER_ERROR,\n    payload\n  }\n};\n\nconst reissueToken = () => {\n  return {\n    type: REISSUETOKEN\n  }\n}\n\nconst reissueTokenError = (payload: User) => {\n  return {\n    type: REISSUETOKEN_ERROR,\n    payload\n  }\n}\n\nconst resetAuth = () => {\n  return {\n    type: RESET_AUTH\n  }\n}\n\nconst actions = {\n  signUpUser,\n  signUpUserSuccess,\n  signUpUserError,\n  signInUser,\n  signInUserError,\n  signInUserSuccess,\n  signOutUser,\n  signOutUserError,\n  signOutUserSuccess,\n  reSignInUser,\n  reSignInUserError,\n  reSignInUserSuccess,\n  reissueToken,\n  reissueTokenError,\n  resetAuth\n}\n\nexport default actions;","import authApiUtils from './apiUtils';\nimport actions from './actions';\nimport { ApiErrorType } from '../../../../utils/api-utils';\nimport { createAction } from 'typesafe-actions';\n\nexport const SIGNUPUSER = \"auth/SIGN_UP_USER\" as const;\nexport const SIGNUPUSER_SUCCESS = \"auth/SIGN_UP_USER_SUCCESS\" as const;\nexport const SIGNUPUSER_ERROR = \"auth/SIGN_UP_USER_ERROR\" as const;\n\nexport const SIGNINUSER = \"auth/SIGN_IN_USER\" as const;\nexport const SIGNINUSER_SUCCESS = \"auth/SIGN_IN_USER_SUCCESS\" as const;\nexport const SIGNINUSER_ERROR = \"auth/SIGN_IN_USER_ERROR\" as const;\n\nexport const SIGNOUTUSER = \"auth/SIGN_OUT_USER\" as const;\nexport const SIGNOUTUSER_SUCCESS = \"auth/SIGN_OUT_USER_SUCCESS\" as const;\nexport const SIGNOUTUSER_ERROR = \"auth/SIGN_OUT_USER_ERROR\" as const;\n\nexport const RESIGNINUSER = \"auth/RESIGN_IN_USER\" as const;\nexport const RESIGNINUSER_SUCCESS = \"auth/RESIGN_IN_USER_SUCCESS\" as const;\nexport const RESIGNINUSER_ERROR = \"auth/RESIGN_IN_USER_ERROR\" as const;\n\nexport const REISSUETOKEN = \"REISSUETOKEN\" as const;\nexport const REISSUETOKEN_ERROR = \"REISSUETOKEN_ERROR\" as const;\n\nexport const RESET_AUTH = \"auth/RESET_AUTH\" as const;\n\nexport const ERROR_AUTH = 'auth/RESET_AUTH' as const;\n\nexport interface AuthState {\n  loading: boolean;\n  user: UserInfo | null;\n  error: {\n    signInUser: SignInError | null,\n    signUpUser: SignUpError,\n    signOutUser: any\n  }\n}\n\nexport interface AuthState2 {\n  loading: boolean;\n  user: UserInfo | null;\n  signUp: SignUpError; \n  error: ApiErrorType;\n}\n\nexport interface UserProfile {\n  penName: string;\n  profileId: string;\n  userPhoto: string;\n  bio: string; \n}\n\nexport interface UserInfo extends UserProfile {\n  firstName: string;\n  lastName: string;\n  email: string;\n}\n\nexport interface User {\n  userInfo: UserInfo | null;\n  error: SignInError | null;\n}\n\nexport interface SignInError {\n  countOfFail: number;\n  isActive: boolean;\n  isNotDormant: boolean;\n}\n\nexport interface AuthReq<T = any> {\n  url: string,\n  data: T\n}\n\nexport interface UserAuthInfo {\n  email: string;\n  password: string;\n}\n\nexport interface RequiredUserInfo extends UserAuthInfo {\n  penName: string;\n  firstName: string;\n  lastName: string;\n}\n\nexport interface SignUpError {\n  emailValid: boolean;\n  passwordValid: boolean;\n  penNameValid: boolean;\n  emailUsed: boolean;\n  penNameUsed: boolean;\n}\n\nexport interface ResSignUpUser {\n  error? : {\n    emailValid: boolean;\n    passwordValid: boolean;\n    penNameValid: boolean;\n    emailUsed: boolean;\n    penNameUsed: boolean;\n  }\n}\n\n/**\n * actions\n */\nexport const signUpUser = actions.signUpUser;\nexport const signInUser = actions.signInUser;\nexport const signOutUser = actions.signOutUser;\nexport const reSignInUser = actions.reSignInUser;\nexport const reissueToken = actions.reissueToken;\nexport const resetAuth = actions.resetAuth;\n\nconst { \n  signUpUserSuccess,\n  signUpUserError,\n  signInUserSuccess, \n  signInUserError,\n  signOutUserSuccess,\n  signOutUserError,\n  reSignInUserError,\n  reSignInUserSuccess,\n  reissueTokenError\n} = actions;\n\nexport type AuthActions = \n  ReturnType<typeof signUpUser>\n  | ReturnType<typeof signUpUserSuccess>\n  | ReturnType<typeof signUpUserError>\n  | ReturnType<typeof signInUser>\n  | ReturnType<typeof signOutUser>\n  | ReturnType<typeof signInUserSuccess>\n  | ReturnType<typeof signInUserError>\n  | ReturnType<typeof signOutUserSuccess>\n  | ReturnType<typeof signOutUserError>\n  | ReturnType<typeof reSignInUser>\n  | ReturnType<typeof reSignInUserSuccess>\n  | ReturnType<typeof reSignInUserError>\n  | ReturnType<typeof reissueTokenError>\n  | ReturnType<typeof resetAuth>\n;\n\nexport const authFetchPost = authApiUtils.authFetchPost;\nexport const authFetchGet  = authApiUtils.authFetchGet;\n\n","import { useCallback } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { \n  AuthState, \n  UserAuthInfo, \n  UserInfo,\n  signInUser, \n  reSignInUser, \n  signOutUser,\n  reissueToken,\n  RequiredUserInfo,\n  signUpUser\n} from '../store/modules/auth/utils';\nimport { RootState } from '../store/modules';\nimport authApiUtils from '../store/modules/auth/utils/apiUtils';\n\nfunction useAuth() {\n  const state: AuthState = useSelector((state: RootState) => state.auth);\n\n  const dispatch = useDispatch();\n\n  const onSignUpUser = useCallback((requiredUserInfo: RequiredUserInfo) => \n    dispatch(signUpUser(requiredUserInfo)), [dispatch]);\n\n  const onSignInUser = useCallback((userAuthInfo: UserAuthInfo) => \n      dispatch(signInUser(userAuthInfo))\n    ,[dispatch]);\n  \n  const onReSignInUser = useCallback(()=> dispatch(reSignInUser()),[dispatch]);\n\n  const onSignOutUser = useCallback(()=> dispatch(signOutUser()),[dispatch]);\n\n  const onReissueToken = useCallback(()=> dispatch(reissueToken()),[dispatch]);\n\n  const onCheckToken = async () => {\n    const response = await authApiUtils.authFetchGet('check-token');\n    console.log(response);\n    const data = response.data? response.data : null;\n    const success = response.data? response.data.success : false;\n\n     if(!success) {\n\n       if(state.user) {\n        onReissueToken();\n       }\n\n     } else {\n\n       if(!state.user) {\n\n         onReSignInUser();\n       \n        } else {\n         \n          // if(state.user.userId !== data.userId) {\n          //   onSignOutUser();\n          // }\n\n       }\n     }\n  }\n\n  return {\n    authState: state,\n    onSignUpUser,\n    onSignInUser,\n    onReSignInUser,\n    onSignOutUser,\n    onReissueToken,\n    onCheckToken\n  }\n}\n\nexport default useAuth;","import React from 'react';\n\ninterface InputComponentProps {\n  boxClass?: string;\n  labelClass?: string;\n  onChange: any;\n  value: string | number; \n  placeholder: string;\n  label: string;\n  className?: string;\n  type: string;\n  name: string;\n  id?: string;\n  children?: any;\n  autoComplete?: string;\n}\n\nfunction InputComponent({\n  boxClass,\n  labelClass,\n  onChange,\n  value,\n  placeholder,\n  label,\n  className,\n  type,\n  name,\n  id,\n  autoComplete,\n  children\n}: InputComponentProps) {\n  return (\n    <div className={boxClass}>\n      <label \n        htmlFor={type} \n        className={labelClass}\n      >\n        { label }\n      </label>\n      <input \n        id={id} \n        name={name} \n        type={type} \n        className={className}\n        placeholder={placeholder} \n        value={value}\n        onChange={onChange}\n        autoComplete={autoComplete}\n      />\n      { children }\n    </div>\n  )\n}\n\nexport default InputComponent;","import { useState } from 'react';\n\ntype UseChangeType<T> = [T, (e: any)=> void, boolean, (P: boolean)=> void];\n\nfunction useChange<T = string>(defaultValue: T): UseChangeType<T> {\n  const [ value, setValue ] = useState<T>(defaultValue);\n  const [ error, setError ] = useState<boolean>(false);\n\n  const handleValue = (e:any) => {\n    if(error) {\n      setError(false);\n    }\n    setValue(e.target.value);\n  }\n\n  const handleError = (data: boolean) => {\n    setError(data);\n  }\n\n  return [ value, handleValue, error, handleError ];\n}\n\nexport default useChange;","import React, { useState, useEffect } from 'react';\nimport classNames from 'classnames';\nimport useAuth from '../../../hooks/useAuth';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faLock } from '@fortawesome/free-solid-svg-icons';\nimport InputComponent from '../InputComponent';\nimport useChange from '../../../hooks/useChange';\n\ninterface InputPropsType {\n  value: string;\n  onChange: (e: any) => void;\n  id: string;\n  name: string;\n  type: string;\n  label: string;\n  placeholder: string;\n  autoComplete: string;\n  error: boolean;\n  style: string;\n}\n\n\n// 전송 전에 validation 체크\nfunction SignInForm() {\n\n  const {\n    authState : { error: { signInUser } },\n    onSignInUser\n  } = useAuth();\n\n  const [error, setError] = useState<boolean>(false);\n\n  const [ email, handleInputEmail, errorEmail, handleErrorEmail ] = useChange<string>(\"\");\n  const [ password, handleInputPwd, errorPwd, handleErrorPwd ] = useChange<string>(\"\");\n\n  const inputProps: InputPropsType[] = [\n    {\n      value: email,\n      onChange: handleInputEmail,\n      id: \"email-address\",\n      name: \"email\",\n      type: \"email\",\n      label: \"Email address\",\n      placeholder: \"example@example.com\",\n      autoComplete: \"on\",\n      error: errorEmail,\n      style: \"rounded-t-md\"\n    },\n    {\n      value: password,\n      onChange: handleInputPwd,\n      id: \"password\",\n      name: \"password\",\n      type: \"password\",\n      label: \"password\",\n      placeholder: \"비밀번호\",\n      autoComplete: \"off\",\n      error: errorPwd,\n      style: \"rounded-b-md\"\n    }\n  ]\n\n  const handleClickSubmit = (e: any) => {\n    e.preventDefault();\n    if(email && password) {\n      onSignInUser({email, password});\n    } else {\n      handleErrorEmail(email? false : true);\n      handleErrorPwd(password? false : true);\n    }\n  }\n\n  useEffect(() => {\n    if(signInUser) {\n      setError(true);\n    }\n  },[signInUser]);\n\n  return (\n    <form className=\"mt-12\" onSubmit={handleClickSubmit} action=\"#\">\n      <div className=\"rounded-md shadow-sm -space-y-px\">\n        {\n          inputProps.map((props)=>\n            <InputComponent\n              key={props.id}\n              labelClass=\"sr-only\"\n              className={classNames(\n                \"dark:bg-gray-100 appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 focus:ring-1 sm:text-sm\",\n                props.style,\n                {\"border-red-500\": props.error}\n              )}\n              value={props.value}\n              onChange={props.onChange}\n              id={props.id} \n              name={props.name}\n              type={props.type}\n              label={props.label}\n              placeholder={props.placeholder}\n              autoComplete={props.autoComplete}\n            />\n          )\n        }\n      </div>\n      <div \n        className=\"mb-8 leading-6 h-6 block text-red-500 text-sm font-semibold text-left px-2\"\n      > \n        { \n          error? \n          `가입하지 않은 계정이거나, 잘못된 비밀번호입니다.` \n          : errorEmail || errorPwd \n          ? `계정과 패스워드를 입력해주세요.` \n          : null \n        } \n      </div>\n\n      <div>\n        <button type=\"submit\" onClick={handleClickSubmit} className=\"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-purple-500 hover:bg-purple-600 active:outline-none active:ring-2 active:ring-offset-2 active:ring-purple-600\">\n          <span className=\"absolute left-0 inset-y-0 flex items-center pl-3\">\n            <FontAwesomeIcon className=\"text-base text-purple-300 group-hover:text-purple-200\" icon={faLock} />\n          </span>\n          Sign in\n        </button>\n      </div>\n    </form>\n  )\n}\n\nexport default SignInForm;","import React from 'react';\nimport SignInForm from './SignInForm';\n\nfunction SignIn() {\n\n  return (\n    <div className=\"sign-in w-full h-full flex justify-center bg-gray-50 dark:bg-black pt-40 px-4 sm:px-6 lg:px-8 shadow rounded-md\">\n      <div className=\"max-w-md w-full space-y-10\">\n        <div>\n          <h2 className=\"text-center text-3xl font-extrabold text-gray-900 dark:text-gray-100\">\n            Sign in to your account\n          </h2>\n        </div>\n        <SignInForm />\n      </div>\n    </div>\n  ) \n}\n\nexport default SignIn;","import SignIn from './SignIn';\n\nexport default SignIn;","import React, { useEffect } from 'react';\nimport classNames from 'classnames';\nimport InputComponent from '../InputComponent';\nimport useChange from '../../../hooks/useChange';\nimport useAuth from '../../../hooks/useAuth';\n\ninterface ErrorType {\n  used?: boolean;\n  valid?: boolean;\n  name: string\n}\n\nfunction createErrorMessage({ used, valid, name }: ErrorType) {\n  if(valid) {\n    return `${name} 형식에 맞지 않습니다.`\n  }\n  if(used) {\n    return `사용하고 있는 ${name}입니다.`\n  }\n  return \"필수 정보입니다.\";\n}\n\ninterface InputPropsType {\n  id: string;\n  name: string;\n  type: string;\n  label: string;\n  placeholder: string;\n  value: string | number;\n  onChange: (e: any) => void;\n  error: boolean;\n  errorMessage?: string;\n}\n\n// 전송 전에 validation 체크\nfunction SignUpForm() {\n\n  const [ lastName, handleInputLName, errorLastName, handleErrorLName ] = useChange<string>(\"\");\n  const [ firstName, handleInputFName, errorFirstName, handleErrorFName ] = useChange<string>(\"\");\n  const [ penName, handleInputPName, errorPenName, handleErrorPName ] = useChange<string>(\"\");\n  const [ email, handleInputEmail, errorEmail, handleErrorEmail ] = useChange<string>(\"\");\n  const [ password, handleInputPwd, errorPwd, handleErrorPwd ] = useChange<string>(\"\");\n\n  const { authState: { error: {signUpUser : \n    { emailUsed, emailValid, passwordValid, penNameUsed, penNameValid }}}, \n    onSignUpUser \n  } = useAuth();\n\n  const inputProps: InputPropsType[] = [\n    {\n      id: \"last-name\",\n      name: \"lastName\",\n      type: \"text\",\n      label: \"성\",\n      placeholder: \"성\",\n      value: lastName,\n      onChange: handleInputLName,\n      error: errorLastName,\n      errorMessage: \"필수 정보입니다.\"\n    },\n    {\n      id: \"first-name\",\n      name: \"firstName\",\n      type: \"text\",\n      label: \"이름\",\n      placeholder: \"이름\",\n      value: firstName,\n      onChange: handleInputFName,\n      error: errorFirstName,\n      errorMessage: \"필수 정보입니다.\"\n    },\n    {\n      id: \"pen-name\",\n      name: \"penName\",\n      type: \"text\",\n      label: \"필명\",\n      placeholder: \"영문 필수, 중복이 불가합니다.\",\n      value: penName,\n      onChange: handleInputPName,\n      error: errorPenName,\n      errorMessage: createErrorMessage({\n        name: \"필명\",\n        used: penNameUsed,\n        valid: penNameValid\n      }) \n    },\n    {\n      id: \"email-address\",\n      name: \"email\",\n      type: \"email\",\n      label: \"계정(이메일)\",\n      placeholder: \"example@example.com\",\n      value: email,\n      onChange: handleInputEmail,\n      error: errorEmail,\n      errorMessage: createErrorMessage({\n        name: \"이메일\",\n        used: emailUsed,\n        valid: emailValid\n      }) \n    },\n    {\n      id: \"password\",\n      name: \"password\",\n      type: \"password\",\n      label: \"비밀번호\",\n      placeholder: \"영문, 숫자 조합 8 ~ 12자로 작성해주세요.\",\n      value: password,\n      onChange: handleInputPwd,\n      error: errorPwd,\n      errorMessage: createErrorMessage({\n        name: \"비밀번호\",\n        valid: passwordValid\n      }) \n    }\n  ];\n\n  const handleSubmit = (e: any) => {\n    e.preventDefault();\n    if(!errorLastName && !errorFirstName && !errorEmail && !errorPenName && !errorPwd) {\n      if(penName && firstName && lastName && email && password) {\n        onSignUpUser({\n          penName,\n          firstName,\n          lastName,\n          email,\n          password\n        })\n      } else {\n        handleErrorLName(lastName? false : true);\n        handleErrorFName(firstName? false : true);\n        handleErrorPName(penName? false : true);\n        handleErrorEmail(email? false : true);\n        handleErrorPwd(password? false : true);\n      }\n    } else {\n      console.log(\"실행 안됨\")\n    }\n  }\n\n  useEffect(()=> {\n    if(emailUsed || emailValid) {\n      handleErrorEmail(true);\n    } \n    if(penNameUsed || penNameValid) {\n      handleErrorPName(true);\n    }\n    if(passwordValid) {\n      handleErrorPwd(true);\n    }\n  },[emailUsed, emailValid, passwordValid, penNameUsed, penNameValid])\n\n  return (\n    <form onSubmit={handleSubmit}>\n\n      <div className=\"overflow-hidden sm:rounded-md mb-8\">\n        \n        <div className=\"rounded-md p-2 space-y-4\">\n          \n          {\n            inputProps.map(props =>(\n              <InputComponent \n                key={props.id}\n                boxClass=\"relative group\"\n                labelClass=\"pl-1 mb-1 block text-sm font-medium text-gray-700 dark:text-gray-50\"\n                className={classNames(\n                  \"rounded-md dark:bg-gray-100 appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 focus:ring-1 sm:text-sm\",\n                  {\"border-red-500\": props.error}\n                )}\n                value={props.value}\n                onChange={props.onChange}\n                id={props.id}\n                name={props.name}\n                type={props.type}\n                label={props.label}\n                placeholder={props.placeholder}\n                autoComplete=\"off\"\n              >\n                <span \n                  className={classNames(\n                    \"absolute right-0 top-0 text-red-500 text-sm\",\n                    {\"hidden\": !props.error}\n                  )}\n                >\n                  {props.errorMessage}\n                </span>\n              </InputComponent>\n            ))\n          }\n\n        </div>\n\n      </div>\n\n      <div className=\"p-2\">\n        <button type=\"submit\" onClick={handleSubmit} className=\"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-purple-500 hover:bg-purple-600 active:outline-none active:ring-2 active:ring-offset-2 active:ring-purple-600\">\n          Sign up\n        </button>\n      </div>\n\n    </form>\n  )\n}\n\nexport default SignUpForm;","import React from 'react';\nimport SignUpForm from './SignUpForm';\n\nfunction SignUp() {\n  return (\n    <div className=\"sign-up relative overflow-auto flex items-center w-full h-full bg-gray-50 dark:bg-black shadow rounded-md\">\n      <div className=\"absolute left-0 top-auto py-32 w-full h-auto box-contents flex justify-center\">\n        <div className=\"max-w-md w-full h-auto space-y-10\">\n          <div>\n            <h2 className=\"text-center text-3xl font-extrabold text-gray-900 dark:text-gray-100\">\n              Sign up\n            </h2>\n          </div>  \n          <SignUpForm />\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default SignUp;","import SignUp from './SignUp';\n\nexport default SignUp;","import { CHANGE_PAGE_TITLE, PageState, CHANGE_TOGGLE } from \"./utils\";\n\nexport function changeToggle(toggle?: boolean) {\n  return {\n    type: CHANGE_TOGGLE,\n    payload: {\n      toggle\n    }\n  }\n}\n\nexport function changePageTitle(pageId: string, title: string) {\n  return {\n    type: CHANGE_PAGE_TITLE,\n    payload: {\n      title,\n      pageId\n    }\n  }\n}\n\ntype PageActions = ReturnType<typeof changePageTitle>\n  | ReturnType<typeof changeToggle>;\n\nconst initialState: PageState = {\n  toggle: false,\n  loading: false,\n  pageEditor: {\n    penName: \"Junhee\",\n    profileId: \"4c382a569f1f4ea7841b25bd2efe78d8\",\n    bio: \"프론트엔드 개발자\",\n    userPhoto: \"https://avatars.githubusercontent.com/u/59816563?v=4\"\n  },\n  pageList: [\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e61\",\n      pageTitle: \"관리자 사용 설명서\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e62\",\n      pageTitle: \"사용자 사용 설명서\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e63\",\n      pageTitle: \"사용자 이용 문의 방법\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e64\",\n      pageTitle: \"감사합니다.\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e65\",\n      pageTitle: \"test5\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e61\",\n      pageTitle: \"관리자 사용 설명서\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e62\",\n      pageTitle: \"사용자 사용 설명서\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e63\",\n      pageTitle: \"사용자 이용 문의 방법\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e64\",\n      pageTitle: \"감사합니다.\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e65\",\n      pageTitle: \"test5\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e61\",\n      pageTitle: \"관리자 사용 설명서\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e62\",\n      pageTitle: \"사용자 사용 설명서\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e63\",\n      pageTitle: \"사용자 이용 문의 방법\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e64\",\n      pageTitle: \"감사합니다.\"\n    },\n    {\n      pageId: \"d5cc2725-97ec-494b-bc80-c16f96379e65\",\n      pageTitle: \"test5\"\n    }\n  ]\n};\n\nexport default function page(state: PageState = initialState, action: PageActions) {\n\n  switch(action.type) {\n    case CHANGE_TOGGLE:\n      return Object.assign({}, state, {\n        toggle: action.payload.toggle !== undefined? action.payload : !state.toggle\n      });\n\n    case CHANGE_PAGE_TITLE:\n      const { title, pageId } = action.payload;\n\n      return Object.assign({}, state, {\n        pageList: state.pageList.map(page => {\n          if(page.pageId === pageId) {\n            return Object.assign({}, page, {\n              pageTitle: title\n            });\n          } else {\n            return page\n          }\n        })\n      });\n\n    default: \n      return state;\n  }\n\n}","import { useCallback } from 'react';\nimport { changePageTitle, changeToggle } from '../store/modules/page';\nimport { PageState } from '../store/modules/page/utils';\nimport { RootState } from '../store/modules';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { UserProfile } from '../store/modules/auth/utils';\n\nfunction usePage() {\n  const state: PageState = useSelector((state: RootState) => state.page);\n\n  const pageEditor: UserProfile = state.pageEditor;\n\n  const pageToggle: boolean = state.toggle;\n\n  const dispatch = useDispatch();\n\n  const onChangeToggle = useCallback((toggle?: boolean)=> \n    dispatch(changeToggle(toggle)),[dispatch]);\n\n  const onChangePageTitle = useCallback((pageId: string, title: string) => \n    dispatch(changePageTitle(pageId, title)), [dispatch]);\n\n  return {\n    pageState: state,\n    pageEditor,\n    pageToggle,\n    onChangeToggle,\n    onChangePageTitle\n  }\n}\n\nexport default usePage;","import { UserProfile } from \"../../auth/utils\";\n\nexport const CHANGE_PAGE_TITLE = \"page/CHANGE_PAGE_TITLE\" as const;\nexport const CHANGE_TOGGLE = \"page/CHANGE_TOGGLE\" as const;    \n\nexport interface Page {\n  pageId: string;\n  pageTitle: string;\n}\n\n\nexport interface PageState {\n  toggle: boolean;\n  loading: boolean;\n  pageEditor: UserProfile;\n  pageList: Page[];\n}\n\n","import React, { useEffect } from 'react';\nimport { Route, Switch, Redirect } from 'react-router-dom';\nimport SignIn from '../components/auth/sign-in';\nimport SignUp from '../components/auth/sign-up';\nimport useAuth from '../hooks/useAuth';\nimport usePage from '../hooks/usePage';\n\n\n\n\nfunction AuthPage() {\n  const { authState: { user } } = useAuth();\n  const { onChangeToggle } = usePage();\n\n  useEffect(() => {\n    if(user) {\n      onChangeToggle(true);\n    }\n    \n  },[user]);\n\n  if(user) {\n    return <Redirect to={`/bklog/${user.penName}`} />\n  }\n\n  return (\n    <div className=\"auth-page w-full h-full items-center p-4 rounded overflow-hidden\">\n      <Switch>\n        <Route path=\"/auth/sign-up\">\n          <SignUp />\n        </Route>\n        <Route path=\"/auth/sign-in\">\n          <SignIn />\n        </Route>\n      </Switch>\n    </div>\n  )\n}\n\nexport default AuthPage;","import { BaseState, changeDarkMode } from \"../store/modules/base/utils\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { RootState } from \"../store/modules\";\nimport { useCallback } from \"react\";\n\nfunction useBase() {\n  const state: BaseState = useSelector((state: RootState) => state.base);\n\n  const dispatch = useDispatch();\n\n  const onChangeMode = useCallback(()=> dispatch(changeDarkMode()), [dispatch]);;\n\n  return {\n    baseState: state,\n    onChangeMode\n  }\n}\n\nexport default useBase;","export const CHANGE_DARK_MODE = \"base/CHANGE_DARK_MODE\" as const;\nexport const SERVER_DISCONNECTED = \"base/SERVER_DISCONNECTED\" as const;\n\nexport const changeDarkMode = () => {\n  return {\n    type: CHANGE_DARK_MODE\n  }\n}\n\nconst disconnectedSever = (error: any) => {\n  return {\n    type: SERVER_DISCONNECTED,\n    payload: {\n      error\n    }\n  }\n}\n\nexport type BaseActions = ReturnType<typeof changeDarkMode> | \n            ReturnType<typeof disconnectedSever>;\n\nexport interface BaseState {\n  dark: boolean;\n  error: any;\n}","import React, { useEffect } from 'react';\nimport { Link } from 'react-router-dom';\n\nfunction Home(props: any) {\n\n\n  // useEffect(()=> {\n  //   console.log(props.cookies);\n  //   setCookie('cert', \"dsad\", { path: '/'});\n  // }, [props.cookies])\n\n  return (\n    <div className=\"home\">\n      <Link to=\"/bklog\">\n        bklog 이동\n      </Link>\n\n    </div>\n  )\n}\n\nexport default Home;","import { ADD_PUSH_MODIFY_DATA, CHANGE_UPDATE_STATE, ClearBklogStateType, CLEAR_BKLOG_STATE, GET_PAGE, GET_PAGE_ERROR, GET_PAGE_SUCCESS, PageModifyDateType, ReqUpdateBklog, RESET_BKLOG, ResGetPage, UPDATE_BKLOG, UPDATE_BKLOG_ERROR, UPDATE_BKLOG_SUCCESS, UPDATE_VERSION, UPDATE_VERSION_ERROR, UPDATE_VERSION_SUCCESS } from \".\";\nimport { ModifyDataType } from \"../../../../components/newBlock/types\";\nimport { ApiErrorType } from \"../../../../utils/api-utils\";\n\nfunction resetBklog() {\n  return {\n    type: RESET_BKLOG\n  };\n}\n\nfunction clearBklogState(key: ClearBklogStateType) {\n  return {\n    type: CLEAR_BKLOG_STATE,\n    payload: key\n  };\n}\n\nfunction getPage(pageId: string) {\n  return {\n    type: GET_PAGE,\n    payload: pageId\n  };\n}\n\nfunction getPageSuccess(data: ResGetPage) {\n  return {\n    type: GET_PAGE_SUCCESS,\n    payload: data\n  };\n}\n\nfunction getPageError(error: ApiErrorType) {\n  return {\n    type: GET_PAGE_ERROR,\n    payload: error\n  };\n}\n\nfunction addPushModifyData(modifyData: ModifyDataType) {\n  return {\n    type: ADD_PUSH_MODIFY_DATA,\n    payload: modifyData\n  };\n}\n\nfunction updateBklog(reqData: ReqUpdateBklog) {\n  return {\n    type: UPDATE_BKLOG,\n    payload: reqData\n  }\n}\n\nfunction updateBklogSuccess(payload: { pageVersion: string }) {\n  return {\n    type: UPDATE_BKLOG_SUCCESS,\n    payload\n  }\n}\n\nfunction updateBklogError(error: ApiErrorType) {\n  return {\n    type: UPDATE_BKLOG_ERROR,\n    payload: error\n  }\n}\n\nfunction updateVersion(id: string, preId: string) {\n  return {\n    type: UPDATE_VERSION,\n    payload: {\n      id,\n      preId\n    }\n  };\n}\n\nfunction updateVersionSuccess(data: {id: string, data: PageModifyDateType}) {\n  return {\n    type: UPDATE_VERSION_SUCCESS,\n    payload: data\n  };\n}\n\nfunction updateVersionError(error: ApiErrorType) {\n  return {\n    type: UPDATE_VERSION_ERROR,\n    payload: error\n  };\n}\n\nfunction changeUpdateState(isUpdate?: boolean) {\n  return  {\n    type: CHANGE_UPDATE_STATE,\n    payload: isUpdate\n  };\n}\n\nexport default {\n  resetBklog,\n  clearBklogState,\n  getPage,\n  getPageSuccess,\n  getPageError,\n  addPushModifyData,\n  updateBklog,\n  updateBklogSuccess,\n  updateBklogError,\n  updateVersion,\n  updateVersionSuccess,\n  updateVersionError,\n  changeUpdateState\n};","import { BaseRestFetch } from \"../../../../utils/api-utils\";\n\nfunction bklogFetchGet(url: string, query?: any) {\n  return BaseRestFetch.restApi({\n    method: \"get\",\n    url: `bklog/${url}`,\n    withCredentials: true,\n    qs: query\n  });\n}\n\nfunction bklogFetchPost(url: string, data: object) {\n  return BaseRestFetch.restApi({\n    method: \"post\",\n    url: `bklog/${url}`,\n    withCredentials: true,\n    data\n  });\n}\n\nexport default { bklogFetchGet, bklogFetchPost };","import { RawBlockData, ModifyDataType } from \"../../../../components/newBlock/types\";\nimport { ApiErrorType } from \"../../../../utils/api-utils\";\nimport actions from \"./actions\";\nimport apiUtils from \"./apiUtils\";\n\nexport interface PageInfoType {\n  createdDate: Date;\n  updatedDate: Date;\n  id: string;\n  title: string;\n  coverImage: string;\n  coverColor: string;\n  lastAccessDate: Date;\n  views: number;\n  disclosureScope: number;\n  profileId: string;\n  editable: boolean;\n}\n\nexport interface PageInfoProps {\n  createdDate?: Date;\n  updatedDate?: Date;\n  id?: string;\n  title?: string;\n  coverImage?: string;\n  coverColor?: string;\n  lastAccessDate?: Date;\n  views?: number;\n  disclosureScope?: number;\n  profileId?: string;\n  editable?: boolean;\n}\n\ninterface Comments {\n  id: string;\n  profileId: string;\n  comments: any;\n  penName: string;\n  photo: string;\n}\n\nexport interface PageCommentsType extends Comments {}\n\nexport interface BlockCommentsType extends Comments {\n  blockId: string;\n}\n\nexport interface PageStarType {\n  selected: boolean;\n  count: number;\n}\n\nexport interface PageModifyDateType {\n  pageInfo?: {\n    createdDate?: Date;\n    updatedDate?: Date;\n    id?: string;\n    title?: string;\n    coverImage?: string;\n    coverColor?: string;\n    lastAccessDate?: Date;\n    views?: number;\n    disclosureScope?: number;\n    version?: string;\n    profileId?: string;\n    editable?: boolean;\n  };\n  modifyData?: ModifyDataType;\n}\n\nexport interface EditingUserInfo {\n  penName: string;\n  editingId: string | null;\n}\n\nexport interface BklogState {\n  isLoading: boolean;\n  isFetching: boolean; \n  isRefresh: boolean;\n  isUpdated: boolean;\n  pageInfo: PageInfoType | null;\n  version: string | null;\n  pageStar: PageStarType | null;\n  pageComments: PageCommentsType[] | null;\n  blockList: RawBlockData[] | null;\n  blockComments: BlockCommentsType[] | null; \n  pushModifyData: ModifyDataType | null;\n  pullModifyData: ModifyDataType | null;\n  editingUserList: EditingUserInfo[] | null;\n  error: ApiErrorType | null;\n}\n\nexport interface BklogStateProps {\n  isLoading?: boolean;\n  isFetching?: boolean;\n  isRefresh?: boolean;\n  isUpdated?: boolean;\n  pageInfo?: PageInfoType | null;\n  version?: string | null;\n  pageStar?: PageStarType | null;\n  pageComments?: PageCommentsType[] | null;\n  blockList?: RawBlockData[] | null;\n  blockComments?: BlockCommentsType[] | null; \n  pushModifyData?: ModifyDataType | null;\n  pullModifyData?: ModifyDataType | null;\n  editingUserList?: EditingUserInfo[] | null;\n  error?: ApiErrorType | null;\n}\n\n// request type\nexport interface ReqUpdateBklog {\n  pageId: string;\n  pageVersions: {\n    current: string;\n    next: string;\n  };\n  data: ModifyDataType;\n}\n\n// response type\nexport interface ResGetPage {\n  pageInfo: PageInfoType;\n  blockList: RawBlockData[];\n  version: string;\n}\n\nexport type ClearBklogStateType = \"pageInfo\" \n  | \"blockList\"\n  | \"version\"\n  | \"pageStar\"\n  | \"pageComments\"\n  | \"blockComments\"\n  | \"pushModifyData\"\n  | \"pullModifyData\"\n  | \"error\"\n\n// actions\nexport const RESET_BKLOG            = 'bklog/RESET_BKLOG' as const;\nexport const BKLOG_ERROR            = 'bklog/BKLOG_ERROR' as const;\nexport const CLEAR_BKLOG_STATE      = 'bklog/CLEAR_BKLOG_STATE' as const;\nexport const GET_PAGE               = 'bklog/GET_PAGE' as const;\nexport const GET_PAGE_SUCCESS       = 'bklog/GET_PAGE_SUCCESS' as const;\nexport const GET_PAGE_ERROR         = 'bklog/GET_PAGE_ERROR' as const;\nexport const ADD_PUSH_MODIFY_DATA   = 'bklog/ADD_PUSH_MODIFY_DATA' as const;\nexport const UPDATE_BKLOG           = 'bklog/UPDATE_BKLOG' as const;\nexport const UPDATE_BKLOG_SUCCESS   = 'bklog/UPDATE_BKLOG_SUCCESS' as const;\nexport const UPDATE_BKLOG_ERROR     = 'bklog/UPDATE_BKLOG_ERROR' as const;\nexport const UPDATE_VERSION         = 'bklog/UPDATE_VERSION' as const;\nexport const UPDATE_VERSION_SUCCESS = 'bklog/UPDATE_VERSION_SUCCESS' as const;\nexport const UPDATE_VERSION_ERROR   = 'bklog/UPDATE_VERSION_ERROR' as const;\nexport const CLEAR_MODIFY_DATA      = 'bklog/CLEAR_MODIFY_DATA' as const;\nexport const CHANGE_UPDATE_STATE    = 'bklog/CHANGE_UPDATE_STATE' as const;\n\nexport const resetBklog           = actions.resetBklog;\nexport const clearBklogState      = actions.clearBklogState;\nexport const getPage              = actions.getPage;\nexport const getPageSuccess       = actions.getPageSuccess;\nexport const getPageError         = actions.getPageError;\nexport const addPushModifyData    = actions.addPushModifyData;\nexport const updateBklog          = actions.updateBklog;\nexport const updateBklogSuccess   = actions.updateBklogSuccess;\nexport const updateBklogError     = actions.updateBklogError;\nexport const updateVersion        = actions.updateVersion;\nexport const updateVersionSuccess = actions.updateVersionSuccess;\nexport const updateVersionError   = actions.updateVersionError;\nexport const changeUpdateState    = actions.changeUpdateState;\n\n// api\nexport const bklogFetchGet  = apiUtils.bklogFetchGet;\nexport const bklogFetchPost = apiUtils.bklogFetchPost;","import { call, put } from 'redux-saga/effects'; \nimport { REISSUETOKEN, reissueToken, SIGNINUSER_ERROR, RESET_AUTH } from '../modules/auth/utils';\nimport { ResType } from '../../utils/api-utils';\nimport { ApiError } from '../../utils/api-utils';\nimport { RESET_BKLOG } from '../modules/bklog/utils';\nimport { createAction } from '.';\nimport { createReducer } from 'typesafe-actions';\n\n// function createPromiseSaga2(type: string, promiseCreator: any) {\n//   const [SUCCESS, ERROR] = [`${type}_SUCCESS`, `${type}_ERROR`];\n//   return function* saga(action: any) {\n//     try {\n//       console.log(\"action\", action);\n//       const response = yield call(promiseCreator, action.payload);\n\n//       const payload = response.data? response.data : null;\n//       const success = response.data? response.data.success : false;\n//       const error = response.data? \n//         response.data.error? \n//         response.data.error \n//         : null \n//         : response.error;\n\n//       if(payload) {\n//         payload.success = undefined;\n//       }\n//       console.log(response, payload);\n      \n//       if(success) {\n//         console.log(\"success\");\n//         yield put({ type: SUCCESS, payload });\n//       } else {\n\n//         if(error.accessTokken) {\n//           console.log(action);\n//           yield put({ type: REISSUETOKEN, payload: action });\n//         } else {\n//           if(payload) {\n//             console.log(\"false\");\n//             yield put({ type: ERROR, payload });\n//           } else {\n//             yield put({ type: ERROR, payload: { error }});\n//           }\n          \n//         }\n  \n//       }\n//     } catch(e) {\n//       console.log(e);\n//       yield put({ type: ERROR, payload: {\n//         error: e\n//       }})\n//     }\n//   }\n// }\n\nfunction createPromiseSaga<T = any>(\n  type: string, \n  promiseCreator: any, \n  errorType?: string, \n  successType?: string\n) {\n  const [ SUCCESS, ERROR ] = [successType?  successType: `${type}_SUCCESS`, errorType? errorType: `${type}_ERROR`];\n\n  return function* (action: any) {\n    try {\n      const data: T = yield call<any>(promiseCreator, action.payload);\n\n      yield put({ type: SUCCESS, payload: data });\n    } catch(error) {\n      if(error.type === \"AUTH\" && error.code === \"001\") {\n        yield put({ type: REISSUETOKEN, payload: action });\n      } else {\n        console.log(\"error\", ERROR, error, new ApiError(error).get);\n        yield put({ type: ERROR, payload: new ApiError(error).get });\n      }\n    }\n  } \n}  \n\n// function asyncActions<ReqData = any, ResData = any, Error = any>(actionType: string) {\n//   const SUCCESS = `${actionType}_SUCCESS`;\n//   const ERROR   = `${actionType}_ERROR`;\n\n//   return [\n//     createAction<ReqData, typeof actionType>(actionType),\n//     createAction<ResData, typeof SUCCESS>(SUCCESS),\n//     createAction<Error, typeof ERROR>(ERROR)\n//   ];\n// }\n\nfunction* allResetSaga(action: any) {\n  yield put({ type: RESET_AUTH });\n  yield put({ type: RESET_BKLOG });\n}\n\nconst acyncUtils = {\n  createPromiseSaga,\n  allResetSaga\n}\n\nexport default acyncUtils;","import { Action, ActionHandlers} from '.';\n\nconst settingsReducer = {\n  initial: (initialData = null) => ({\n    loading: false,\n    data: initialData,\n    error: null\n  }),\n  loading: (prevState = null) => ({\n    loading: true,\n    data: prevState,\n    error: null\n  }),\n  success: (payload: any) => ({\n    loading: false,\n    data: payload,\n    error: null\n  }),\n  error: (error: any) => ({\n    loading: false,\n    data: null,\n    error: error\n  })\n}\n\nfunction handleAsyncActions (type: any, key: any, keepData: boolean = false) {\n  const [SUCCESS, ERROR] = [`${type}_SUCCESS`, `${type}_ERROR`];\n  return (state: any, action: any) => {\n    switch (action.type) {\n      case type:\n        return {\n          ...state,\n          [key]: settingsReducer.loading(keepData ? state[key].data : null)\n        };\n      case SUCCESS:\n        return {\n          ...state,\n          [key]: settingsReducer.success(action.payload)\n        };\n      case ERROR:\n        return {\n          ...state,\n          [key]: settingsReducer.error(action.payload)\n        };\n      default:\n        return state;\n    }\n  };\n}\n\nfunction updateObject<T = any, P = any>(oldObject: T, newValues: P): T {\n  return Object.assign({}, oldObject, newValues);\n};\n\n// function createReducer<P extends string, State, T extends ActionsCreators<P>>(\n//   handlers: ActionHandlers<P, T, State>,\n//   initialState: State\n// ) {\n//   return (state: State = initialState, action: ActionsUnion<P, T>): State => {\n\n//       if (handlers.hasOwnProperty(action.type)) {\n//         return handlers[action.type](state, action);\n//       }\n\n//       return state;\n//   }\n// }\n\ntype TypeConstant = string;\n\ntype AAction<TType extends TypeConstant = TypeConstant> = {\n  type: TType;\n};\n\nfunction createAction<T = any, TType extends TypeConstant = TypeConstant>(type: TType) {\n  return function(payload: T) {\n    return {\n      type,\n      payload\n    };\n  }\n}\n\n\nfunction createReducer<State, T extends Action>(\n  initialState: State,\n  handlers: ActionHandlers<State>,\n) {\n  return (state: State = initialState, action: T): State => {\n\n      if (handlers.hasOwnProperty(action.type as string)) {\n        return handlers[action.type as string](state, action);\n      }\n\n      return state;\n  }\n}\n\nconst reducerUtils = {\n  updateObject,\n  createReducer,\n  createAction\n}\n\nexport default reducerUtils;","import acyncUtils from './acyncUtils';\nimport reducerUtils from './reducerUtils';\n\n// create reducer type\n// export interface Action<T extends string> {\n//   type: T;\n// }\n\n// export type ActionCreator<T extends string> = (...args: any) => Action<T>;\n\n// export type ActionsCreators<T extends string> = {\n//   [creator: string]: ActionCreator<T>;\n// }\n\n// export type ActionsUnion<P extends string, T extends ActionsCreators<P>> = ReturnType<T[keyof T]>;\n\n// export type ActionHandlers<P extends string, T extends ActionsCreators<P>, State> = {\n//   [K in ReturnType<T[keyof T]>[\"type\"]]: (\n//       state: State,\n//       action: ReturnType<T[K]>\n//   ) => State\n// }\n\nexport type Action = {\n  type: string;\n}\n\nexport type ActionHandlers<T> = {\n  [P: string]: (state: T, action: any) => T;\n}\n\n// reducer utils;\nexport const updateObject  = reducerUtils.updateObject;\nexport const createReducer = reducerUtils.createReducer;\nexport const createAction  = reducerUtils.createAction;\n\n\nexport const ALL_RESET = \"common/ALL_RESET\" as const; \n\n// asyncUtils\nexport const createPromiseSaga = acyncUtils.createPromiseSaga;\nexport const allResetSaga      = acyncUtils.allResetSaga;","import { \n  OrderType, \n  ChangeEditorStateProps,\n  RESET_BLOCK, \n  ADD_BLOCK, \n  COMMIT_BLOCK, \n  DELETE_BLOCK, \n  UPDATE_BLOCK, \n  CHANGE_TEXT_STYLE, \n  REVERT_BLOCK, \n  SWITCH_BLOCK, \n  SET_CLIPBOARD,\n  CLEAR_CLIPBOARD,\n  CLEAR_TEMPCLIP,\n  SET_TEMPCLIP,\n  TEST_CLIPBOARD,\n  EDIT_BLOCK,\n  CHANGE_EDITING_ID,\n  CHANGE_EDITOR_STATE,\n  CHANGE_TARGET_POSITION,\n  EDITOR_STATE_RESET,\n  CHANGE_FETCH_STATE,\n  CHANGE_STYLE_TYPE,\n  CLEAR_MODIFYDATA,\n  INIT_BLOCK_STATE,\n  CHANGE_BLOCK_CONTENTS,\n  DELETE_TEXT_BLOCK,\n  CLEAR_NEXTBLOCKINFO,\n  NextBlockInfo,\n  SET_NEXTBLOCKINFO,\n  ADD_TEXT_BLOCK\n} from \".\";\nimport { UUID, BlockData, ContentType, RawBlockData, ModifyBlockData, ModifyDataType } from \"../../types\";\n\nfunction initBlockState(rawBlockData: RawBlockData[]) {\n  return {\n    type: INIT_BLOCK_STATE,\n    payload: rawBlockData\n  };\n}\n\nfunction resetBlock() {\n  return {\n    type: RESET_BLOCK\n  }\n}\n\nfunction addBlock(addBlockList: BlockData[], targetPosition: string, nextEditInfo?: string | number) {\n  return {\n    type: ADD_BLOCK,\n    payload: {\n      addBlockList,\n      targetPosition,\n      nextEditInfo\n    }\n  }\n}\n\nfunction addTextBlock(\n  index: number, \n  innerHTML: string,\n  cursorStart: number,\n  cursorEnd: number\n) {\n  return {\n    type: ADD_TEXT_BLOCK,\n    payload: {\n      index,\n      innerHTML,\n      cursorStart,\n      cursorEnd\n    }\n  }\n}\n\nfunction changeEditingId(nextEditInfo?: string | number) {\n  return {\n    type: CHANGE_EDITING_ID,\n    payload: nextEditInfo\n  }\n}\n\nfunction editBlock(blockId: string, blockIndex: number, contents: string) {\n  return {\n    type: EDIT_BLOCK,\n    payload: {\n      blockId,\n      blockIndex,\n      contents\n    }\n  }\n}\n\nfunction commitBlock() {\n  return {\n    type: COMMIT_BLOCK\n  }\n}\n\nfunction changeBlockContents(index: number, contents: any) {\n  return {\n    type: CHANGE_BLOCK_CONTENTS,\n    payload: {\n      index,\n      contents\n    }\n  };\n}\n\nfunction deleteBlock(removedBlockList: BlockData[], nextEditInfo?: string | number) {\n  return {\n    type: DELETE_BLOCK,\n    payload: {\n      removedBlockList,\n      nextEditInfo\n    }\n  }\n}\n\nfunction deleteTextBlock(index: number, innerHTML: string, textLength: number) {\n  return {\n    type: DELETE_TEXT_BLOCK,\n    payload: {\n      index,\n      innerHTML,\n      textLength\n    }\n  };\n}\n\nfunction updateBlock(modifyData: ModifyDataType) {\n  return {\n    type: UPDATE_BLOCK,\n    payload: modifyData\n  }\n}\n\nfunction changeTextStyle(\n  index: number, \n  styleType: ContentType, \n  startPoint: number,\n  endPoint: number,\n  order: OrderType\n  ) {\n  return {\n    type: CHANGE_TEXT_STYLE,\n    payload: {\n      index,\n      styleType,\n      startPoint,\n      endPoint,\n      order\n    }\n  }\n}\n\nfunction revertBlock(front?: boolean) {\n  return {\n    type: REVERT_BLOCK,\n    front\n  }\n}\n\nfunction switchBlock(changedBlockIdList: string[], container?: boolean) {\n  return {\n    type: SWITCH_BLOCK,\n    payload: {\n      changedBlockIdList,\n      container: container? true : false\n    }\n  }\n}\n\nfunction setClipboard() {\n  return {\n    type: SET_CLIPBOARD\n  }\n}\n\nfunction clearClipboard() {\n  return {\n    type: CLEAR_CLIPBOARD\n  }\n}\n\nfunction setTempClip(index: number[]) {\n  return  {\n    type: SET_TEMPCLIP,\n    payload: index\n  }\n}\n\nfunction clearTempClip() {\n  return {\n    type: CLEAR_TEMPCLIP\n  }\n}\n\nfunction chageEditorState(payload: ChangeEditorStateProps) {\n  return {\n    type: CHANGE_EDITOR_STATE,\n    payload\n  }\n}\n\nfunction changeTargetPosition(targetPosition?: string) {\n  return {\n    type: CHANGE_TARGET_POSITION,\n    payload: {\n      targetPosition\n    }\n  }\n}\n\nfunction testClipAdd(payload: any) {\n  return {\n    type: TEST_CLIPBOARD,\n    payload\n  }\n}\n\nfunction resetEditorState(cliping: boolean) {\n  return {\n    type: EDITOR_STATE_RESET,\n    payload: cliping\n  }\n}\n\nfunction changeFetchState(fetch?: boolean) {\n  return {\n    type: CHANGE_FETCH_STATE,\n    payload: fetch\n  }\n}\n\nfunction changeStyleType(blockInfo: string | number, styleType: string) {\n  return {\n    type: CHANGE_STYLE_TYPE,\n    payload: {\n      blockInfo,\n      styleType\n    }\n  }\n}\n\nfunction clearModifyData() {\n  return {\n    type: CLEAR_MODIFYDATA\n  };\n}\n\nfunction clearNextBlockInfo() {\n  return {\n    type: CLEAR_NEXTBLOCKINFO\n  };\n}\n\nfunction setNextBlockInfo(nextBlockInfo: NextBlockInfo) {\n  return {\n    type: SET_NEXTBLOCKINFO,\n    payload: nextBlockInfo\n  };\n}\n\nconst actionBlock = {\n  initBlockState,\n  resetBlock,\n  addBlock,\n  addTextBlock,\n  changeEditingId,\n  editBlock,\n  commitBlock,\n  changeBlockContents,\n  deleteBlock,\n  deleteTextBlock,\n  updateBlock,\n  changeTextStyle,\n  revertBlock,\n  switchBlock,\n  setClipboard,\n  clearClipboard,\n  setTempClip,\n  clearTempClip,\n  chageEditorState,\n  changeTargetPosition,\n  testClipAdd,\n  resetEditorState,\n  changeFetchState,\n  changeStyleType,\n  clearModifyData,\n  clearNextBlockInfo,\n  setNextBlockInfo\n}\n\nexport default actionBlock;","import { v4 as uuidv4 } from 'uuid';\n\nexport class Token {\n  static getUUID(): string{\n    const token: string[] = uuidv4().split('-');\n    const uuid: string = token[2] + token[1] + token[0] + token[3] + token[4];\n    return uuid;\n  }\n}","import { BlockData, ContentType, ModifyBlockData, ModifyDataType, ModifyCommand, ModifyData, ModifySet, TextContents } from '../../types';\nimport { StagedBlock, sortBlock, setCreateModifyDataOfBlock, setUpdateModifyDataOfBlock, TempDataType, TempSet, TempData, setDeleteModifyDataOfBlock, orderingBlock, createTempData, OrderType, parseHtmlContents, changeStyleTextContents, ResBlockUtils, mergeTextContents, createModifyData } from '.';\nimport { Token } from '../../utils/token';\nimport { updateObject } from '../../../../store/utils';\nimport { BlockProps } from '../../components/Block';\n\nfunction copyToNewObjectArray<T = any>(array: T[]): T[] {\n  return array.map((object: T) => Object.assign({}, object));\n}\n\ninterface BlockDataProps {\n  position: string;\n  type?: string;\n  styleType?: string;\n  parentId?: string;\n  styles?: any;\n  contents?: TextContents[]\n}\n\nfunction createBlockData({ \n  position,\n  type,\n  styleType,\n  styles,\n  parentId,\n  contents\n}: BlockDataProps): BlockData {\n  return  {\n    index: 0,\n    position,\n    id: Token.getUUID(),\n    type: type? type : \"text\",\n    styleType: styleType? styleType : \"bk-p\",\n    parentId: parentId? parentId : \"null\",\n    contents: contents? contents : [],\n    styles: styles? styles : {}\n  };\n}\n\nfunction blockFindInfex(id: string) {\n  return (block: BlockData) => block.id === id; \n}\n\nfunction setPosition(prePosition: string, targetPosition: string = \"0\"): string {\n  const positionLength = prePosition.split(/-/).length - 1;\n  if(!positionLength) {\n    return targetPosition;\n  } else {\n    let newPosition = targetPosition;\n    for(let i = 0; i < positionLength - 1; i++) {\n      newPosition = `${targetPosition}-${newPosition}`;\n    }\n    return newPosition;\n  }\n}\n\n/**\n * \n * @param blockDataList \n */\nfunction reissueBlockId(blockDataList: BlockData[]) {\n  return blockDataList.map(block => Object.assign({}, block, {\n    id: Token.getUUID()\n  }));\n}\n\n/**\n * @param blockDataList \n * @param targetPosition \n */\nfunction resetToTargetPosition(blockDataList: BlockData[], targetPosition: string) {\n  const preBlockDataList: BlockData[] = blockDataList.concat();\n  const newBlockDataList: BlockData[] = [];\n  const targetPositionArg = targetPosition.split(/-/);\n\n  let preBlockListLength = preBlockDataList.length - 1;\n  let stack: [number, string][] = [];\n  let stackLength = 0;\n  let currentPosition = targetPositionArg.concat();\n\n  let block = preBlockDataList.shift();\n\n  if(!block) {\n    console.error(\"resetToTargetPosition: not block\");\n    return [];\n  }\n\n  newBlockDataList.push(Object.assign({}, block, {\n    position: currentPosition.join(\"-\")\n  }));\n\n  stack.push([block.position.split(/-/).length, block.id]);\n\n\n  while(preBlockListLength) {\n    block = preBlockDataList.shift();\n\n    if(!block) {\n      console.error(\"resetToTargetPosition: not block\");\n      return [];\n    }\n\n    const positionLength = block.position.split(/-/).length;\n    const blockStact: [number, string] = [positionLength, block.id];\n\n    if(stack[stackLength][0] < positionLength && stack[stackLength][1] === block.parentId) {\n      currentPosition.push(\"1\");\n      stack.push(blockStact);\n      stackLength++;\n\n    } else if(stack[stackLength][0] === positionLength && stack[stackLength - 1] && stack[stackLength - 1][1] === block.parentId) {\n      stack[stackLength] = blockStact;\n\n    } else {\n\n      if(stack[stackLength - 2] && stack[stackLength - 2][1] === block.parentId) {\n        currentPosition.pop();\n        stack.pop();\n        stackLength--;\n\n      } else {\n        currentPosition = targetPositionArg.concat();\n        stack = [blockStact];\n        stackLength = 0;\n      }\n\n    }\n\n    newBlockDataList.push(Object.assign({}, block, {\n      position: currentPosition.join(\"-\")\n    }));\n\n    preBlockListLength--;\n  }\n\n  return newBlockDataList;\n}\n\n/**\n * \n * @param stage \n * @param id \n * @param blockIndex \n * @param contents \n */\nfunction addToStage(\n  stage: StagedBlock[], \n  id: string, \n  blockIndex: number, \n  contents: string\n): StagedBlock[] {\n  const preStagedBlockList = stage.filter(stagedBlock => stagedBlock.id !== id);\n\n  const newStagedBlock = {\n    id,\n    blockIndex,\n    contents\n  }\n  return preStagedBlockList[0]? [...preStagedBlockList, newStagedBlock] : [newStagedBlock];\n}\n\n/**\n * \n * @param blockDataList \n * @param stage \n */\nfunction updateBlockContents(blockDataList: BlockData[], stage: StagedBlock[]) {\n  const blocks = blockDataList.concat();\n  const tempData: TempDataType = { update: [] };\n  const modifyData: ModifyData[] = [];\n\n  for(const { blockIndex, id, contents } of stage) {\n    if(blocks[blockIndex] && id === blocks[blockIndex].id) {\n\n      if(blocks[blockIndex].type === \"text\" || blocks[blockIndex].type === \"title\") {\n        const preContents = typeof blocks[blockIndex].contents === \"string\"?\n        blocks[blockIndex].contents : blocks[blockIndex].contents.concat();\n\n        tempData.update?.push(createTempData(blocks[blockIndex].id, {\n          contents: preContents\n        }));\n\n        blocks[blockIndex].contents = typeof contents === \"string\"?\n          parseHtmlContents(contents) : contents;\n\n        modifyData.push(setUpdateModifyDataOfBlock(blocks[blockIndex].id, {\n          contents: blocks[blockIndex].contents\n        }));\n      }\n\n    } else {\n      console.log(\"block이 제대로 정렬되지 않았습니다.\");\n    }\n  } \n\n  return {\n    blockList: blocks,\n    modifyData,\n    tempData\n  }\n}\n\nfunction changeBlockStyleType(\n  blockDataList: BlockData[], \n  blockInfo: string | number, \n  styleType: string\n): ResBlockUtils | null {\n  const blockIndex = typeof blockInfo === \"number\"? \n    blockInfo \n    : blockDataList.findIndex(blockFindInfex(blockInfo)); \n\n  if(!blockDataList[blockIndex]) return null;\n  \n  const blocks = blockDataList.concat();\n  const tempData: TempDataType = { update: [] };\n  const modifyData: ModifyData[] = [];\n\n  tempData.update?.push({\n    blockId: blocks[blockIndex].id,\n    payload: {\n      styleType: blocks[blockIndex].styleType\n    }\n  });\n\n  blocks[blockIndex].styleType = styleType;\n\n  modifyData.push(setUpdateModifyDataOfBlock(blocks[blockIndex].id, {\n    styleType\n  }));\n\n  return {\n    blockList: blocks,\n    tempData,\n    modifyData\n  }\n}\n\n/**\n * \n * @param blocks \n * @param index \n * @param styleType \n * @param startPoint \n * @param endPoint \n * @param order \n */\nfunction changeBlockTextStyle(\n  blocks: BlockData[], \n  index: number, \n  styleType: ContentType,\n  startPoint: number,\n  endPoint: number,\n  order: OrderType\n): ResBlockUtils | null {\n  const tempData: TempDataType = { update: [] };\n  const modifyData: ModifyData[] = [];\n  const blockList = blocks.concat();\n\n  if(blockList[index].type !== \"text\" && blockList[index].type !== \"title\") {\n    console.log(\"text block이 아닙니다.\");\n    return null;\n  }\n  const contents = typeof blockList[index].contents === \"string\"?\n    blockList[index].contents\n    : blockList[index].contents.concat();\n\n  tempData.update?.push(createTempData<ModifyBlockData>(blockList[index].id, {\n    contents\n  }));\n\n  const changedBlock = changeStyleTextContents(\n    blockList[index], \n    styleType, \n    startPoint, \n    endPoint, \n    order\n  );\n\n  modifyData.push(setUpdateModifyDataOfBlock(changedBlock.id, {\n    contents: changedBlock.contents\n  }));\n\n  blockList[index] = changedBlock;\n\n  return {\n    blockList,\n    modifyData,\n    tempData\n  }\n}\n\n/**\n * \n * @param blockList\n * @param addBlockList\n * @param targetPosition\n * @param index \n */\nfunction addBlockInList(\n  blockList: BlockData[], \n  addBlockList: BlockData[],\n  targetPosition: string\n): ResBlockUtils {\n  const modifyData: ModifyData[] = [];\n  const tempData: TempDataType = {\n    delete: [],\n    update: []\n  };\n\n  const newBlockList = blockList.concat();\n  \n  const index = newBlockList.findIndex(block => block.position === targetPosition);\n\n  newBlockList.splice(\n    index, \n    1, \n    blockList[index], \n    ...resetToTargetPosition(addBlockList, targetPosition)\n  );\n\n  const result = orderingBlock(newBlockList);\n\n  modifyData.push(...addBlockList.map(block => \n    setCreateModifyDataOfBlock(block)\n  ), ...result.modifyData);\n\n  const idList: string[] = addBlockList.map(block => block.id);\n\n  tempData.delete?.push(...idList.map( id => \n    createTempData(id)\n  ));\n\n  if(result.tempData.update) {\n    const updateTempData = result.tempData.update.filter(data => \n      !idList.includes(data.blockId)\n    );\n    tempData.update?.push(...updateTempData);\n  }\n\n  return {\n    blockList: result.blockList,\n    tempData,\n    modifyData\n  }\n}\n\n/**\n * \n * @param blockList \n * @param removedBlockList \n */\nfunction removeBlockInList(\n  blockList: BlockData[], \n  targetBlockList: BlockData[]\n): ResBlockUtils {\n  const modifyData: ModifyData[] = [];\n  const tempData: TempDataType = {\n    create: [],\n    update: []\n  };\n  const blocks = blockList.concat();\n  const blockLength = blocks.length;\n  const removedBlockList = copyToNewObjectArray(targetBlockList);\n\n  tempData.create?.push(...removedBlockList.map(block => createTempData(block.id, Object.assign({}, block))));\n\n  let removedIdList = removedBlockList.map(block => block.id); \n\n  for(const block of removedBlockList) {\n    const position = block.position;\n\n    for(let i = block.index; i < blockLength; i++) {\n\n      if(i === block.index) {\n\n        modifyData.push(setDeleteModifyDataOfBlock(blocks[i].id));\n        blocks[i].position = \"null\";\n\n      } else if(blocks[i].position.indexOf(position) === 0) {\n        if(!removedIdList.includes(blocks[i].id)) {\n\n          const newPosition = blocks[i].position.split(/-/);\n          newPosition.pop();\n\n          const findIndex = tempData.update?.findIndex(data => data.blockId === blocks[i].id);\n          const tempDataBlock = createTempData<ModifyBlockData>(blocks[i].id, {\n            position: blocks[i].position\n          });\n\n          if(findIndex !== undefined && findIndex !== -1 && tempData.update) {\n            tempData.update[findIndex] = tempDataBlock;\n          } else {\n            tempData.update?.push(tempDataBlock);\n          }\n\n          blocks[i].position = newPosition.join(\"-\");  \n        }\n\n      } else {\n        break;\n      }\n\n    }\n\n  }\n\n  const result = orderingBlock(blocks.filter(block => block.position !== \"null\"));\n\n  if(result.tempData.update) {\n    if(tempData.update) {\n      const idList = tempData.update.map(data => data.blockId);\n\n      for(const data of result.tempData.update) {\n        if(!idList.includes(data.blockId)) {\n          tempData.update.push(data);\n        } \n      }\n\n    }\n  }\n  \n  if(result.modifyData[0]) {\n    modifyData.push(...result.modifyData);\n  }\n\n  return {\n    blockList: result.blockList,\n    modifyData,\n    tempData\n  }\n}\n\n/**\n * \n * @param preBlocks \n * @param index \n * @param preIndex \n * @param innerHTML \n */\nfunction removeTextBlockInList(preBlocks: BlockData[], index: number, preIndex, innerHTML: string): ResBlockUtils | null {\n  if(preBlocks[preIndex].type !== \"text\") return null;\n\n  const preBlockList = preBlocks.concat();\n  const contents: TextContents[] = parseHtmlContents(innerHTML);\n  const blockId = preBlockList[preIndex].id;\n  const preContents = preBlockList[preIndex].contents.concat();\n  const newContents = mergeTextContents(preBlockList[preIndex].contents, contents);\n\n  preBlockList[preIndex].contents = newContents;\n\n  const { blockList, tempData, modifyData } = removeBlockInList(preBlockList, [preBlockList[index]]);\n\n  const tempIndex = tempData.update.findIndex(data => data.blockId === blockId);\n  const modifyIndex = modifyData.findIndex(data => data.blockId === blockId);\n\n  if(tempIndex !== -1) {\n    tempData.update[tempIndex] = updateObject(tempData.update[tempIndex], {\n      contents: preContents\n    });\n  } else {\n    tempData.update.push(createTempData(blockId, {\n      contents: preContents\n    }));\n  }\n\n  if(modifyIndex !== -1) {\n    modifyData[modifyIndex] = updateObject(modifyData[modifyIndex], {\n      contents: newContents\n    });\n  } else {\n    modifyData.push(createModifyData(\"update\", \"block\", blockId, {\n      contents: newContents\n    }));\n  }\n  \n  return {\n    blockList,\n    tempData,\n    modifyData\n  }    \n}   \n\n/**\n * \n * @param blocks \n * @param idList \n */\nfunction divideBlock(blocks: BlockData[], idList: string[]) {\n  const removedBlockList: BlockData[] = [];\n  const targetBlockList: BlockData[] = [];\n\n  for(const block of blocks) {\n    if(idList.includes(block.id)) {\n      targetBlockList.push(Object.assign({}, block));\n    } else {\n      removedBlockList.push(Object.assign({}, block));\n    }\n  }\n\n  return [ removedBlockList, targetBlockList ];\n}\n\n/**\n * \n * @param blocks \n * @param idList \n * @param targetPosition \n */\nfunction changeBlockPosition(blocks: BlockData[], idList: string[], targetPosition: string): ResBlockUtils | null {\n  const [ removedBlockList, targetBlockList ] = divideBlock(blocks, idList);\n  const index = removedBlockList.findIndex(block => block.position === targetPosition) + 1;\n\n  if(index === 0) return null;\n\n  const containerBlockList = removedBlockList.filter((block => block.type === \"container\"));\n  const tempData: TempDataType = {\n    create: [],\n    update: []\n  };\n  const modifyData: ModifyData[] = [];\n\n  const setedPosition = setPosition(targetPosition, \"0\");\n\n  const newBlockList = copyToNewObjectArray(removedBlockList);\n  newBlockList.splice(index, 0, ...resetToTargetPosition(targetBlockList, setedPosition));\n\n  if(containerBlockList[0]) {\n    for(const block of containerBlockList) {\n      const idx = newBlockList.findIndex(({ id }) => id === block.id ) + 1;\n\n      if(!newBlockList[idx] || newBlockList[idx].position.indexOf(block.position) !== 0) {\n        newBlockList.splice(idx, 1);\n\n        //temp\n        tempData.create?.push(createTempData(block.id, Object.assign({}, block)));\n        //modify\n        modifyData.push(setDeleteModifyDataOfBlock(block.id));\n      }\n\n    }\n  }\n\n  const result = orderingBlock(newBlockList);\n\n  if(result.tempData.update) {\n    tempData.update?.push(...result.tempData.update);\n  }\n  modifyData.push(...result.modifyData);\n\n  return {\n    blockList: result.blockList,\n    modifyData,\n    tempData\n  }\n\n}\n\nfunction switchBlockList(\n  blocks: BlockData[], \n  idList: string[], \n  targetPosition: string, \n  container: boolean\n): ResBlockUtils | null {\n  const tempData: TempDataType = {};\n  let modifyData: ModifyData[] = [];\n  const blockList = copyToNewObjectArray(blocks);\n  const blockIdList = idList.concat();\n\n  let position = targetPosition;\n\n  if(container) {\n    const block = createBlockData({\n      position: targetPosition,\n      type: \"container\",\n      styleType: \"bk-container\"\n    });\n\n    const targetIndex = blockList.findIndex(block => block.position === targetPosition);\n\n    blockList.splice(targetIndex, 0, block);\n\n    position = targetPosition.split(/-/).concat(\"1\").join(\"-\");\n    blockList[targetIndex + 1].position = position;\n\n    tempData.delete = [ createTempData(block.id) ];\n    modifyData.push(setCreateModifyDataOfBlock(block));\n  }\n\n  const result = changeBlockPosition(blockList, blockIdList, position);\n  \n  if(!result) return null;\n\n  if(result.tempData.update) {\n    tempData.update = result.tempData.update;\n  }\n\n  modifyData = modifyData.concat(result.modifyData);\n  \n  return {\n    blockList: result.blockList,\n    tempData,\n    modifyData\n  }\n}\n\n/**\n * \n * @param blocks \n * @param restoreData \n */\nfunction restoreBlock(blocks: BlockData[], restoreData: TempDataType): ResBlockUtils {\n  console.log(blocks, restoreData);\n  \n  const tempData: TempDataType = {}\n  const modifyData: ModifyData[] = [];\n\n  let preBlockList = blocks.concat();\n\n  if(restoreData.update) {\n    tempData.update = [];\n\n    for(const data of restoreData.update) {\n      const index = preBlockList.findIndex(blockFindInfex(data.blockId));\n\n      const payload: ModifyBlockData = {};\n\n      for(const [key, value] of Object.entries(preBlockList[index])) {\n        if(data.payload[key]) {\n          payload[key as keyof ModifyBlockData] = value;\n        }\n      }\n\n      tempData.update.push(createTempData<ModifyBlockData>(preBlockList[index].id, payload));\n      modifyData.push(setUpdateModifyDataOfBlock(preBlockList[index].id, data.payload));\n      preBlockList[index] = Object.assign({}, preBlockList[index], data.payload);\n\n    }\n  }\n\n  if(restoreData.delete) {\n    const idList = restoreData.delete.map(data => data.blockId);\n    const [ removedBlockList, targetBlockList ] = divideBlock(preBlockList, idList);\n\n    preBlockList = removedBlockList;\n\n    tempData.create?.push(...targetBlockList.map(block => createTempData(block.id, block)));\n    modifyData.push(...idList.map(id => setDeleteModifyDataOfBlock(id)));\n  }\n\n  if(restoreData.create) {\n    const toBeCreatedBlock = restoreData.create.map(data => data.payload);\n\n    tempData.delete = restoreData.create.map(data => createTempData(data.blockId));\n    modifyData.push(...toBeCreatedBlock.map(block => setCreateModifyDataOfBlock(block)));\n\n    preBlockList.push(...toBeCreatedBlock);\n  }\n\n  const result = orderingBlock(sortBlock(preBlockList));\n\n  if(result.modifyData[0] || (result.tempData.update && result.tempData.update[0])) {\n    console.log(\"확인 필요\");\n    console.log(result);\n  }\n\n  return {\n    blockList: result.blockList,\n    modifyData,\n    tempData\n  }\n}\n\n/**\n * block-comments 관련 로직도 넣어야 함.\n * @param blocks \n * @param updatedData \n */\nfunction updateBlockData(blocks: BlockData[], updatedData: ModifyDataType) {\n  const tempData: TempDataType = {};\n  const modifyData: ModifyData[] = [];\n\n  let preBlockList = blocks.concat();\n\n  if(updatedData.update) {\n    tempData.update = [];\n\n    for(const data of updatedData.update) {\n      if(data.set === \"block\") {\n        const index = preBlockList.findIndex(blockFindInfex(data.blockId));\n\n        const payload: ModifyBlockData = {};\n\n        if(index !== -1) {\n          for(const [ key, value ] of Object.entries(preBlockList[index])) {\n            if(data.payload[key]) {\n              payload[key as keyof ModifyBlockData] = value;\n            }\n          }\n  \n          tempData.update.push(createTempData<ModifyBlockData>(preBlockList[index].id, payload));\n          preBlockList[index] = Object.assign({}, preBlockList[index], data.payload);\n        }\n\n        \n      } else if(data.set === \"comment\") {\n\n      }\n    }\n\n  }\n\n  if(updatedData.delete) {\n    const blockIdList: string[] | null = updatedData.delete.blockIdList? \n      updatedData.delete.blockIdList : null;\n    const commentIdList: string[] | null = updatedData.delete.commentIdList?\n    updatedData.delete.commentIdList : null;\n\n    if(blockIdList) {\n      const [ removedBlockList, targetBlockList ] = divideBlock(preBlockList, blockIdList);\n\n      preBlockList = removedBlockList;\n\n      tempData.create?.push(...targetBlockList.map(block => createTempData(block.id, block)))\n    }\n    \n  }\n\n  if(updatedData.create) {\n    const toBeCreatedBlock = updatedData.create.filter(data => data.set === \"block\");\n\n    // if(toBeCreatedBlock) {\n    //   tempData.delete = toBeCreatedBlock.map(data => createTempData(data.blockId));\n    //   preBlockList.push(...toBeCreatedBlock.map(data => data.payload));\n    // }\n    tempData.delete = [];\n\n    for(const block of toBeCreatedBlock) {\n      tempData.delete.push(createTempData(block.blockId));\n\n      const index: number = preBlockList.findIndex(preBlock => preBlock.id === block.blockId);\n\n      if(index !== -1) {\n        preBlockList[index] = updateObject(block.payload, {\n          position: preBlockList[index].position\n        });\n      } else {\n        preBlockList.push(block.payload);\n      }\n      \n    }\n\n  }\n\n  const result = orderingBlock(sortBlock(preBlockList));\n\n  if(result.modifyData[0] || (result.tempData.update && result.tempData.update[0])) {\n    console.log(\"확인 필요\");\n    console.log(result);\n\n    if(result.tempData.update && result.tempData.update[0]) {\n      if(!tempData.update) tempData.update = [];\n\n      for(const data of result.tempData.update) {\n        const index = tempData.update.findIndex(data => data.blockId === data.blockId);\n        if(index !== -1) {\n          tempData.update[index].payload = updateObject(tempData.update[index].payload, data.payload);\n        } else {\n          tempData.update.push(data);\n        }\n      }\n\n    }\n  }\n\n  return {\n    blockList: result.blockList,\n    modifyData: result.modifyData,\n    tempData\n  }\n}\n\nconst blockUtils = {\n  copyToNewObjectArray,\n  createBlockData,\n  resetToTargetPosition,\n  reissueBlockId,\n  addToStage,\n  updateBlockContents,\n  changeBlockTextStyle,\n  addBlockInList,\n  removeBlockInList,\n  removeTextBlockInList,\n  changeBlockPosition,\n  switchBlockList,\n  restoreBlock,\n  changeBlockStyleType,\n  updateBlockData\n}\n\nexport default blockUtils;","import { \n  ContentType, \n  TextContents, \n  BlockData\n} from \"../../types\";\nimport { OrderType } from \".\";\n\nconst BOLD = \"b\" as const;\nconst ITALY = \"i\" as const;\nconst UNDERBAR = \"_\" as const;\nconst FONT_COLOR = \"fc\" as const;\nconst BACKGROUND_COLOR = \"bc\" as const;\nconst ANCHOR = \"a\" as const;\nconst FONT = \"f\" as const;\n\nconst BK_BOLB = \"bk-bold\";\nconst BK_ITALIC = \"bk-italic\";\nconst BK_UNDER = \"bk-underbar\";\nconst BK_COLOR = \"color\";\nconst BK_BACKGROUND_COLOR = \"background-color\";\n\nconst FONT_WEIGHT = \"font-weight\";\nconst FONT_STYLE = \"font-style\";\nconst TEXT_DECORATION = \"text-decoration\";\nconst BOLDER_BOTTOM = \"border-bottom\";\n\nfunction convertType(prop: string):any {\n  switch(prop) {\n    case BK_BOLB:\n      return BOLD;\n    case BK_ITALIC:\n      return ITALY;\n    case BK_UNDER:\n      return UNDERBAR;\n    case BK_COLOR:\n      return FONT_COLOR;\n    case BK_BACKGROUND_COLOR:\n      return BACKGROUND_COLOR;\n    case BOLDER_BOTTOM:\n      return UNDERBAR;\n    default:\n      return null;\n  }\n}\n\n/**\n * \n * @param prop \n */\nfunction convertProperty(prop: string):any {\n  switch(prop) {\n    case \"700\":\n      return BOLD;\n    case \"italic\":\n      return ITALY;\n    default:\n      return prop;\n  }\n}\n\n/**\n * html 특수문자 컨버팅 함수\n * @param text \n * @param i \n */\nfunction specialCharacters(\n  text: string, \n  i: number\n  ): { word: string, count: number } {\n\n  let word:string = text[i];\n  let convertedWord: string;\n  let count = i + 1;\n  let length = text.length;\n\n  while(text[count] !== \" \" && text[count] !== \"&\" && count < length) {\n    word += text[count];\n    if(text[count] === \";\") break;\n    count++;\n  }\n\n  if(text[count] === \";\") {\n    switch(word) {\n      case \"&quot;\": \n        convertedWord = `\"`;\n        break;\n      case \"&amp;\":\n        convertedWord = \"&\";\n        break;\n      case \"&lt;\":\n        convertedWord = \"<\";\n        break;\n      case \"&gt;\":\n        convertedWord = \">\";\n        break;\n      case \"&nbsp;\":\n        convertedWord = \" \";\n        break;\n      case \"&iexcl;\":\n        convertedWord = \"¡\";\n        break;\n      case \"&cent;\":\n        convertedWord = \"￠\";\n        break;\n      case \"&pound;\":\n        convertedWord = \"￡\";\n        break;\n      case \"&curren;\":\n        convertedWord = \"¤\";\n        break;\n      case \"&yen;\":\n        convertedWord = \"￥\";\n        break;\n      case \"&brvbar;\":\n        convertedWord = \"|\";\n        break;\n      case \"&sect;\":\n        convertedWord = \"§\";\n        break;\n      case \"&uml;\":\n        convertedWord = \"¨\";\n        break;\n      case \"&copy;\":\n        convertedWord = \"ⓒ\";\n        break;\n      case \"&ordf;\":\n        convertedWord = \"ª\";\n        break;\n      case \"&laquo;\":\n        convertedWord = \"≪\";\n        break;\n      case \"&not;\":\n        convertedWord = \"￢\";\n        break;\n      case \"&shy;\":\n        convertedWord = \"-\";\n        break;\n      case \"&reg;\":\n        convertedWord = \"?\";\n        break;\n      case \"&macr;\":\n        convertedWord = word;\n        break;\n      case \"&deg;\":\n        convertedWord = \"°\";\n        break;\n      case \"&plusmn;\":\n        convertedWord = \"±\";\n        break;\n      case \"&sup1;\":\n        convertedWord = \"¹\";\n        break;\n      case \"&sup2;\":\n        convertedWord = \"²\";\n        break;\n      case \"&sup3;\":\n        convertedWord = \"³\";\n        break;\n      case \"&acute;\":\n        convertedWord = \"´\";\n        break;\n      case \"&micro;\":\n        convertedWord = \"μ\";\n        break;\n      case \"&para;\":\n        convertedWord = \"¶\";\n        break;\n      case \"&middot;\":\n        convertedWord = \"·\";\n        break;\n      case \"&cedil;\":\n        convertedWord = \"¸\";\n        break;\n      case \"&ordm;\":\n        convertedWord = \"º\";\n        break;\n      case \"&raquo;\":\n        convertedWord = \"≫\";\n        break;\n      case \"&frac14;\":\n        convertedWord = \"¼\";\n        break;\n      case \"&frac12;\":\n        convertedWord = \"½\";\n        break;\n      case \"&frac34;\":\n        convertedWord = \"¾\";\n        break;\n      case \"&iquest;\":\n        convertedWord = \"¿\";\n        break;\n      case \"&Agrave;\":\n        convertedWord = \"A\";\n        break;\n      case \"&Aacute;\":\n        convertedWord = \"A\";\n        break;\n      case \"&Acirc;\":\n        convertedWord = \"A\";\n        break;\n      case \"&Atilde;\":\n        convertedWord = \"A\";\n        break;\n      case \"&Auml;\":\n        convertedWord = \"A\";\n        break;\n      case \"&Aring;\":\n        convertedWord = \"A\";\n        break;\n      case \"&AElig;\":\n        convertedWord = \"Æ\";\n        break;\n      case \"&Ccedil;\":\n        convertedWord = \"C\";\n        break;\n      case \"&Egrave;\":\n        convertedWord = \"E\";\n        break;\n      case \"&Eacute;\":\n        convertedWord = \"E\";\n        break;\n      case \"&Ecirc;\":\n        convertedWord = \"E\";\n        break;\n      case \"&Euml;\":\n        convertedWord = \"E\";\n        break;\n      case \"&Igrave;\":\n        convertedWord = \"I\";\n        break;\n      case \"&Iacute;\":\n        convertedWord = \"I\";\n        break;\n      case \"&Icirc;\":\n        convertedWord = \"I\";\n        break;\n      case \"&Iuml;\":\n        convertedWord = \"I\";\n        break;\n      case \"&ETH;\":\n        convertedWord = \"Ð\";\n        break;\n      case \"&Ntilde;\":\n        convertedWord = \"N\";\n        break;\n      case \"&Ograve;\":\n        convertedWord = \"O\";\n        break;\n      case \"&Oacute;\":\n        convertedWord = \"O\";\n        break;\n      case \"&Ocirc;\":\n        convertedWord = \"O\";\n        break;\n      case \"&Otilde;\":\n        convertedWord = \"O\";\n        break;\n      case \"&Ouml;\":\n        convertedWord = \"O\";\n        break;\n      case \"&times;\":\n        convertedWord = \"×\";\n        break;\n      case \"&Oslash;\":\n        convertedWord = \"Ø\";\n        break;\n      case \"&Ugrave;\":\n        convertedWord = \"U\";\n        break;\n      case \"&Uacute;\":\n        convertedWord = \"U\";\n        break;\n      case \"&Ucirc;\":\n        convertedWord = \"U\";\n        break;\n      case \"&Uuml;\":\n        convertedWord = \"U\";\n        break;\n      case \"&Yacute;\":\n        convertedWord = \"Y\";\n        break;\n      case \"&THORN;\":\n        convertedWord = \"Þ\";\n        break;\n      case \"&szlig;\":\n        convertedWord = \"ß\";\n        break;\n      case \"&agrave;\":\n        convertedWord = \"a\";\n        break;\n      case \"&aacute;\":\n        convertedWord = \"a\";\n        break;\n      case \"&acirc;\":\n        convertedWord = \"a\";\n        break;\n      case \"&atilde;\":\n        convertedWord = \"a\";\n        break;\n      case \"&auml;\":\n        convertedWord = \"a\";\n        break;\n      case \"&aring;\":\n        convertedWord = \"a\";\n        break;\n      case \"&aelig;\":\n        convertedWord = \"æ\";\n        break;\n      case \"&ccedil;\":\n        convertedWord = \"c\";\n        break;\n      case \"&egrave;\":\n        convertedWord = \"e\";\n        break;\n      case \"&eacute;\":\n        convertedWord = \"e\";\n        break;\n      case \"&ecirc;\":\n        convertedWord = \"e\";\n        break;\n      case \"&euml;\":\n        convertedWord = \"e\";\n        break;\n      case \"&igrave;\":\n        convertedWord = \"i\";\n        break;\n      case \"&iacute;\":\n        convertedWord = \"i\";\n        break;\n      case \"&icirc;\":\n        convertedWord = \"i\";\n        break;\n      case \"&iuml;\":\n        convertedWord = \"i\";\n        break;\n      case \"&eth;\":\n        convertedWord = \"ð\";\n        break;\n      case \"&ntilde;\":\n        convertedWord = \"n\";\n        break;\n      case \"&ograve;\":\n        convertedWord = \"o\";\n        break;\n      case \"&oacute;\":\n        convertedWord = \"o\";\n        break;\n      case \"&ocirc;\":\n        convertedWord = \"o\";\n        break;\n      case \"&otilde;\":\n        convertedWord = \"o\";\n        break;\n      case \"&ouml;\":\n        convertedWord = \"o\";\n        break;\n      case \"&divide;\":\n        convertedWord = \"÷\";\n        break;\n      case \"&oslash;\":\n        convertedWord = \"ø\";\n        break;\n      case \"&ugrave;\":\n        convertedWord = \"u\";\n        break;\n      case \"&uacute;\":\n        convertedWord = \"u\";\n        break;\n      case \"&ucirc;\":\n        convertedWord = \"u\";\n        break;\n      case \"&uuml;\":\n        convertedWord = \"u\";\n        break;\n      case \"&yacute;\":\n        convertedWord = \"y\";\n        break;\n      case \"&thorn;\":\n        convertedWord = \"þ\";\n        break;\n      case \"&yuml;\":\n        convertedWord = \"y\";\n        break;\n\n      default: \n        convertedWord = word;\n    }\n  } else {\n    convertedWord = text[i];\n    count = i;\n  }\n\n  return {\n    word: convertedWord,\n    count\n  };\n}\n\nfunction parseHtmlContents(text:string):TextContents[] {\n\n  const newContents: any[] = [];\n  const textLength: number = text.length;\n\n  let saveToggle:boolean = true;\n\n  let content: any = [];\n\n  let propertyToggle:boolean = false;\n  let linkToggle:boolean = false;\n\n  let propertys: any[] = [];\n  let property: string | null = null;\n  let type: string[] = [];\n\n  for(let i = 0; i < textLength; i++) {\n\n    if(!propertyToggle && !linkToggle) {\n\n      switch(text[i]) {\n        case \"<\": \n  \n          if(i && text[i+1] === \"/\" && (text[i+6] === \">\" || text[i+2] === \"a\")) {\n            if(content[0]) {\n              newContents.push(content);\n              content = [];\n            }\n            if(text[i+6] === \">\") {\n              i += 6;\n            } else {\n              i += 3;\n            }\n          \n            saveToggle = true;\n\n          } else {\n\n            saveToggle = false;\n  \n            if(content[0] !== undefined) {\n              newContents.push(content);\n              content = [];\n            } \n\n            if(text[i+1] === \"s\") {\n              i += 4;\n            } else if(text[i+1] === ANCHOR) {\n              i += 1;\n            }\n         \n          }\n  \n          break;\n        case \">\":\n          saveToggle = true;\n\n          break;\n  \n        case \"s\":\n  \n          if(!saveToggle) {\n           if(text[i+1] === \"t\" && text[i+5] === \"=\") {\n             i += 6;\n             propertyToggle = true;\n           }\n          } else {\n            content[0]? content[0] += text[i] : content[0] = text[i];\n          }\n\n          break;\n  \n        case \"c\":\n          if(!saveToggle) {\n            if(text[i+1] === \"l\" && text[i+5] === \"=\") {\n              i += 6;\n              propertyToggle = true;\n            }\n          } else {\n            content[0]? content[0] += text[i] : content[0] = text[i];\n          }\n\n          break;\n        \n        case \"h\":\n          if(!saveToggle) {\n            if(text[i+1] === \"r\" && text[i+3] === \"f\") {\n              i += 5;\n              linkToggle = true;\n            }\n    \n          } else {\n            content[0]? content[0] += text[i] : content[0] = text[i];\n          }\n\n          break;\n        \n        case \"&\":\n          const { word, count } = specialCharacters(text, i);\n          i = count;\n          content[0]? content[0] += word : content[0] = word;\n  \n          break;\n        \n        // chrome 번역기 동작시 font 태그가 주입될때 오작동 방지\n        case FONT:\n          if(!saveToggle) {\n            if(text[i - 1] === \"<\") {\n              while(text[i+1] !== \">\") {\n                i++\n              }\n            }\n          } else {\n            content[0]? content[0] += text[i] : content[0] = text[i];\n          }\n\n          break;\n          \n        default:\n          if(saveToggle) {\n            content[0]? content[0] += text[i] : content[0] = text[i];\n          }\n         \n      }\n\n    } else if (propertyToggle){\n\n      switch(text[i]) {\n\n        case \":\":\n          if(property) {\n            type = [convertType(property)]\n            property = null;\n          };\n          break;\n\n        case \";\":\n\n          if(type && property) {\n            type.push(convertProperty(property));\n            if(!type[0]) type.shift();\n            if(type[0] === UNDERBAR) type.pop();\n            propertys.push(type);\n            type = [];\n            property = null;\n          }\n\n          break;\n\n        case \" \":\n\n          if(property && !type[0]) {\n            type = [convertType(property)];\n            propertys.push(type);\n            type = []; \n\n            property = null;\n          }\n\n          break;\n\n        case '\"' || \"'\":\n \n          if(property) {\n            type = [convertType(property)];\n            if(type) {\n              propertys.push(type); \n            }\n          }\n\n          if(!content[1]) {\n            content = [content[0], ];\n            content[1] = [...propertys];\n          } else {\n            content[1] = [...content[1], ...propertys];\n          }\n          propertys = [];\n          propertyToggle = false;\n          property = null;\n          type = [];\n\n          break;\n\n        default: \n          property? property += text[i] : property = text[i];\n      }\n\n    } else if(linkToggle) {\n\n      if(text[i] === \"'\" || text[i] === '\"') {\n        if(!content[1]) {\n          content = [content[0],[[ANCHOR, property]]];\n        } else {\n          content[1].push([ANCHOR, property]);\n        }\n        \n        property = null;\n        linkToggle = false;\n\n      } else {\n        property? property += text[i] : property = text[i];\n      }\n    }\n    \n  }\n\n  if(content[0]) {\n    newContents.push(content);\n  }\n\n  return newContents;\n}\n\nexport function equalsArray(aryA: any[], aryB: any[]): boolean {\n  if(!aryA && !aryB) return true;\n  if(!Array.isArray(aryA) || !Array.isArray(aryB) || aryA.length !== aryB.length ) return false;\n\n  const targetBList = [];\n\n  for(let i = 0; i < aryA.length; i++) {\n    const targetA = JSON.stringify(aryA[i]);\n    if(!i) {\n      for(let ii = 0; ii < aryB.length; ii++) {\n\n        const targetB = JSON.stringify(aryB[ii]);\n        if(targetA === targetB) {\n          \n        } else {\n          targetBList.push(targetB)\n        }\n\n      }\n      if(targetBList.length === aryB.length) return false;\n    } else {\n      const targetBListLength = targetBList.length;\n\n      for(let ii = 0; ii < targetBList.length; ii++) {\n        if(targetBList[ii] === targetA) {\n          targetBList.splice(ii, 1);\n          break;\n        } \n      }\n\n      if(targetBListLength === targetBList.length) {\n        return false;\n      }\n      \n    }\n  } \n\n  return targetBList.length? false : true;\n}\n\n// export function arrayFindIndex2(array: any[], factor: any): number {\n//   const JSONFactor = JSON.stringify(factor[0]);\n//   console.log(JSONFactor, factor);\n\n//   for(let i = 0; i < array.length; i++) {\n//     const JSONArray = JSON.stringify(array[i][0]);\n//     if(JSONArray === JSONFactor) {\n//       return i;\n//     }\n//   }\n//   return -1;\n// }\n\nexport function arrayFindIndex(array: any[], factor: any[]): number {\n  for(let i = 0; i < array.length; i++) {\n    if(array[i][0] === factor[0]) {\n      return i;\n    }\n  }\n  return -1;\n}\n\n\nfunction addContentsStyle(\n  preTexts: TextContents[], \n  startPoint: number, \n  endPoint: number, \n  style: ContentType\n  ): TextContents[] {\n  let count = 0;\n  let insertText: any = [\"\",[]];\n  let newContents = [];\n\n  preTexts.forEach( (text: any) => {\n\n    for(let i = 0; i < text[0].length; i++) {\n      if(count === startPoint \n        || (count + 1) === endPoint\n        || (count >= startPoint && count < endPoint && i === 0)\n      ) {\n        if(arrayFindIndex(insertText[1], style) === -1) {\n\n          if(insertText[0]) newContents.push(insertText);\n\n          if(text[1]) {\n            if(arrayFindIndex(text[1], style) !== -1) {\n              insertText = [\"\", [...text[1]]];\n            } else {\n              insertText = [\"\", [...text[1], style]];\n            };\n          } else {\n            insertText = [\"\", [style]];\n          };\n\n        } else {\n          \n          if(text[1]) {\n            if(arrayFindIndex(text[1], style) !== -1) {\n\n              if(!equalsArray(insertText[1], text[1])) {\n                newContents.push(insertText);\n                insertText = [\"\", [...text[1]]];\n              };\n\n            } else {\n\n              if(!equalsArray(insertText[1], [...text[1], style])) {\n                newContents.push(insertText);\n                insertText = [\"\", [...text[1], style]];\n              };\n\n            };\n          } else {\n            \n            if(!equalsArray(insertText[1], [style])) {\n              newContents.push(insertText);\n              insertText = [\"\", [style]];\n            };\n\n          };\n        };\n\n      } else if(count === endPoint || i === 0){\n        if(!equalsArray(insertText[1], text[1]? text[1] : [])) { \n          if(insertText[0]) {\n            newContents.push(insertText);\n          }\n          insertText = text[1]?[\"\", [...text[1]]] : [\"\", []];\n        };\n      };\n\n      insertText[0] += text[0][i];\n      count++;\n    }\n    \n  })\n\n  newContents.push(insertText);\n\n  return newContents.map(content => content[1][0]? content : [content[0]]);\n}\n\nfunction deleteContentsStyle(\n  preTexts: TextContents[], \n  startPoint:number, \n  endPoint:number, \n  style: ContentType\n  ): TextContents[] {\n  let count = 0;\n  let insertText:any = [\"\",[]];\n  let newContents = [];\n\n  preTexts.forEach((text: any) => {\n    for(let i = 0; i < text[0].length; i++) {\n\n      if(count === startPoint \n        || (count + 1) === endPoint\n        || (count > startPoint && count < endPoint && i === 0)\n      ) {\n        \n        let stylePosition: number;\n\n        if(text[1]) {\n          if(equalsArray(insertText[1], text[1])) {\n            stylePosition = arrayFindIndex(insertText[1], style);\n\n            if(stylePosition !== -1) {\n              newContents.push(insertText);\n              const newStyle = [...insertText[1]];\n              newStyle.splice(stylePosition, 1);\n              insertText = [\"\", [...newStyle]];\n            } \n\n          } else {\n            const textStylePosition = arrayFindIndex(text[1], style);\n            const newText = [...text[1]];\n            stylePosition = arrayFindIndex(insertText[1], style);\n            \n            if(stylePosition !== -1) {\n              if(insertText[0]) {\n                newContents.push(insertText);\n              } \n              // 확인 필요\n              const newStyle = [...insertText[1]];\n\n              console.log(\"new style\", newStyle)\n\n              if(textStylePosition !== -1) {\n                newText.splice(textStylePosition, 1);\n                insertText = [\"\", [...newText]];\n              } else {\n                insertText = [\"\", [...text[1]]];\n              }\n\n            } else {\n\n              if(textStylePosition !== -1) {\n                newText.splice(textStylePosition, 1);\n\n                if(!equalsArray(insertText[1], newText)) {\n                  if(insertText[0]) newContents.push(insertText);\n                  insertText = [\"\", [...newText]];\n                }\n\n              } else {\n                if(!equalsArray(insertText[1], text[1])) {\n                  if(insertText[0]) newContents.push(insertText);\n                  insertText = [\"\", [...text[1]]];\n                }\n              }\n              \n            }\n\n\n          }\n        } else if(insertText[1][0]){\n          newContents.push(insertText);\n          insertText = [\"\", []];\n        }\n      } else if(count === endPoint || i === 0) {\n        if(!equalsArray(insertText[1], text[1]? text[1] : [])) { \n          if(insertText[0]) newContents.push(insertText);\n          insertText = text[1]? [\"\", [...text[1]]] : [\"\", []]\n        };\n      }\n      insertText[0] += text[0][i];\n      \n      count++;\n\n    }\n  });\n\n  if(insertText[0]) {\n    newContents.push(insertText);\n  }\n\n  return newContents.map(content => content[1][0]? content : [content[0]]);\n}\n\n\n/**\n * Text contents style 변환 함수\n * return BlockData<TextProps>\n * @param changedTextStyleBlock \n * @param styleType \n * @param startPoint \n * @param endPoint \n * @param order \n */\nfunction changeStyleTextContents(\n  changedTextStyleBlock: BlockData, \n  styleType: ContentType,\n  startPoint: number, \n  endPoint: number,\n  order: OrderType\n):BlockData {\n  \n  let changedTextContents: TextContents[];\n\n  switch(order) {\n    case \"add\":\n      changedTextContents = addContentsStyle(\n        changedTextStyleBlock.contents,\n        startPoint,\n        endPoint,\n        styleType\n      );\n      break;\n\n    case \"del\":\n      changedTextContents = deleteContentsStyle(\n        changedTextStyleBlock.contents,\n        startPoint,\n        endPoint,\n        styleType\n      );\n      break;\n\n    case \"color\":\n      changedTextContents = addContentsStyle(\n        deleteContentsStyle(\n          changedTextStyleBlock.contents,\n          startPoint,\n          endPoint,\n          styleType\n        ),\n        startPoint,\n        endPoint,\n        styleType\n      );\n      break;\n\n    case \"link\":\n      changedTextContents = addContentsStyle(\n        deleteContentsStyle(\n          changedTextStyleBlock.contents,\n          startPoint,\n          endPoint,\n          styleType\n        ),\n        startPoint,\n        endPoint,\n        styleType\n      );\n      break;\n\n    default: \n      changedTextContents = changedTextStyleBlock.contents;\n  }\n\n  return Object.assign({}, \n    changedTextStyleBlock, {\n      contents: changedTextContents\n    }\n  );\n}\n\nfunction sliceTextContents(\n  preTexts: TextContents[], \n  startPoint:number, \n  endPoint:number, \n): TextContents[][] {\n\n  let count = 0;\n  let partTexts: TextContents | null = null;\n  let frontTexts: TextContents[] = [];\n  let backTexts: TextContents[] = [];\n\n  if(startPoint === 0 && endPoint === 0) {\n    return [frontTexts, preTexts];\n  }\n\n  for(const texts of preTexts) {\n    const textsLength = texts[0].length - 1;\n\n    for(let i = 0; i <= textsLength; i++) {\n      if(count < startPoint || count > endPoint) {\n\n        if(!partTexts) {\n          if(texts[1]) {\n            partTexts = [\"\", texts[1]];\n          } else {\n            partTexts = [\"\"];\n          }\n        } else if(i === 0) {\n          if(partTexts[1] && texts[1] && !equalsArray(partTexts[1], texts[1])) {\n            backTexts.push(partTexts);\n            partTexts = [\"\", texts[1]];\n          } \n        }\n\n        partTexts[0] += texts[0][i];\n        \n        if(i === textsLength && partTexts) {\n          if(count < startPoint) {\n            frontTexts.push(partTexts);\n          } else {\n            backTexts.push(partTexts);\n          }\n          partTexts = null;\n        }\n      } else {\n        \n        if(count === startPoint && partTexts) {\n          frontTexts.push(partTexts);\n          partTexts = null;\n        } \n\n        if(count === endPoint) {\n          if(texts[1]) {\n            partTexts = [texts[0][i], texts[1]];\n          } else {\n            partTexts = [texts[0][i]];\n          }\n        }\n        \n      }\n\n      count++;\n    }\n  }\n\n  if(partTexts) backTexts.push(partTexts);\n\n  return [frontTexts, backTexts];\n}\n\nfunction mergeTextContents(\n  toBeMergedContents: TextContents[],\n  targetContents: TextContents[]\n): TextContents[] {\n  const copyToBeMergedContents = toBeMergedContents.concat();\n  const copyTargetContents = targetContents.concat();\n  const frontContent: TextContents = copyToBeMergedContents.pop();\n  const backContent: TextContents  = copyTargetContents.shift();\n\n  if(!frontContent) {\n    return targetContents;\n  }\n\n  if(equalsArray(frontContent[1]? frontContent[1] : [], backContent[1]? backContent[1] : [])){\n    frontContent[0] += backContent[0];\n    copyToBeMergedContents.push(frontContent, ...copyTargetContents);\n  } else {\n    copyToBeMergedContents.push(frontContent, backContent, ...copyTargetContents);\n    console.log(\"1\", frontContent, backContent, copyTargetContents);\n  }\n\n  return copyToBeMergedContents;\n}\n\nconst converter = {\n  parseHtmlContents,\n  addContentsStyle,\n  deleteContentsStyle,\n  changeStyleTextContents,\n  sliceTextContents,\n  mergeTextContents\n}\n\nexport default converter;","import { copyToNewObjectArray, createTempData, ResBlockUtils, SetBlockDataList, setUpdateModifyDataOfBlock, TempDataType } from \".\";\nimport { BlockData, RawBlockData } from \"../../types\";\n\n// const parseString = (text: string): string[] => {\n//   return text.split(/-/);\n// }\n\n// const convertArg = (arg: any[]): string => {\n//   if(arg.length === 1) return `${arg[0]}`;\n//   return arg.reduce((acc, cur) =>  !acc? `${cur}` : `${acc}-${cur}`);\n// }\n\n// const isPosition = (position: string) => \n//   (block: RawBlockData | BlockData) =>  \n//   block.position === position;\n\n// function resetBlockPosition(\n//   preBlockDataList: BlockData[] | RawBlockData[], \n//   sortedBlockDataList: BlockData[]\n// ): BlockData[] {\n\n//   const blockList = preBlockDataList.concat();\n\n//   const rootBlockList = sortedBlockDataList.filter((block) => parseString(block.position).length === 1);\n//   const length = rootBlockList.length - 1\n//   let nextPosition: number = Number(rootBlockList[length].position);\n//   let index = rootBlockList[length].index;\n\n//   return sortedBlockDataList.concat(blockList.map((block: BlockData | RawBlockData ) => Object.assign({}, block, {\n//     position: `${++nextPosition}`,\n//     index: ++index\n//   })));\n// }\n\n// export function sortBlock2(blockDataList: BlockData[] | RawBlockData[]): BlockData[] {\n//   let length = blockDataList.length - 1;\n\n//   if(length === -1) return [];\n\n//   let index = 1;\n//   let currentPosition: string[] = [\"1\"];\n//   let parentId: string | null = null;\n\n//   const preBlockDataList = blockDataList.concat();\n//   const sortedBlockDataList: BlockData[] = []; \n\n//   let preBlockListIdx: number = preBlockDataList.findIndex(isPosition(covertArg(currentPosition)));\n\n//   while(length) {\n//     sortedBlockDataList.push(Object.assign({}, preBlockDataList[preBlockListIdx], {\n//       index\n//     }));\n//     preBlockDataList[preBlockListIdx] = preBlockDataList[length];\n//     preBlockDataList.pop();\n//     length--;\n//     index++;\n\n//     let stringLength = currentPosition.length;\n//     let nextPosition: string[] = currentPosition.concat();\n//     nextPosition.push(\"1\");\n\n//     preBlockListIdx = preBlockDataList.findIndex(isPosition(covertArg(nextPosition)));\n\n//     while(preBlockListIdx === -1) {\n//       stringLength--;\n//       nextPosition.pop();\n//       nextPosition[stringLength] = `${Number(nextPosition[stringLength]) + 1}`;\n\n//       if(stringLength === -1) {\n//         return resetBlockPosition(preBlockDataList, sortedBlockDataList);\n//       }\n\n//       preBlockListIdx = preBlockDataList.findIndex(isPosition(covertArg(nextPosition)));\n//     }\n\n//     currentPosition = nextPosition;\n//   }\n\n//   sortedBlockDataList.push(Object.assign({}, preBlockDataList[0], {\n//     index\n//   }));\n\n//   return sortedBlockDataList;\n// }\n\n\nexport function sortBlock<T extends RawBlockData = any>(blockDataList: T[]): T[] {\n  return blockDataList.concat().sort((a, b) => {\n    if(a.position === b.position) {\n      return 0\n    }\n    const ary1 = a.position.split(/-/);\n    const ary2 = b.position.split(/-/);\n\n    let length = 0;\n    while(ary1[length] && ary2[length]) {\n      const aNum = Number(ary1[length]);\n      const bNum = Number(ary2[length]);\n\n      if(aNum > bNum) {\n        return 1;\n      } else if(aNum < bNum) {\n        return -1;\n      }\n\n      length++;\n    }\n\n    if(!ary1[length] && !ary2[length]) {\n      return 0;\n    } else {\n      return ary1[length]? 1 : -1;\n    }\n  });\n}\n\nfunction initBlock2(blockDataList: BlockData[] | RawBlockData[]) {\n  const preBlockDataList = sortBlock(blockDataList);\n  const newBlockDataList: BlockData[] = [];\n\n  let positions: [number, string][] = []; //[position, id]\n  let positionsLength = 0;\n  let index = 1;\n  let preBlockListlength = preBlockDataList.length - 1;\n\n\n  positions.push([preBlockDataList[0].position.split(/-/).length, preBlockDataList[0].id]);\n  newBlockDataList.push(Object.assign({}, preBlockDataList[0], {\n    index: 0,\n    parentId: \"root\"\n  }));\n\n  preBlockDataList.shift();\n\n  while(preBlockListlength) {\n    let length = preBlockDataList[0].position.split(/-/).length;\n\n    if(positions[positionsLength][0] === length) {\n\n      positions[positionsLength] = [length, preBlockDataList[0].id];\n\n    } else if(positions[positionsLength][0] < length){\n\n      positions.push([length, preBlockDataList[0].id]);\n      positionsLength++;\n\n    } else {\n\n      for(let i = 0; i <= positions[positionsLength][0] - length; i++) {\n        positions.pop();\n        positionsLength--;\n      } \n\n      positions[positionsLength] = [length, preBlockDataList[0].id];\n    }\n    \n    newBlockDataList.push(Object.assign({}, preBlockDataList[0], {\n      index,\n      parentId: !positionsLength? \"root\" : positions[positionsLength - 1][1]\n    }));\n\n    preBlockListlength--;\n    index++;\n    preBlockDataList.shift();\n  }\n\n  return newBlockDataList;\n}\n\nexport function orderingBlock(blockDataList: BlockData[] | RawBlockData[]): ResBlockUtils {\n  const preBlockDataList = copyToNewObjectArray(blockDataList);\n  const newBlockDataList: BlockData[] = [];\n  const tempData: TempDataType = { update: [] };\n  const modifyData: any[] = [];\n\n  let preBlockListlength = preBlockDataList.length - 1;\n\n  if(preBlockListlength === -1) {\n    return {\n      blockList: [],\n      modifyData,\n      tempData\n    }\n  }\n\n  const stackId: string[] = [];\n  let stackIdLength = 0;\n  let index = 1;\n  let currentPosition = [1];\n  let currentPositionLength = 0;\n\n  stackId.push(preBlockDataList[0].id);\n\n  newBlockDataList.push(Object.assign({}, preBlockDataList[0], {\n    index: 0,\n    parentId: \"root\",\n    position: \"1\"\n  }));\n\n  if(preBlockDataList[0].position !== \"1\") {\n\n    tempData.update?.push(createTempData(preBlockDataList[0].id, {\n      position: preBlockDataList[0].position\n    }));\n\n    modifyData.push(\n      setUpdateModifyDataOfBlock(preBlockDataList[0].id, {\n        position: \"1\"\n      })\n    );\n\n  }\n\n  preBlockDataList.shift();\n\n  while(preBlockListlength) {\n    let block = preBlockDataList.shift();\n    \n    if(!block) {\n      console.log(\"not block\", preBlockDataList, blockDataList);\n      return {\n        blockList: [],\n        modifyData,\n        tempData\n      };\n    }\n    \n    let length = block.position.split(/-/).length - 1;\n\n    if(currentPositionLength === length) {\n      \n      stackId[stackIdLength] = block.id;\n      currentPosition[currentPositionLength]++;\n\n    } else if(currentPositionLength < length){\n\n      stackId.push(block.id);\n      stackIdLength++;\n      currentPosition.push(1);\n      currentPositionLength++;\n\n    } else {\n\n      for(let i = 0; i <= currentPositionLength - length; i++) {\n        currentPosition.pop();\n        currentPositionLength--;\n        stackId.pop();\n        stackIdLength--;\n      } \n\n      currentPosition[currentPositionLength]++;\n      stackId[stackIdLength] = block.id;\n    }\n\n    let position = currentPosition.join(\"-\");\n\n    if(position !== block.position) {\n\n      tempData.update?.push(createTempData(block.id, {\n        position: block.position\n      }));\n\n      modifyData.push(setUpdateModifyDataOfBlock(block.id, {\n        position\n      }));\n      \n    }\n    \n    newBlockDataList.push(Object.assign({}, block, {\n      index,\n      parentId: !stackIdLength? \"root\" : stackId[stackIdLength - 1],\n      position\n    }));\n\n    preBlockListlength--;\n    index++;\n  }\n\n  return {\n    blockList: newBlockDataList,\n    tempData,\n    modifyData\n  };\n}\n\nfunction initBlock(blockDataList: RawBlockData[] | BlockData[]): ResBlockUtils {\n  return orderingBlock(sortBlock(blockDataList));\n}\n\nconst reducer = (acc: any, cur: BlockData) => {\n  if(!acc.hasOwnProperty([cur.parentId])) {\n    acc[cur.parentId] = []\n  } \n\n  acc[cur.parentId].push(cur);\n\n  return acc;\n}\n\nfunction setBlockList(blockDataList: BlockData[]): SetBlockDataList | null {\n  return blockDataList[0]? blockDataList.reduce(reducer, {}) : null;\n}\n\n/**\ntype = {\n  root: [\n    \"a1\",\n    \"a2\",\n    \"a3\"\n  ],\n  \"a1\": [\n    \"a4\",\n    \"a5\"\n  ],\n  \"a2\": [\n    \"a6\",\n    \"a7\"\n  ],\n  \"a3\": [\n    \"a8\"\n  ],\n  \"a7\": [\n    \"a9\"\n  ]\n}\n\ntype = [\n  [\"a1\", \"1\"],\n  [\"a2\", \"2\"],\n  [\"a3\", \"3\"],\n  [\"a4\", \"1-1\"],\n  [\"a5\", \"1-2\"],\n  [\"a6\", \"2-1\"],\n  [\"a7\", \"2-2\"],\n  [\"a9\", \"2-2-1\"],\n  [\"a8\", \"3-1\"]\n]\n\ntype {\n  root: [],\n  \"parentId1\": [],\n  \"parentId2\": [],\n  \"parentId3\": []\n}\n\n위치를 옮길 때는 parentId를 null하고 position 변경\n부모의 position이 변경됐을 때는 parentId를 기반으로 children 찾기\n*/\n\nconst orderingBlockUtils = {\n  sortBlock,\n  orderingBlock,\n  initBlock,\n  setBlockList\n}\n\nexport default orderingBlockUtils;\n\n","import { TempData, StagedBlock, TempDataType, TempSet } from \".\";\nimport { updateObject } from \"../../../../store/utils\";\nimport { BlockData, RawBlockData, ModifyData, ModifyCommand, ModifySet, ModifyBlockData, ModifyDataType } from \"../../types\";\n\nfunction tempDataPush(\n  tempStore: TempDataType[], \n  tempData: TempDataType, \n  limitCount: number = 6\n  ): TempDataType[] {\n\n  const newTempStore = [...tempStore, tempData];\n\n  if(limitCount < newTempStore.length) {\n    newTempStore.shift();\n  }\n\n  return newTempStore;\n}\n\nfunction getContentsToBeChanged(\n  blocks: BlockData<any>[], \n  stage: StagedBlock[]\n  ): StagedBlock[] {\n  \n  let changedBlocks: BlockData[] = [];\n  \n  for(const data of stage) {\n    if(blocks[data.blockIndex].type === \"text\") {\n      changedBlocks.push(blocks[data.blockIndex]);\n    }\n  }\n\n  return changedBlocks.map(block => {\n    return {\n      id: block.id,\n      contents: block.contents? block.contents : null,\n      blockIndex: block.index\n    }\n  })\n}\n\nfunction createTempData<T = any>(\n  blockId: string, \n  payload?: T\n): TempData {\n  return {\n    blockId,\n    payload\n  }\n}\n\nfunction createModifyData<T = any>(\n  command: ModifyCommand, \n  set: ModifySet,\n  blockId: string, \n  payload?: T\n): ModifyData {\n  return {\n    command,\n    set,\n    blockId,\n    payload\n  }\n}\n\nfunction setCreateModifyDataOfBlock(block: BlockData): ModifyData {\n  return createModifyData<RawBlockData>(\"create\", \"block\", block.id, updateObject(block, {\n    index: undefined,\n    parentId: undefined\n  }));\n}\n\nfunction setDeleteModifyDataOfBlock(blockId: string): ModifyData {\n  return createModifyData(\"delete\", \"block\", blockId);\n}\n\nfunction setUpdateModifyDataOfBlock(blockId: string, payload: ModifyBlockData) {\n  return createModifyData<ModifyBlockData>(\"update\", \"block\", blockId, payload);\n}\n\nfunction updateModifyData(preModifyData: ModifyData[], newModifyData: ModifyData[]) {\n  if(!newModifyData[0]) {\n    return preModifyData;\n  }\n  \n  const newModifyDataList = [...preModifyData];\n\n  for(const modifyData of newModifyData) {\n    let index = newModifyDataList.findIndex((data) => data.blockId === modifyData.blockId);\n\n    if(index !== -1) {\n      const { command, blockId, set, payload } = newModifyDataList[index];\n\n      if(set === modifyData.set) {\n\n        if(command === \"create\" && modifyData.command === \"delete\") {\n\n          newModifyDataList.splice(index, 1);\n          \n        } else {\n\n          newModifyDataList[index] = {\n            blockId,\n            set,\n            command: command === \"create\" && modifyData.command === \"update\"? \"create\" : modifyData.command,\n            payload: payload? Object.assign({}, payload, modifyData.payload) : modifyData.payload\n          }\n\n        }\n\n      } else {\n\n        if(set !== \"block\" && command !== \"delete\") {\n         newModifyDataList.push(modifyData); \n        }\n\n      }\n\n    } else { \n      newModifyDataList.push(modifyData);\n    }\n  }\n\n  return newModifyDataList;\n}\n\nconst modifyDataReducer = (acc: ModifyDataType, cur: ModifyData) => {\n  switch (cur.command) {\n    case \"create\":\n      acc.create.push(cur);\n      \n      break;\n\n    case \"update\":\n      acc.update.push(cur);\n      \n      break;\n\n    case \"delete\":\n      if(cur.set === \"block\") {\n        acc.delete.blockIdList.push(cur.blockId);\n      } else if(cur.set === \"comment\") {\n        acc.delete.commentIdList.push(cur.payload);\n      }\n\n      break;\n  }\n\n  return acc;\n}\n\nfunction convertModifyData(modifyDataList: ModifyData[]) {\n  const acc: ModifyDataType = {\n    create: [],\n    update: [],\n    delete: {\n      blockIdList: [],\n      commentIdList: []\n    }\n  }\n  const modifyData: ModifyDataType = modifyDataList.reduce(modifyDataReducer, acc);\n  \n  if(!modifyData.create[0]) modifyData.create = undefined;\n  if(!modifyData.update[0]) modifyData.update = undefined;\n  if(!modifyData.delete.blockIdList[0]) modifyData.delete.blockIdList = undefined;\n  if(!modifyData.delete.commentIdList[0]) modifyData.delete.commentIdList = undefined;\n  if(!modifyData.delete.blockIdList && !modifyData.delete.commentIdList) modifyData.delete = undefined;\n\n  return modifyData;\n}\n\nfunction replaceModifyData(currentData: ModifyData[], replaceData: ModifyDataType): ModifyData[] {\n  if(!currentData[0]) return [];\n\n  const updateData = replaceData.update? replaceData.update : null;\n  const createData = replaceData.create? replaceData.create : null;\n  const deleteData = replaceData.delete? replaceData.delete : null;\n\n  let newModifyData: ModifyData[] = currentData.concat();\n\n  if(deleteData) {\n    const blockIdList = deleteData.blockIdList? deleteData.blockIdList : null;\n    const commentIdList = deleteData.commentIdList? deleteData.commentIdList : null;\n\n    if(blockIdList) {\n      newModifyData = newModifyData.filter(data => !blockIdList.includes(data.blockId) || data.set !== \"block\");\n    }\n  }\n\n  if(updateData && newModifyData[0]) {\n    for(const data of updateData) {\n      if(!newModifyData[0]) break;\n\n      const index = newModifyData.findIndex(modifyData => \n        modifyData.blockId === data.blockId && modifyData.set === data.set);\n      \n      console.log(data, index);\n\n      if(index !== -1) {\n        if(newModifyData[index].command !== \"delete\") {\n          let deleteCheck = true;\n\n          for(const [ key, value ] of Object.entries(newModifyData[index].payload)) {\n            if(!data.payload[key]) {\n              deleteCheck = false;\n            } else {\n              newModifyData[index].payload[key] = undefined;\n              delete newModifyData[index].payload[key];\n            }\n          }\n\n          if(deleteCheck) newModifyData.splice(index, 1);\n        }\n      } \n\n    }\n  }\n\n  if(createData && newModifyData[0]) {\n    for(const data of createData) {\n      const index = newModifyData.findIndex(modifyData => \n        modifyData.blockId === data.blockId && modifyData.set === data.set);\n\n      if(index !== -1) {\n        newModifyData.splice(index, 1);\n      } \n\n    }\n  }\n\n  return newModifyData;\n}\n\nconst sideStoreUtils = {\n  tempDataPush,\n  getContentsToBeChanged,\n  createTempData,\n  createModifyData,\n  setCreateModifyDataOfBlock,\n  setDeleteModifyDataOfBlock,\n  setUpdateModifyDataOfBlock,\n  updateModifyData,\n  convertModifyData,\n  replaceModifyData\n}\n\nexport default sideStoreUtils;","import { BlockData, ModifyData } from \"../../types\";\nimport actionBlock from \"./actions\";\nimport blockUtils from \"./blockUtils\";\nimport converter from \"./converter\";\nimport orderingBlockUtils from \"./ordering\";\nimport sideStoreUtils from \"./sideUtils\";\n\n/**\n * block - state\n */\nexport type OrderType = \"add\" | \"del\" | \"color\" | \"link\";\n\nexport interface StagedBlock{\n  id: string;\n  contents: any;\n  blockIndex: number;\n}\n\n// export interface TempData {\n//   type: string;\n//   data: any;\n// }\n\nexport interface ChangeEditorStateProps {\n  isGrab?: boolean;\n  isHoldingDown?: boolean;\n  isCliping?: boolean;\n}\n\nexport interface BlockStateProps {\n  blockList?: BlockData[];\n  modifyData?: ModifyData[];\n}\n\nexport type SetBlockDataList = {\n  [type: string]: BlockData[];\n}\n\n/** \n * temp Data\n*/\nexport type TempSet = \"block\" | \"comment\"; \n\nexport interface TempData<T = any> {\n  blockId: string;\n  payload: T;\n}\n\nexport interface TempDataType {\n  editingBlockId?: string;\n  nextBlockInfo?: NextBlockInfo;\n  create?: TempData<BlockData>[];\n  update?: TempData[];\n  delete?: TempData[];\n}\n\nexport interface ResBlockUtils {\n  blockList: BlockData[];\n  modifyData: ModifyData[];\n  tempData: TempDataType;\n}\n\nexport interface NextTextBlockInfo {\n  type: \"text\",\n  payload: [string, any];\n}\n\nexport type NextBlockInfo = NextTextBlockInfo | { type: string, payload: any } | null;\n\nexport interface BlockState {\n  isFetch: boolean;\n  isGrab: boolean;\n  isHoldingDown: boolean;\n  isCliping: boolean;\n  targetPosition: string | null;\n  blockList: BlockData[];\n  editingBlockId: string | null;\n  nextBlockInfo: NextBlockInfo;\n  stage: StagedBlock[];\n  modifyData: ModifyData[];\n  tempFront: TempDataType[];\n  tempBack: TempDataType[];\n  tempClipData: number[];\n  clipBoard: BlockData[];\n}\n\nexport interface BlockStateProps {\n  isFetch?: boolean;\n  isGrab?: boolean;\n  isHoldingDown?: boolean;\n  isCliping?: boolean;\n  targetPosition?: string | null;\n  blockList?: BlockData[];\n  editingBlockId?: string | null;\n  nextBlockInfo?: NextBlockInfo;\n  stage?: StagedBlock[];\n  modifyData?: ModifyData[];\n  tempFront?: TempDataType[];\n  tempBack?: TempDataType[];\n  tempClipData?: number[];\n  clipBoard?: BlockData[];\n}\n\n/**\n * action type\n */\nexport const INIT_BLOCK_STATE       = 'INIT_BLOCK_STATE' as const;\nexport const RESET_BLOCK            = 'RESET_BLOCK' as const;\nexport const CHANGE_EDITING_ID      = 'CHANGE_EDITING_ID' as const;\nexport const ADD_BLOCK              = 'ADD_BLOCK' as const;\nexport const ADD_TEXT_BLOCK         = 'ADD_TEXT_BLOCK' as const;\nexport const EDIT_BLOCK             = 'EDIT_BLOCK' as const;\nexport const COMMIT_BLOCK           = 'COMMIT_BLOCK' as const;\nexport const CHANGE_BLOCK_CONTENTS  = 'CHANGE_BLOCK_CONTENTS' as const;\nexport const DELETE_BLOCK           = 'DELETE_BLOCK' as const;\nexport const DELETE_TEXT_BLOCK      = 'DELETE_TEXT_BLOCK' as const;\nexport const UPDATE_BLOCK           = 'UPDATE_BLOCK' as const; // DB에 업데이트할 때\nexport const SWITCH_BLOCK           = 'SWITCH_BLOCK' as const;\nexport const REVERT_BLOCK           = 'REVERT_BLOKC' as const;\nexport const CHANGE_TEXT_STYLE      = 'CHANGE_TEXT_STYLE' as const;\nexport const SET_CLIPBOARD          = 'SET_CLIPBOARD' as const;\nexport const CLEAR_CLIPBOARD        = 'CLEAR_CLIPBOARD' as const;\nexport const SET_TEMPCLIP           = 'SET_TEMPCLIP' as const;\nexport const CLEAR_TEMPCLIP         = 'CLEAR_TEMPCLIP' as const;\nexport const CHANGE_EDITOR_STATE    = 'CHANGE_EDITOR_STATE' as const;\nexport const CHANGE_TARGET_POSITION = 'CHANGE_TARGET_POSITION' as const;\nexport const EDITOR_STATE_RESET     = 'EDITOR_STATE_RESET' as const;\nexport const CHANGE_FETCH_STATE     = 'CHANGE_FETCH_STATE' as const;\nexport const CHANGE_STYLE_TYPE      = 'CHANGE_STYLE_TYPE' as const;\nexport const CLEAR_MODIFYDATA       = 'CLEAR_MODIFYDATA' as const;\nexport const CLEAR_NEXTBLOCKINFO    = 'CLEAR_NEXTBLOCKINFO' as const;\nexport const SET_NEXTBLOCKINFO      = 'CLEAR_NEXTBLOCKINFO' as const;\n\nexport const TEST_CLIPBOARD    = 'TEST_CLIPBOARD' as const;\n\nexport type BLOCK_ACTION_TYPES = \n  typeof INIT_BLOCK_STATE\n  | typeof RESET_BLOCK \n  | typeof ADD_BLOCK\n  | typeof ADD_TEXT_BLOCK\n  | typeof EDIT_BLOCK\n  | typeof COMMIT_BLOCK\n  | typeof CHANGE_BLOCK_CONTENTS\n  | typeof DELETE_BLOCK\n  | typeof DELETE_TEXT_BLOCK\n  | typeof UPDATE_BLOCK\n  | typeof SWITCH_BLOCK\n  | typeof REVERT_BLOCK\n  | typeof CHANGE_TEXT_STYLE\n  | typeof SET_CLIPBOARD\n  | typeof CLEAR_CLIPBOARD\n  | typeof SET_CLIPBOARD\n  | typeof CLEAR_TEMPCLIP\n  | typeof CHANGE_EDITOR_STATE\n  | typeof CHANGE_TARGET_POSITION\n  | typeof TEST_CLIPBOARD\n  | typeof CHANGE_STYLE_TYPE\n  | typeof CHANGE_FETCH_STATE\n  | typeof CLEAR_MODIFYDATA\n  | typeof SET_NEXTBLOCKINFO\n  | typeof CLEAR_NEXTBLOCKINFO\n;\n\n/**\n * Actions\n */\nexport const initBlockState       = actionBlock.initBlockState;\nexport const resetBlock           = actionBlock.resetBlock;\nexport const addBlock             = actionBlock.addBlock;\nexport const addTextBlock         = actionBlock.addTextBlock;\nexport const changeEditingId      = actionBlock.changeEditingId;\nexport const editBlock            = actionBlock.editBlock;\nexport const commitBlock          = actionBlock.commitBlock;\nexport const changeBlockContents  = actionBlock.changeBlockContents;\nexport const deleteBlock          = actionBlock.deleteBlock;\nexport const deleteTextBlock      = actionBlock.deleteTextBlock;\nexport const updateBlock          = actionBlock.updateBlock;\nexport const changeTextStyle      = actionBlock.changeTextStyle;\nexport const revertBlock          = actionBlock.revertBlock;\nexport const switchBlock          = actionBlock.switchBlock;\nexport const setClipboard         = actionBlock.setClipboard;\nexport const clearClipboard       = actionBlock.clearClipboard;\nexport const setTempClip          = actionBlock.setTempClip;\nexport const clearTempClip        = actionBlock.clearTempClip;\nexport const changeEditorState    = actionBlock.chageEditorState;\nexport const changeTargetPosition = actionBlock.changeTargetPosition;\nexport const resetEditorState     = actionBlock.resetEditorState;\nexport const changeFetchState     = actionBlock.changeFetchState;\nexport const changeStyleType      = actionBlock.changeStyleType;\nexport const clearModifyData      = actionBlock.clearModifyData;\nexport const clearNextBlockInfo   = actionBlock.clearNextBlockInfo;\nexport const setNextBlockInfo     = actionBlock.setNextBlockInfo;\n\nexport const testClipAdd     = actionBlock.testClipAdd;\n\nexport type BlockActions = ReturnType<typeof initBlockState>\n  | ReturnType<typeof resetBlock>\n  | ReturnType<typeof addBlock>\n  | ReturnType<typeof addTextBlock>\n  | ReturnType<typeof changeEditingId>\n  | ReturnType<typeof editBlock>\n  | ReturnType<typeof commitBlock>\n  | ReturnType<typeof changeBlockContents>\n  | ReturnType<typeof deleteBlock>\n  | ReturnType<typeof deleteTextBlock>\n  | ReturnType<typeof updateBlock>\n  | ReturnType<typeof changeTextStyle>\n  | ReturnType<typeof revertBlock>\n  | ReturnType<typeof switchBlock>\n  | ReturnType<typeof setClipboard>\n  | ReturnType<typeof clearClipboard>\n  | ReturnType<typeof setTempClip>\n  | ReturnType<typeof clearTempClip>\n  | ReturnType<typeof changeEditorState>\n  | ReturnType<typeof changeTargetPosition>\n  | ReturnType<typeof testClipAdd>\n  | ReturnType<typeof resetEditorState>\n  | ReturnType<typeof changeFetchState>\n  | ReturnType<typeof changeStyleType>\n  | ReturnType<typeof clearModifyData>\n  | ReturnType<typeof clearNextBlockInfo>\n  | ReturnType<typeof setNextBlockInfo>\n;\n\n//converter\nexport const addContentsStyle        = converter.addContentsStyle;\nexport const changeStyleTextContents = converter.changeStyleTextContents;\nexport const deleteContentsStyle     = converter.deleteContentsStyle;\nexport const parseHtmlContents       = converter.parseHtmlContents;\nexport const sliceTextContents       = converter.sliceTextContents;\nexport const mergeTextContents       = converter.mergeTextContents;\n\n// block order utils;\nexport const sortBlock     = orderingBlockUtils.sortBlock;\nexport const orderingBlock = orderingBlockUtils.orderingBlock;\nexport const initBlock     = orderingBlockUtils.initBlock;\nexport const setBlockList  = orderingBlockUtils.setBlockList;\n\n// block utils\nexport const copyToNewObjectArray  = blockUtils.copyToNewObjectArray;\nexport const createBlockData       = blockUtils.createBlockData;\nexport const resetToTargetPosition = blockUtils.resetToTargetPosition;\nexport const reissueBlockId        = blockUtils.reissueBlockId;\nexport const updateBlockContents   = blockUtils.updateBlockContents;\nexport const changeBlockTextStyle  = blockUtils.changeBlockTextStyle;\nexport const addToStage            = blockUtils.addToStage;\nexport const addBlockInList        = blockUtils.addBlockInList;\nexport const removeBlockInList     = blockUtils.removeBlockInList;\nexport const removeTextBlockInList = blockUtils.removeTextBlockInList;\nexport const changeBlockPosition   = blockUtils.changeBlockPosition;\nexport const switchBlockList       = blockUtils.switchBlockList;\nexport const restoreBlock          = blockUtils.restoreBlock;\nexport const changeBlockStyleType  = blockUtils.changeBlockStyleType;\nexport const updateBlockData       = blockUtils.updateBlockData;\n\n// side utils \nexport const tempDataPush               = sideStoreUtils.tempDataPush;\nexport const getContentsToBeChanged     = sideStoreUtils.getContentsToBeChanged;\nexport const createTempData             = sideStoreUtils.createTempData;\nexport const createModifyData           = sideStoreUtils.createModifyData;\nexport const updateModifyData           = sideStoreUtils.updateModifyData;\nexport const setCreateModifyDataOfBlock = sideStoreUtils.setCreateModifyDataOfBlock;\nexport const setUpdateModifyDataOfBlock = sideStoreUtils.setUpdateModifyDataOfBlock;\nexport const setDeleteModifyDataOfBlock = sideStoreUtils.setDeleteModifyDataOfBlock;\nexport const convertModifyData          = sideStoreUtils.convertModifyData;\nexport const replaceModifyData          = sideStoreUtils.replaceModifyData;","import { initialBlockState } from \".\";\nimport { ActionHandlers, updateObject } from \"../../../store/utils\";\nimport { BlockData, ModifyBlockData } from \"../types\";\nimport { \n  BlockState, \n  createBlockData,\n  updateBlockContents, \n  updateModifyData, \n  tempDataPush, \n  addBlock, \n  addBlockInList, \n  deleteBlock, \n  removeBlockInList, \n  changeBlockTextStyle,\n  changeTextStyle,\n  switchBlock,\n  switchBlockList,\n  BlockStateProps,\n  restoreBlock,\n  revertBlock,\n  COMMIT_BLOCK, \n  ADD_BLOCK, \n  DELETE_BLOCK,\n  SWITCH_BLOCK,\n  CHANGE_TEXT_STYLE,\n  REVERT_BLOCK,\n  CHANGE_EDITOR_STATE,\n  EDIT_BLOCK,\n  CHANGE_TARGET_POSITION,\n  addToStage,\n  editBlock,\n  changeTargetPosition,\n  changeEditingId,\n  CHANGE_EDITING_ID,\n  changeEditorState,\n  setTempClip,\n  SET_TEMPCLIP,\n  CLEAR_CLIPBOARD,\n  EDITOR_STATE_RESET,\n  resetEditorState,\n  clearTempClip,\n  commitBlock,\n  changeFetchState,\n  CHANGE_FETCH_STATE,\n  changeStyleType,\n  changeBlockStyleType,\n  CHANGE_STYLE_TYPE,\n  clearModifyData,\n  CLEAR_MODIFYDATA,\n  initBlockState,\n  initBlock,\n  resetBlock,\n  RESET_BLOCK,\n  INIT_BLOCK_STATE,\n  updateBlock,\n  updateBlockData,\n  UPDATE_BLOCK,\n  replaceModifyData,\n  changeBlockContents,\n  CHANGE_BLOCK_CONTENTS,\n  createModifyData,\n  createTempData,\n  deleteTextBlock,\n  DELETE_TEXT_BLOCK,\n  removeTextBlockInList,\n  clearNextBlockInfo,\n  setNextBlockInfo,\n  CLEAR_NEXTBLOCKINFO,\n  SET_NEXTBLOCKINFO,\n  addTextBlock,\n  sliceTextContents,\n  parseHtmlContents,\n  ADD_TEXT_BLOCK,\n  TempDataType\n} from \"./utils\";\n\nfunction initBlockStateHandler(\n  state: BlockState,\n  { payload }: ReturnType<typeof initBlockState>\n): BlockState {\n  const { blockList, modifyData } = initBlock(payload);\n\n  return updateObject<BlockState, BlockStateProps>(state, \n    updateObject<BlockState, BlockStateProps>(initialBlockState, {\n      blockList: blockList,\n      modifyData,\n      isFetch: modifyData[0]? true : false\n    })\n  );\n}\n\nfunction resetBlockHandler(\n  state: BlockState,\n  action: ReturnType<typeof resetBlock>\n): BlockState {\n  return initialBlockState;\n}\n\nfunction changeEditingIdHandler(\n  state: BlockState, \n  { payload }: ReturnType<typeof changeEditingId>\n): BlockState {\n  if(typeof payload === \"string\") {\n    return updateObject<BlockState, BlockStateProps>(state, {\n      editingBlockId: payload\n    });\n  } else if(payload === undefined) {\n    return updateObject<BlockState, BlockStateProps>(state, {\n      editingBlockId: null\n    });\n  } else {\n    return updateObject<BlockState, BlockStateProps>(state, {\n      editingBlockId: state.blockList[payload]? state.blockList[payload].id : null\n    });\n  }\n}\n\nfunction editBlockHandler(\n  state: BlockState, \n  { payload: { blockId, blockIndex, contents } }: ReturnType<typeof editBlock>\n): BlockState {\n  return updateObject<BlockState, BlockStateProps>(state, {\n    stage: addToStage(state.stage, blockId, blockIndex, contents)\n  });\n}\n\nfunction commitBlockHandler(\n  state: BlockState,\n  action: ReturnType<typeof commitBlock>\n): BlockState {\n  if(!state.stage[0]) return state;\n\n  const { blockList, modifyData, tempData } = updateBlockContents(state.blockList, state.stage);\n  \n  tempData.editingBlockId = state.editingBlockId;\n\n  return updateObject<BlockState, BlockStateProps>(state, {\n    blockList,\n    stage: [],\n    modifyData: updateModifyData(state.modifyData, modifyData),\n    tempBack: tempDataPush(state.tempBack, tempData),\n    isFetch: true\n  });\n}\n\nfunction changeBlockContentsHandler(\n  state: BlockState,\n  { payload: { index, contents } }: ReturnType<typeof changeBlockContents>\n): BlockState {\n  const blockList = state.blockList.concat();\n  const tempBack: TempDataType = {\n    editingBlockId: state.editingBlockId,\n    update: [\n      createTempData(blockList[index].id, {\n        contents: blockList[index].contents.concat()\n      })\n    ]\n  };\n  const modifyData = [createModifyData(\"update\", \"block\", blockList[index].id, {\n    contents: contents\n  })];\n\n  blockList[index].contents = contents;\n\n  return updateObject<BlockState, BlockStateProps>(state, {\n    blockList,\n    tempBack: tempDataPush(state.tempBack, tempBack),\n    modifyData: updateModifyData(state.modifyData, modifyData)\n  })\n}\n\nfunction addBlockHandler(\n  state: BlockState, \n  { \n    payload: { addBlockList, targetPosition, nextEditInfo } \n  }: ReturnType<typeof addBlock>\n): BlockState {\n  const { blockList, modifyData, tempData } = addBlockInList(state.blockList, addBlockList, targetPosition);\n\n  tempData.editingBlockId = state.editingBlockId;\n\n  const editingBlockId: string | null = nextEditInfo !== undefined? \n    typeof nextEditInfo === \"string\"? \n    nextEditInfo \n    : blockList[nextEditInfo].id\n    : null;\n\n  return updateObject<BlockState, BlockStateProps>(state, {\n    blockList,\n    editingBlockId,\n    modifyData: updateModifyData(\n      state.modifyData, \n      modifyData\n    ),\n    tempBack: tempDataPush(state.tempBack, tempData),\n    tempFront: [],\n    isFetch: true\n  });\n}\n\nfunction addTextBlockHandler(\n  state: BlockState, \n  { payload: {\n    index, innerHTML, cursorStart, cursorEnd\n  } }: ReturnType<typeof addTextBlock>\n): BlockState {  \n  const [ front, back ] = sliceTextContents(parseHtmlContents(innerHTML), cursorStart, cursorEnd);\n  const block = state.blockList[index];\n\n  const blockContents = block.contents.concat();\n\n  block.contents = front;\n\n  const stage = state.stage[0]? \n    state.stage.filter(data => data.id !== block.id) \n    : [];\n\n  const newBlock = createBlockData({\n    position: block.position,\n    type: block.type,\n    styleType: block.styleType,\n    contents: back\n  });\n\n  const { blockList, tempData, modifyData } = addBlockInList(state.blockList, [newBlock], newBlock.position);\n\n  tempData.editingBlockId = state.editingBlockId;\n\n  const findIndex = tempData.update.findIndex(data => data.blockId === block.id);\n  \n  if(findIndex !== -1) {\n    tempData.update[findIndex].payload = updateObject(tempData.update[findIndex].payload, {\n      contents: blockContents\n    });\n  } else {\n    tempData.update.push(createTempData(block.id, {\n      contents: blockContents\n    }));\n  }\n\n  modifyData.push(createModifyData(\"update\", \"block\", block.id, {\n    contents: front\n  }));\n\n  return updateObject<BlockState, BlockStateProps>(state, {\n    blockList,\n    stage: stage,\n    editingBlockId: newBlock.id,\n    tempBack: tempDataPush(state.tempBack, tempData),\n    modifyData: updateModifyData(state.modifyData, modifyData),\n    isFetch: true\n  });\n}\n\nfunction deleteBlockHandler(\n  state: BlockState,\n  { payload: { removedBlockList, nextEditInfo } }: ReturnType<typeof deleteBlock>\n): BlockState {\n  const { blockList, modifyData, tempData } = removeBlockInList(state.blockList, removedBlockList);\n\n  tempData.editingBlockId = state.editingBlockId;\n\n  const editingBlockId: string | null = nextEditInfo !== undefined? \n    typeof nextEditInfo === \"string\"? \n    nextEditInfo \n    : blockList[nextEditInfo].id\n    : null;\n\n  const removeBlockIdList = removedBlockList.map(block => block.id);\n\n\n  return updateObject<BlockState, BlockStateProps>(state, {\n    blockList,\n    editingBlockId,\n    stage: state.stage? state.stage.filter(data => !removeBlockIdList.includes(data.id)) : [],\n    tempBack: tempDataPush(state.tempBack, tempData),\n    tempFront: [],\n    modifyData: updateModifyData(state.modifyData, modifyData),\n    isFetch: true\n  });\n}\n\nfunction deleteTextBlockHandler(\n  state: BlockState,\n  { payload: {\n    index,\n    innerHTML,\n    textLength\n  } }: ReturnType<typeof deleteTextBlock>\n): BlockState {\n  const toBeDeletedBlock: BlockData = updateObject<BlockData, ModifyBlockData>(state.blockList[index], {});\n  const editingBlockId: string = index? state.blockList[index - 1].id : state.blockList[0].id;\n\n  if(innerHTML) {\n    if(index === 0) return state;\n\n    const result = removeTextBlockInList(state.blockList, index, index - 1, innerHTML);\n    \n    if(!result) return state;\n\n    const { blockList, tempData, modifyData } = result;\n\n    const stage = state.stage[0]?  \n      state.stage.filter(data => data.id !== toBeDeletedBlock.id) \n      : [];\n\n    return updateObject<BlockState, BlockStateProps>(state, {\n      blockList,\n      editingBlockId,\n      nextBlockInfo: {\n        type: \"text\",\n        payload: [\"delete\", textLength]\n      },\n      tempBack: tempDataPush(state.tempBack, tempData),\n      modifyData: updateModifyData(state.modifyData, modifyData),\n      tempFront: [],\n      stage,\n      isFetch: true\n    });\n\n  } else if(!innerHTML) {\n\n    const { \n      blockList,  \n      tempData,\n      modifyData\n    } = removeBlockInList(state.blockList.concat(), [state.blockList[index]]);\n\n    return updateObject<BlockState, BlockStateProps>(state, {\n      blockList,\n      editingBlockId,\n      tempBack: tempDataPush(state.tempBack, tempData),\n      tempFront: [],\n      modifyData: updateModifyData(state.modifyData, modifyData),\n      isFetch: true\n    });\n\n  } else {\n    return state;\n  }\n}\n\nfunction changeTextStyleHandler(\n  state: BlockState, \n  { payload: { \n    index, styleType, startPoint, endPoint, order \n  } }: ReturnType<typeof changeTextStyle>\n): BlockState {\n\n  const result = changeBlockTextStyle(\n    state.blockList, \n    index, \n    styleType, \n    startPoint, \n    endPoint, \n    order\n  );\n  \n  if(!result) return state;\n\n  result.tempData.editingBlockId = state.editingBlockId;\n\n  return updateObject<BlockState, BlockStateProps>(state, {\n    blockList: result.blockList,\n    modifyData: updateModifyData(state.modifyData, result.modifyData),\n    tempFront: [],\n    tempBack: tempDataPush(state.tempBack, result.tempData),\n    isFetch: true\n  });\n}\n\nfunction switchBlockHandler(\n  state: BlockState, \n  { payload: { \n    changedBlockIdList, container \n  } }: ReturnType<typeof switchBlock>\n): BlockState {\n  if(!state.targetPosition) return state;\n\n  const result = switchBlockList(state.blockList, changedBlockIdList, state.targetPosition, container);\n  \n  if(!result) return updateObject<BlockState, BlockStateProps>(state, {\n    tempClipData: [],\n    isGrab: false,\n    isHoldingDown: false,\n  });\n\n  const { blockList, tempData, modifyData } = result;\n\n  tempData.editingBlockId = state.editingBlockId;\n\n  return updateObject<BlockState, BlockStateProps>(state, {\n    isGrab: false,\n    isHoldingDown: false,\n    editingBlockId: state.blockList[state.tempClipData[0]].id,\n    blockList,\n    modifyData: updateModifyData(state.modifyData, modifyData),\n    tempFront: [],\n    tempBack: tempDataPush(state.tempBack, tempData),\n    tempClipData: [],\n    isFetch: true\n  });\n}\n\nfunction revertBlockHandler(\n  state: BlockState,\n  { front }: ReturnType<typeof revertBlock>\n): BlockState {\n  console.log(\"revert\", state);\n\n  if(!front && state.tempBack[0]) {\n    const length = state.tempBack.length - 1;\n    const editingBlockId = state.tempBack[length].editingBlockId? state.tempBack[length].editingBlockId : null;\n    const { blockList, tempData, modifyData } = restoreBlock(state.blockList, state.tempBack[length]);\n    const tempBack = state.tempBack.concat();\n    tempBack.pop();\n    tempData.editingBlockId = state.editingBlockId;\n\n    console.log(tempBack);\n\n    return updateObject<BlockState, BlockStateProps>(state, {\n      editingBlockId,\n      blockList,\n      tempBack,\n      tempFront: tempDataPush(state.tempFront, tempData),\n      modifyData: updateModifyData(state.modifyData, modifyData),\n      isFetch: true\n    });\n\n  } else if(state.tempFront[0]) {\n    const length = state.tempFront.length - 1;\n    const editingBlockId = state.tempFront[length].editingBlockId? state.tempFront[length].editingBlockId : null;\n    const { blockList, tempData, modifyData } = restoreBlock(state.blockList, state.tempFront[length]);\n    const tempFront = state.tempFront.concat();\n    tempFront.pop();\n    tempData.editingBlockId = state.editingBlockId;\n\n    console.log(tempFront);\n\n    return updateObject<BlockState, BlockStateProps>(state, {\n      blockList,\n      editingBlockId,\n      tempFront,\n      tempBack: tempDataPush(state.tempBack, tempData),\n      modifyData: updateModifyData(state.modifyData, modifyData),\n      isFetch: true\n    });\n\n  } else {\n    return state;\n  }\n\n}\n\nfunction changeEditorStateHandler(\n  state: BlockState, { \n    payload: { isGrab, isHoldingDown, isCliping } \n  }: ReturnType<typeof changeEditorState>\n): BlockState {\n\n  return updateObject<BlockState, BlockStateProps>(state, {\n    isGrab: isGrab !== undefined? isGrab : state.isGrab,\n    isCliping: isCliping !== undefined? isCliping : state.isCliping,\n    isHoldingDown: isHoldingDown !== undefined? isHoldingDown : state.isHoldingDown\n  });\n}\n\nfunction changeTargetPositionHandler(\n  state: BlockState,\n  { payload: { targetPosition } }: ReturnType<typeof changeTargetPosition>\n): BlockState {\n\n  return updateObject<BlockState, BlockStateProps>(state, {\n    targetPosition: targetPosition? targetPosition : null\n  });\n}\n\nfunction setTempClipHandler(\n  state: BlockState,\n  { payload }: ReturnType<typeof setTempClip>\n): BlockState {\n\n  // if(state.tempClipData[0]) {\n  //   const length = state.tempClipData.length;\n  //   let tempClipData = state.tempClipData.concat();\n\n  //   if(length > 1 && tempClipData[length - 2] === payload) {\n  //     tempClipData.pop();\n  //   } else {\n  //     if(tempClipData[length - 1] !== payload) tempClipData.push(payload);\n  //   }\n\n  //   return updateObject<BlockState, BlockStateProps>(state, {\n  //     tempClipData\n  //   });\n  // } else {\n  //   return updateObject<BlockState, BlockStateProps>(state, {\n  //     tempClipData: [payload]\n  //   });\n\n  // }\n\n  return updateObject<BlockState, BlockStateProps>(state, {\n    tempClipData: state.tempClipData.concat(payload)\n  })\n}\n\nfunction clearTempClipDataHandler(\n  state: BlockState, \n  action: ReturnType<typeof clearTempClip>\n): BlockState {\n  return updateObject<BlockState, BlockStateProps>(state, {\n    tempClipData: []\n  });\n}\n\nfunction editorStateResetHandler(\n  state: BlockState, \n  { payload }: ReturnType<typeof resetEditorState>\n): BlockState {\n  return updateObject<BlockState, BlockStateProps>(state, {\n    isCliping: payload? false : state.isCliping,\n    isHoldingDown: false,\n    isGrab: false,\n    tempClipData: [],\n    targetPosition: null\n  });\n}\n\nfunction changeFetchStateHandler(\n  state: BlockState,\n  { payload }: ReturnType<typeof changeFetchState>\n): BlockState {\n  return updateObject<BlockState, BlockStateProps>(state, {\n    isFetch: payload? true : false\n  });\n}\n\nfunction changeStyleTypeHandler(\n  state: BlockState, \n  { payload: {\n    blockInfo, styleType\n  }}: ReturnType<typeof changeStyleType>\n): BlockState {\n  const result = changeBlockStyleType(state.blockList, blockInfo, styleType);\n\n  if(!result) {\n    return state;\n  } else {\n    const { blockList, modifyData, tempData } = result;\n    \n    tempData.editingBlockId = state.editingBlockId;\n\n    return updateObject<BlockState, BlockStateProps>(state, {\n      blockList,\n      isFetch: true,\n      tempBack: tempDataPush(state.tempBack, tempData),\n      modifyData: updateModifyData(state.modifyData, modifyData)\n    })\n  }\n}\n\nfunction clearModifyDataHandler(\n  state: BlockState,\n  action: ReturnType<typeof clearModifyData>\n): BlockState {\n  return updateObject<BlockState, BlockStateProps>(state, {\n    modifyData: []\n  });\n}\n\nfunction updateBlockHandler(\n  state: BlockState,\n  { payload }: ReturnType<typeof updateBlock>\n): BlockState {\n  const { blockList, tempData, modifyData } = updateBlockData(state.blockList, payload);\n  \n  tempData.editingBlockId = state.editingBlockId;\n\n  return updateObject<BlockState, BlockStateProps>(state, {\n    blockList,\n    tempBack: tempDataPush(state.tempBack, tempData),\n    modifyData: modifyData[0]? \n      updateModifyData(replaceModifyData(state.modifyData, payload), modifyData) \n      : replaceModifyData(state.modifyData, payload)\n  });\n}\n\nfunction clearNextBlockInfoHandler(\n  state: BlockState,\n  action: ReturnType<typeof clearNextBlockInfo>\n): BlockState {\n  return updateObject<BlockState, BlockStateProps>(state, {\n    nextBlockInfo: null\n  });\n}\n\nfunction setNextBlockInfoHandler(\n  state: BlockState,\n  { payload }: ReturnType<typeof setNextBlockInfo>\n): BlockState {\n  return updateObject<BlockState, BlockStateProps>(state, {\n    nextBlockInfo: payload\n  });\n}\n\nconst blockHandlers: ActionHandlers<BlockState> = {\n  [INIT_BLOCK_STATE]       : initBlockStateHandler,\n  [RESET_BLOCK]            : resetBlockHandler,\n  [CHANGE_EDITING_ID]      : changeEditingIdHandler,\n  [EDIT_BLOCK]             : editBlockHandler,\n  [COMMIT_BLOCK]           : commitBlockHandler,\n  [CHANGE_BLOCK_CONTENTS]  : changeBlockContentsHandler,\n  [ADD_BLOCK]              : addBlockHandler,\n  [ADD_TEXT_BLOCK]         : addTextBlockHandler,\n  [DELETE_BLOCK]           : deleteBlockHandler,\n  [DELETE_TEXT_BLOCK]      : deleteTextBlockHandler,\n  [CHANGE_TEXT_STYLE]      : changeTextStyleHandler,\n  [SWITCH_BLOCK]           : switchBlockHandler,\n  [REVERT_BLOCK]           : revertBlockHandler,\n  [CHANGE_EDITOR_STATE]    : changeEditorStateHandler,\n  [CHANGE_TARGET_POSITION] : changeTargetPositionHandler,\n  [SET_TEMPCLIP]           : setTempClipHandler,\n  [CLEAR_CLIPBOARD]        : clearTempClipDataHandler,\n  [EDITOR_STATE_RESET]     : editorStateResetHandler,\n  [CHANGE_FETCH_STATE]     : changeFetchStateHandler,\n  [CHANGE_STYLE_TYPE]      : changeStyleTypeHandler,\n  [CLEAR_MODIFYDATA]       : clearModifyDataHandler,\n  [UPDATE_BLOCK]           : updateBlockHandler,\n  [CLEAR_NEXTBLOCKINFO]    : clearNextBlockInfoHandler,\n  [SET_NEXTBLOCKINFO]      : setNextBlockInfoHandler\n};\n\nexport default blockHandlers;","import { createReducer } from \"../../../store/utils\";\nimport blockHandlers from \"./handler\";\nimport { BlockActions, BlockState } from \"./utils\";\n\nexport const initialBlockState: BlockState = {\n  isFetch: false,\n  isGrab: false,\n  isHoldingDown: false,\n  isCliping: false,\n  targetPosition: null,\n  blockList: [],\n  editingBlockId: null,\n  nextBlockInfo: null,\n  stage: [],\n  modifyData: [],\n  tempBack: [],\n  tempFront: [],\n  tempClipData: [],\n  clipBoard: []\n}\n\nconst blockReducer = createReducer<BlockState, BlockActions>(initialBlockState, blockHandlers);\n\nexport default blockReducer;","import { useCallback, useMemo, useReducer } from 'react';\nimport { ModifyBlockData, ModifyDataType } from '../types';\nimport { testDB } from '../db';\nimport blockReducer, { initialBlockState } from '../reducer';\nimport { \n  BlockState, \n  initBlock, \n  SetBlockDataList, \n  setBlockList, \n  addBlock, \n  commitBlock, \n  deleteBlock, \n  changeTextStyle, \n  OrderType, \n  switchBlock, \n  revertBlock, \n  editBlock, \n  changeEditingId,\n  ChangeEditorStateProps,\n  changeEditorState,\n  changeTargetPosition,\n  setTempClip,\n  clearClipboard,\n  resetEditorState,\n  changeBlockStyleType,\n  changeStyleType,\n  changeFetchState,\n  clearModifyData,\n  initBlockState,\n  updateBlock,\n  changeBlockContents,\n  deleteTextBlock,\n  clearNextBlockInfo,\n  setNextBlockInfo,\n  NextBlockInfo,\n  addTextBlock,\n  StagedBlock\n} from '../reducer/utils';\nimport { BlockData, ContentType, ModifyData, RawBlockData } from '../types';\n\n// state 값을 전부 useReducer로 통합할 것.\nfunction useBlock() {\n  const [ state, dispatch ] = useReducer(blockReducer, initialBlockState);\n\n  // state\n  const initBlock: SetBlockDataList | null = useMemo(()=>\n    setBlockList(state.blockList), [state.blockList]);\n\n  const blockLength: number = useMemo(() => state.blockList.length, [state.blockList]);\n\n  const editingBlockId: string | null = useMemo(() => state.editingBlockId, [state.editingBlockId]);\n\n  const isGrab: boolean = useMemo(() => state.isGrab, [state.isGrab]);\n\n  const isCliping: boolean = useMemo(() => state.isCliping, [state.isCliping]);\n  \n  const isHoldingDown: boolean = useMemo(() => state.isHoldingDown, [state.isHoldingDown]);\n\n  const isFetch: boolean = useMemo(() => state.isFetch, [state.isFetch]);\n\n  const stage: StagedBlock[] = useMemo(() => state.stage, [state.stage]);\n\n  const tempClipData: number[] = useMemo(() => state.tempClipData, [state.tempClipData]);\n\n  const targetPosition: string | null = useMemo(() => state.targetPosition, [state.targetPosition]);\n\n  const modifyData: ModifyData[] = useMemo(() => state.modifyData, [state.modifyData]);\n\n  const nextBlockInfo: NextBlockInfo = useMemo(() => state.nextBlockInfo, [state.nextBlockInfo]);\n\n  // dispatch\n  const onInitBlockState = useCallback((rawBlockData: RawBlockData[]) => {\n    dispatch(initBlockState(rawBlockData));\n  }, [dispatch]);\n\n  const onChangeEditorState = useCallback((payload: ChangeEditorStateProps) => {\n    dispatch(changeEditorState(payload));\n  }, [dispatch]);\n\n  const onChangeEditingId = useCallback((nextEditInfo?: string | number) => {\n    dispatch(changeEditingId(nextEditInfo));\n  }, [dispatch]);\n\n  const onEditBlock = useCallback((blockId: string, blockIndex: number, contents: string) => {\n    dispatch(editBlock(blockId, blockIndex, contents));\n  }, [dispatch]);\n\n  const onCommitBlock = useCallback(() => {\n    dispatch(commitBlock());\n  }, [dispatch]);\n\n  const onChangeBlockContents = useCallback((index: number, contents: any) => {\n    dispatch(changeBlockContents(index, contents));\n  }, [dispatch]);\n\n  const onAddBlock = useCallback((\n    blockList: BlockData[], \n    targetPosition: string,\n    nextEditInfo?: string | number\n  ) => {\n    dispatch(addBlock(blockList, targetPosition, nextEditInfo));\n  }, [dispatch]);\n\n  const onAddTextBlock = useCallback((\n    index: number,\n    innerHTML: string,\n    cursorStart: number,\n    cursorEnd: number\n  ) => {\n    dispatch(addTextBlock(index, innerHTML, cursorStart, cursorEnd));\n  }, [dispatch])\n\n  const onDeleteBlock = useCallback((\n    removedBlockList: BlockData[],\n    nextEditInfo?: string | number\n  ) => {\n    dispatch(deleteBlock(removedBlockList, nextEditInfo));\n  }, [dispatch]);\n\n  const onDeleteTextBlock = useCallback((index: number, innerHTML: string, textLength: number) => {\n    dispatch(deleteTextBlock(index, innerHTML, textLength));\n  }, [dispatch]);\n\n  const onChangeTextStyle = useCallback((\n    index: number, \n    styleType: ContentType, \n    startPoint: number,\n    endPoint: number,\n    order: OrderType\n  ) => {\n    dispatch(changeTextStyle(index, styleType, startPoint, endPoint, order));\n  }, [dispatch]);\n\n  const onSwitchBlock = useCallback((\n    changedBlockIdList: string[],\n    container?: boolean\n  ) => {\n    dispatch(switchBlock(changedBlockIdList, container))\n  }, [dispatch]);\n\n  const onRevertBlock = useCallback((front?: boolean) => {\n    dispatch(revertBlock(front));\n  }, [dispatch]);\n\n  const onChangeTargetPosition = useCallback((targetPosition?: string) => {\n    dispatch(changeTargetPosition(targetPosition));\n  }, [dispatch]);\n\n  const onSetTempClip = useCallback((index: number[]) => {\n    dispatch(setTempClip(index));\n  }, [dispatch]);\n\n  const onClearTempClip = useCallback(() => {\n    dispatch(clearClipboard());\n  }, [dispatch]);\n\n  const onResetEditorState = useCallback((isCliping: boolean) => {\n    dispatch(resetEditorState(isCliping));\n  }, [dispatch]);\n\n  const onChangeStyleType = useCallback((blockInfo: string | number, styleType: string) => {\n    dispatch(changeStyleType(blockInfo, styleType));\n  }, [dispatch]);\n\n  const onChangeFetchState = useCallback((fetchState?: boolean) => {\n    dispatch(changeFetchState(fetchState));\n  }, [dispatch]);\n\n  const onClearModifyData = useCallback(() => {\n    dispatch(clearModifyData());\n  }, [dispatch]);\n\n  const onUpdateBlock = useCallback((modifyData: ModifyDataType) => {\n    dispatch(updateBlock(modifyData));\n  }, [dispatch]);\n\n  const onClearNextBlockInfo = useCallback(() => {\n    dispatch(clearNextBlockInfo());\n  }, [dispatch]);\n\n  const onSetNextBlockInfo = useCallback((nextBlockInfo: NextBlockInfo) => {\n    dispatch(setNextBlockInfo(nextBlockInfo));\n  }, [dispatch]);\n\n  return { \n    state, \n    editingBlockId,\n    isGrab,\n    isHoldingDown,\n    isCliping,\n    isFetch,\n    stage,\n    tempClipData,\n    targetPosition,\n    modifyData,\n    nextBlockInfo,\n    onEditBlock,\n    initBlock,\n    blockLength,\n    onInitBlockState,\n    onChangeEditorState,\n    onChangeEditingId,\n    onCommitBlock,\n    onChangeBlockContents,\n    onAddBlock,\n    onAddTextBlock,\n    onDeleteBlock,\n    onDeleteTextBlock,\n    onChangeTextStyle,\n    onSwitchBlock,\n    onRevertBlock,\n    onChangeTargetPosition,\n    onSetTempClip,\n    onClearTempClip,\n    onResetEditorState,\n    onChangeStyleType,\n    onChangeFetchState,\n    onClearModifyData,\n    onUpdateBlock,\n    onClearNextBlockInfo,\n    onSetNextBlockInfo,\n  };\n}\n\nexport type UseBlockType = ReturnType<typeof useBlock>;\n\nexport default useBlock;","import { v4 as uuidv4 } from 'uuid';\n\nexport class Token {\n  static getUUID(): string{\n    const token: string[] = uuidv4().split('-');\n    const uuid: string = token[2] + token[1] + token[0] + token[3] + token[4];\n    return uuid;\n  }\n}","import { useCallback, useMemo } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { ModifyDataType } from '../components/newBlock/types';\nimport { RootState } from '../store/modules';\nimport { addPushModifyData, BklogState, resetBklog, updateBklog, getPage, updateVersion, changeUpdateState, ClearBklogStateType, clearBklogState } from '../store/modules/bklog/utils';\nimport { Token } from '../utils/token';\n\nfunction useBklog() {\n  \n  const bklogState: BklogState = useSelector((state: RootState) => state.bklog);\n  \n  const dispatch = useDispatch();\n\n  const onClearBklogState = useCallback((key: ClearBklogStateType) => {\n    dispatch(clearBklogState(key));\n  }, [dispatch]);\n\n  const onGetPage = useCallback((id: string) => {\n    console.log(\"페이지 불러오기\");\n    dispatch(getPage(id));\n  }, [dispatch]);\n\n  const onResetBklog = useCallback(() => {\n    dispatch(resetBklog());\n  }, [dispatch]);\n\n  const onAddPushModifyData = useCallback((modifyData: ModifyDataType) => {\n    dispatch(addPushModifyData(modifyData));\n  }, [dispatch]);\n\n  const onUpdateBklog = useCallback(() => {\n    if(bklogState.pageInfo && bklogState.pushModifyData) {\n      const { id } = bklogState.pageInfo;\n      const modifyData = bklogState.pushModifyData;\n\n      dispatch(updateBklog({\n        pageId: id,\n        pageVersions: {\n          current: bklogState.version,\n          next: Token.getUUID()\n        },\n        data: modifyData\n      }));\n   }\n  }, [dispatch, bklogState.pageInfo, bklogState.pushModifyData, bklogState.version]);\n\n  const onUpdateVersion = useCallback((id, preId) => {\n    dispatch(updateVersion(id, preId));\n  }, [dispatch]);\n\n  const onChangeUpdateState = useCallback((isUpdated?: boolean) => {\n    dispatch(changeUpdateState(isUpdated));\n  }, [dispatch]);\n\n  return { \n    bklogState,\n    onClearBklogState,\n    onResetBklog,\n    onGetPage,\n    onAddPushModifyData,\n    onUpdateBklog,\n    onUpdateVersion,\n    onChangeUpdateState\n  };\n}\n\nexport default useBklog;","import { useEffect, useState } from \"react\";\nimport io from \"socket.io-client\";\n\nfunction useSocket(url: string) {\n  const [ currentSocket, setCurrentSocket ] = useState<any>(null);\n\n  useEffect(() => {\n    if(!currentSocket) {\n      setCurrentSocket(io(url));\n    }\n  }, []);\n\n  return currentSocket;\n}\n\nexport default useSocket;","import { useCallback, useEffect, useMemo, useState } from \"react\";\nimport useBklog from \"../../../hooks/useBKlog\";\nimport useSocket from \"../../../hooks/useSocket\";\nimport { EditingUserInfo } from \"../../../store/modules/bklog/utils\";\nimport { convertModifyData } from \"../reducer/utils\";\nimport { ModifyDataType } from \"../types\";\nimport { UseBlockType } from \"./useBlock\";\n\nfunction useConnectRedux(useBlockReducer: UseBlockType) {\n  const socket = useSocket(\"http://localhost:4600/bklog\");\n\n  const [ newVersion, setVersion ] = useState<string | null>(null);\n  const [ updated, setUpdated ]    = useState<boolean>(false);\n\n  const {\n    bklogState, \n    onClearBklogState,\n    onUpdateBklog, \n    onAddPushModifyData, \n    onGetPage,\n    onUpdateVersion,\n    onChangeUpdateState\n  } = useBklog();\n\n  const {\n    state,\n    editingBlockId,\n    isFetch,\n    modifyData,\n    onInitBlockState,\n    onClearModifyData,\n    onUpdateBlock\n  } = useBlockReducer;\n\n  const isFetching: boolean = useMemo(() => bklogState.isFetching, [bklogState.isFetching]);\n\n  const isUpdated: boolean = useMemo(() => bklogState.isUpdated, [bklogState.isUpdated]);\n\n  const isRefresh: boolean = useMemo(() => bklogState.isRefresh, [bklogState.isRefresh]);\n\n  const pageId: string | null = useMemo(() => bklogState.pageInfo? bklogState.pageInfo.id : null, [bklogState.pageInfo]);\n\n  const pushModifyData: ModifyDataType | null = useMemo(() => bklogState.pushModifyData, [bklogState.pushModifyData]);\n\n  const currentVersion: string | null = useMemo(() => bklogState.version, [bklogState.version]);\n\n  const eventSocket = useCallback(() => {\n    if(socket) {\n\n      socket.on(\"connect\", () => {\n        console.log(\"connected\");\n      });\n\n      socket.on(\"updated\", (data: string) => {\n        console.log(`updated: ${data}`);\n        setVersion(data);\n      });\n\n      socket.on(\"disconnect\", () => {\n        console.log(\"disconnected\");\n      });\n\n      socket.on(\"editing\", (userInfo: EditingUserInfo) => {\n        console.log(userInfo);\n      });\n\n      socket.on(\"edited\", (penName: string) => {\n        console.log(penName);\n      });\n\n    }\n  }, [socket]);\n\n  // effect\n  useEffect(() => {\n    if(bklogState.blockList) {\n      onInitBlockState(bklogState.blockList);\n      onClearBklogState(\"blockList\");\n      onClearModifyData();\n    }\n  }, [bklogState.blockList]);\n\n  useEffect(() => {\n    if(isFetch && !isFetching && modifyData[0]) {\n      onAddPushModifyData(convertModifyData(state.modifyData));\n    }\n  }, [modifyData]);\n\n  useEffect(() => {\n    if(isUpdated && socket) {\n      socket.emit(\"update\", [bklogState.pageInfo.id, currentVersion]);\n      onChangeUpdateState();\n      onClearModifyData();\n    } \n  }, [isUpdated]);\n\n  useEffect(onUpdateBklog, [pushModifyData]);\n\n  useEffect(eventSocket, [socket]);\n\n  useEffect(() => {\n    if(socket && pageId) {\n      socket.emit(\"roomjoin\", pageId);\n    }\n  }, [socket, pageId]);\n\n  useEffect(() => {\n    if(newVersion && currentVersion) {\n      onUpdateVersion(newVersion, currentVersion);\n      setVersion(null);\n    }\n  }, [newVersion]);\n\n  useEffect(() => {\n    if(bklogState.pullModifyData) { \n      onUpdateBlock(bklogState.pullModifyData);\n      setUpdated(true);\n    }\n  }, [bklogState.pullModifyData]);\n\n  useEffect(() => {\n    if(isRefresh) onGetPage(bklogState.pageInfo.id);\n  }, [isRefresh]);\n\n  useEffect(() => {\n    if(socket && pageId) {\n      if(editingBlockId) {\n        socket.emit(\"edit\", [ pageId, {\n          penName: \"junhee\",\n          editingId: editingBlockId\n        }]);\n      } else {\n        socket.emit(\"edited\", [ pageId, \"junhee\"]);\n      }\n    }\n  }, [editingBlockId]);\n\n  useEffect(() => {\n    if(updated) {\n      const timer = setTimeout(() => {\n        setUpdated(false);\n      }, 1500);\n\n      return () => clearTimeout(timer);\n    }\n  }, [updated]);\n\n  return {\n    updated\n  };\n}\n\nexport default useConnectRedux;","import React, { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport { ParentInfoType } from \"../components/Block\";\nimport { BlockData } from \"../types\";\nimport { UseBlockType } from \"./useBlock\";\n\nconst convertArg = (arg: any[]): string => {\n  if(arg.length === 1) return `${arg[0]}`;\n  return arg.reduce((acc, cur) =>  !acc? `${cur}` : `${acc}-${cur}`);\n}\n\nfunction calculatrionPosition(\n  position: string, \n  command: \"next\" | \"child\" \n) {\n  switch (command) {\n    case \"child\":\n      const currentPosition = position.split(/-/);\n      currentPosition.push(\"1\");\n      return convertArg(currentPosition);\n    case \"next\":\n      return position;\n    default:\n      return position;\n  }\n}\n\nfunction useBlockBase(blockData: BlockData, useBlockReducer: UseBlockType, parentInfo?: ParentInfoType) {\n  const {\n    state,\n    initBlock,\n    onSwitchBlock,\n    isCliping,\n    isHoldingDown,\n    isGrab,\n    tempClipData,\n    onChangeEditingId,\n    onChangeEditorState,\n    onChangeTargetPosition,\n    onSetTempClip,\n    onClearTempClip\n  } = useBlockReducer;\n\n  const [ isHover, setHover ]   = useState<boolean>(false);\n  const [ selected, setSelect ] = useState<boolean>(false);\n  const [ down, setDown ]       = useState<boolean>(false);\n  const [ right, setRight ]     = useState<boolean>(false);\n\n  const parentSelected = parentInfo? parentInfo.selected : false;\n\n  const childrenBlockData = useMemo(() => initBlock.hasOwnProperty(blockData.id)? \n    initBlock[blockData.id] : null, [initBlock]); \n\n  const downPosition = useMemo(() => \n    calculatrionPosition(blockData.position, parentInfo && parentInfo.type === \"container\"? \"child\" : \"next\"), \n  [blockData.position]);\n\n  const rightPosition = useMemo(() => \n    calculatrionPosition(blockData.position, parentInfo && parentInfo.type === \"container\"? \"next\" : \"child\"), \n  [blockData.position]);\n\n  const handleSelectMouseEnter = useCallback((\n    position: string, \n    set: React.Dispatch<React.SetStateAction<boolean>>\n  ) => () => {\n    if(isGrab && !selected && !parentSelected) {\n      set(true);\n      onChangeTargetPosition(position);\n    }\n  }, [tempClipData, isCliping, isGrab]);\n\n  const handleSelectMouseLeave = useCallback((set: React.Dispatch<React.SetStateAction<boolean>>) => () => {\n    set(false);\n  }, []);\n\n  const handleSelectMouseUp = useCallback((container?: boolean) => () => {\n    if(tempClipData[0] !== undefined) onSwitchBlock(tempClipData.map(index => state.blockList[index].id), container);\n  }, [tempClipData, isGrab]);\n\n  const handleGrabMouseDown = useCallback(() => {\n    onChangeEditorState({ isGrab: true });\n    onChangeEditingId(null);\n    if(!isCliping) {\n      if(childrenBlockData) {\n        onSetTempClip([blockData.index, ...childrenBlockData.map(child => child.index)]);\n      } else {\n        onSetTempClip([blockData.index]);\n      } \n    }\n  }, [isCliping, childrenBlockData, blockData.index]);\n\n  const handleContentsHover = useCallback(() => {\n    if(!isGrab) setHover(true);\n  }, [isGrab]);\n\n  const handleContentsBlur = useCallback(() => {\n    setHover(false);\n  }, []);\n\n  const handleContentsMouseLeave = useCallback(() => {\n    setHover(false);\n  }, []);\n\n  useEffect(() => {\n    if(!isGrab && (down || right)) {\n      setDown(false);\n      setRight(false);\n      setSelect(false);\n      if(!isCliping) onClearTempClip();\n    }\n  }, [isGrab]);\n\n  useEffect(() => {\n    if(tempClipData.includes(blockData.index)) {\n      setSelect(true);\n    } else {\n      setSelect(false);\n    }\n  }, [tempClipData]);\n\n  useEffect(() => {\n    if(parentSelected && childrenBlockData) {\n      onSetTempClip(childrenBlockData.map(child => child.index));\n    }\n  }, [parentSelected]);\n\n  return {\n    parentSelected,\n    isHover,\n    setHover,\n    selected,\n    setSelect,\n    down,\n    setDown,\n    setRight,\n    childrenBlockData,\n    downPosition,\n    rightPosition,\n    handleSelectMouseEnter,\n    handleSelectMouseLeave,\n    handleSelectMouseUp,\n    handleGrabMouseDown,\n    handleContentsHover,\n    handleContentsMouseLeave,\n    handleContentsBlur\n  }\n}\n\nexport type UseBlockBaseType = ReturnType<typeof useBlockBase>;\n\nexport default useBlockBase;","import React from \"react\";\nimport { UseBlockType } from \"../hooks/useBlock\";\nimport { BlockData } from \"../types\";\nimport Block, { ParentInfoType } from \"./Block\";\n\ninterface ChildrenBlockProps {\n  childrenBlockData: BlockData[] | null;\n  useBlockReducer: UseBlockType;\n  parentInfo: ParentInfoType;\n}\n\nconst ChildrenBlock: React.FC<ChildrenBlockProps> = ({ childrenBlockData, useBlockReducer, parentInfo }) => {\n  return (\n    <>\n      { \n        childrenBlockData ? \n        childrenBlockData.map((child: any)=> \n          <Block\n            key={child.id}\n            blockData={child}\n            useBlockReducer={useBlockReducer}\n            parentInfo={parentInfo}\n          />\n        ) : null\n      }\n    </>\n  );\n}\n\nexport default ChildrenBlock;","import React from \"react\";\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faGripVertical, faPlus } from '@fortawesome/free-solid-svg-icons';\nimport useBlockBase from \"../../hooks/useBlockBase\";\nimport { BlockProps, ParentInfoType } from \"../Block\";\nimport ChildrenBlock from \"../ChildrenBlock\";\nimport classNames from \"classnames\";\n\ninterface BaseBlockZoneProps extends BlockProps {\n  children: (\n    selected: boolean, \n    setSelect: React.Dispatch<React.SetStateAction<boolean>>\n  ) => React.ReactNode;\n  parentInfo?: ParentInfoType | undefined;\n}\n\nconst BaseBlockZone: React.FC<BaseBlockZoneProps> = ({ \n  blockData, useBlockReducer, parentInfo, children \n}) => {\n  const {\n    parentSelected,\n    isHover,\n    selected,\n    setSelect,\n    down, \n    setDown,\n    childrenBlockData,\n    downPosition,\n    rightPosition,\n    handleSelectMouseEnter,\n    handleSelectMouseLeave,\n    handleSelectMouseUp,\n    handleGrabMouseDown,\n    handleContentsBlur,\n    handleContentsHover,\n    handleContentsMouseLeave\n  } = useBlockBase(blockData, useBlockReducer, parentInfo);\n\n  return (\n    <div \n      className={classNames(\n        \"block-zone\",\n        { selected: parentSelected? false : selected }\n      )}\n    >\n      {/*block-utils */}\n      <div \n        className=\"contents-area\"\n        onMouseOver={handleContentsHover}\n        onMouseLeave={handleContentsMouseLeave}\n      >\n\n        <div className={classNames(\n          \"block-utils\",\n          { on: isHover }\n        )}>\n          <div className=\"block-add-button\">\n            <FontAwesomeIcon icon={faPlus} />\n          </div>\n          <div \n            className=\"block-type-change-button\"\n            onMouseDown={handleGrabMouseDown}\n          >\n            <FontAwesomeIcon icon={faGripVertical} />\n          </div>\n        </div>\n\n        { children(selected, setSelect) }\n\n      </div>\n      \n      <ChildrenBlock \n        childrenBlockData={childrenBlockData} \n        useBlockReducer={useBlockReducer} \n        parentInfo={{\n          type: blockData.type,\n          selected\n        }} \n      />\n\n      {\n        /**\n         * block-cover\n         */\n      }\n      <div className={classNames(\n        \"block-select-area\",\n        { selected:  useBlockReducer.isGrab }\n      )}>\n\n        <div className={classNames(\n          \"area\",\n          \"rigth-drop-area\",\n          { on: false }\n        )}>\n          <div className=\"box\"></div>\n        </div>\n\n        <div \n          className={classNames(\n            \"area\", \n            \"down-drop-area\",\n            { on: down }\n          )}\n          onMouseEnter={handleSelectMouseEnter(downPosition, setDown)}\n          onMouseLeave={handleSelectMouseLeave(setDown)}\n          onMouseUp={handleSelectMouseUp()}\n        >\n          <div className=\"box\"></div>\n        </div>\n        \n      </div>\n    </div>\n  )\n}\n\nexport default BaseBlockZone;","import { TextContents, ContentType, RawBlockData } from '../types';\nimport { \n  equalsArray, \n} from '../../block/reducer/utils/converter';\nimport { createBlockData, parseHtmlContents } from '../../block/reducer/utils/';\n\nconst BOLD = \"b\" as const;\nconst ITALY = \"i\" as const;\nconst UNDERBAR = \"_\" as const;\nconst FONT_COLOR = \"fc\" as const;\nconst BACKGROUND_COLOR = \"bc\" as const;\nconst ANCHOR = \"a\" as const;\nconst FONT_WEIGHT_BOLD  = \"font-weight: 700;\" as const;\nconst FONT_STYLE_ITALIC = \"font-style: italic;\" as const;\nconst BORDER_BOTTOM     = \"border-bottom: 0.05em solid;\" as const;\nconst COLOR             = \"color:\" as const;\nconst BACKGROUND_C      = \"background-color:\" as const;\n\nexport const arrayUtils = { equalsArray };\n\nexport function contentsElement(rawContents: any) {\n  let text: string;\n  let className:string | null = null;\n  let styles:string | null = null;\n  let aTag: any;\n\n  if(rawContents.length === 2) {\n    rawContents[1].forEach((content:string[]) => {\n      switch(content[0]) {\n\n        case BOLD:\n          styles = styles? styles + ` ${FONT_WEIGHT_BOLD}` : FONT_WEIGHT_BOLD;\n          break;\n\n        case ITALY:\n          styles = styles? styles + ` ${FONT_STYLE_ITALIC}` : FONT_STYLE_ITALIC;\n          break;\n\n        case UNDERBAR:\n          styles = styles? styles + ` ${BORDER_BOTTOM}` : BORDER_BOTTOM;\n          break;\n\n        case FONT_COLOR:\n          styles = styles? styles + ` ${COLOR} ${content[1]};` : `${COLOR} ${content[1]};`;\n          break;\n\n        case BACKGROUND_COLOR:\n          styles = styles? styles + ` ${BACKGROUND_C} ${content[1]};` : `${BACKGROUND_C} ${content[1]};`;\n          break;\n          \n        case ANCHOR:\n          aTag = content[1];\n      }\n    })\n    text = `<span${className? ' class=\"'+ className + '\"' : \"\"}${styles? ' style=\"' + styles + '\"' : \"\"}>${rawContents[0]}</span>`\n\n    if(aTag) {\n      let preText = text;\n      text = `<a href=\"${aTag}\">${preText}</a>`;\n    }\n  } else {\n    text = rawContents[0];\n  }\n\n  return text;\n}\n\nexport function createContentsElement(accumulator: string, rawContents: any, currentIndex: number):string {\n  return currentIndex === 1?  contentsElement(accumulator) + contentsElement(rawContents) : accumulator + contentsElement(rawContents);\n}\n\nexport function createContentsText(accumulator: string, rawContents: any, currentIndex: number): string {\n  return currentIndex === 1? accumulator[0] + rawContents[0] : accumulator + rawContents[0];\n}\n\nexport function createClipboardContentsText(contents: any[]): string {\n  console.log(contents);\n  const newTextList: string[] = contents.map((content) => {\n    return content? content.reduce(createContentsText) : \"\";\n  });\n\n  return newTextList.reduce((a: string, b: string) => `${a}\\n${b}`);\n}\n\nexport function copyInClipboard(value: string) {\n  const textarea = document.createElement(\"textarea\");\n  textarea.value = value;\n  document.body.appendChild(textarea);\n  textarea.select();\n  textarea.setSelectionRange(0, 9999); // 모바일\n  document.execCommand(\"copy\");\n  document.body.removeChild(textarea);\n}\n\nexport function findTextStyle(\n  textContents: TextContents[], \n  position: number\n  ): ContentType[] | null | undefined {\n\n  let count: number = 0;\n  let style: ContentType[] | null | undefined = null;\n\n  for(let i = 0; i < textContents.length; i++) {\n    count += textContents[i][0].length;\n\n    if(count > position) {\n      style = textContents[i].length === 2? textContents[i][1] : null;\n      break;\n    } \n\n  }\n\n  return style;\n}\n\nexport function arrayFindIndex(array: any[], props: any): number {\n  // JSON stringfy는 연산 속도가 느리니 수정 할 것.\n  const JSONProps = JSON.stringify(props);\n\n  for(let i = 0; i < array.length; i++) {\n    const JSONArray = JSON.stringify(array[i]);\n    if(JSONArray === JSONProps) {\n      return i;\n    }\n  }\n  return -1;\n}\n\nexport function divideText(text: string): string | string[] {\n  const reg = /[\\n]|[<br>]|[<br/>]/;\n  const res = text.split(reg);\n  return res.length === 1? text : res;\n}\n\nexport function createBlockList(contentsList: string[]) {\n  let preBlockId: string | null = null;\n  return contentsList.map((contents) => {\n    const newBlock = createBlockData(\"text\", \"bk-p\", preBlockId);\n\n    preBlockId = newBlock.id;\n\n    return Object.assign({}, newBlock, {\n      property: Object.assign({}, newBlock.property, {\n        contents: parseHtmlContents(contents)\n      })\n    });\n  });\n}\n\n// export function pasteText(text: string): string | RawBlockData[] {\n//   const contents = divideText(text);\n//   return typeof contents !== \"string\"? createBlockList(contents) : contents;\n// }","// Usage:\n// let x = document.querySelector('[contenteditable]');\n// let caretPosition = getSelectionDirection(x) !== 'forward' ? getSelectionStart(x) : getSelectionEnd(x);\n// setSelectionRange(x, caretPosition + 1, caretPosition + 1);\n// let value = getValue(x);\n\n// it will not work with \"<img /><img />\" and, perhaps, in many other cases.\n\nexport function isAfter(container:any, offset:any, node:any):any {\n  let c = node;\n  while (c.parentNode !== container) {\n    c = c.parentNode;\n  }\n  let i = offset;\n  while (c !== null && i > 0) {\n    c = c.previousSibling;\n    i -= 1;\n  }\n  return i > 0;\n}\n\nexport function compareCaretPositons(node1: any, offset1: any, node2: any, offset2: any): any {\n  if (node1 === node2) {\n    return offset1 - offset2;\n  }\n  let c = node1.compareDocumentPosition(node2);\n  if ((c & Node.DOCUMENT_POSITION_CONTAINED_BY) !== 0) {\n    return isAfter(node1, offset1, node2) ? +1 : -1;\n  } else if ((c & Node.DOCUMENT_POSITION_CONTAINS) !== 0) {\n    return isAfter(node2, offset2, node1) ? -1 : +1;\n  } else if ((c & Node.DOCUMENT_POSITION_FOLLOWING) !== 0) {\n    return -1;\n  } else if ((c & Node.DOCUMENT_POSITION_PRECEDING) !== 0) {\n    return +1;\n  }\n}\n\nexport function stringifyElementStart(node: any, isLineStart: any): any {\n  if (node.tagName.toLowerCase() === 'br') {\n    if (true) {\n      return '\\n';\n    }\n  }\n  if (node.tagName.toLowerCase() === 'div') { // Is a block-level element?\n    if (!isLineStart) { //TODO: Is not at start of a line?\n      return '\\n';\n    }\n  }\n  return '';\n}\n\nexport function* positions(node:any, isLineStart = true):any {\n  // console.assert(node.nodeType === Node.ELEMENT_NODE);\n  let child = node.firstChild;\n  let offset = 0;\n  yield {node: node, offset: offset, text: stringifyElementStart(node, isLineStart)};\n  while (child != null) {\n    if (child.nodeType === Node.TEXT_NODE) {\n      yield {node: child, offset: 0/0, text: child.data};\n      isLineStart = false;\n    } else {\n      isLineStart = yield* positions(child, isLineStart);\n    }\n    child = child.nextSibling;\n    offset += 1;\n    yield {node: node, offset: offset, text: ''};\n  }\n  return isLineStart;\n}\n\nexport function getCaretPosition(contenteditable: any, textPosition: any): any {\n  let textOffset = 0;\n  let lastNode = null;\n  let lastOffset = 0;\n  for (let p of positions(contenteditable)) {\n    if (p.text.length > textPosition - textOffset) {\n      return {node: p.node, offset: p.node.nodeType === Node.TEXT_NODE ? textPosition - textOffset : p.offset};\n    }\n    textOffset += p.text.length;\n    lastNode = p.node;\n    lastOffset = p.node.nodeType === Node.TEXT_NODE ? p.text.length : p.offset;\n  }\n  return {node: lastNode, offset: lastOffset};\n}\n\nexport function getTextOffset(contenteditable: any, selectionNode: any, selectionOffset: any): any {\n  let textOffset = 0;\n  for (let p of positions(contenteditable)) {\n    // console.log(selectionNode, selectionNode.nodeType)\n    if(!selectionNode || !selectionNode.nodeType) {\n      return textOffset += p.text.length;\n    }\n    if (selectionNode.nodeType !== Node.TEXT_NODE && selectionNode === p.node && selectionOffset === p.offset) {\n      return textOffset;\n    }\n    if (selectionNode.nodeType === Node.TEXT_NODE && selectionNode === p.node) {\n      return textOffset + selectionOffset;\n    }\n    textOffset += p.text.length;\n  }\n  return compareCaretPositons(selectionNode, selectionOffset, contenteditable, 0) < 0 ? 0 : textOffset;\n}\n\nexport function getValue(contenteditable: any): any{\n  let value = '';\n  for (let p of positions(contenteditable)) {\n    value += p.text;\n  }\n  return value;\n}\n\nexport function setSelectionRange(contenteditable: any, start: any, end: any): any {\n  let selection:any = window.getSelection();\n  let s = getCaretPosition(contenteditable, start);\n  let e = getCaretPosition(contenteditable, end);\n  selection.setBaseAndExtent(s.node, s.offset, e.node, e.offset);\n}\n\n//TODO: Ctrl+A - rangeCount is 2\nexport function getSelectionDirection(contenteditable: any): any {\n  let selection:any = window.getSelection();\n  let c = compareCaretPositons(selection.anchorNode, selection.anchorOffset, selection.focusNode, selection.focusOffset);\n  return c < 0 ? 'forward' : 'none';\n}\n\nexport function getSelectionStart(contenteditable: any): any {\n  let selection: any = window.getSelection();\n  let c = compareCaretPositons(selection.anchorNode, selection.anchorOffset, selection.focusNode, selection.focusOffset);\n  return c < 0 ? getTextOffset(contenteditable, selection.anchorNode, selection.anchorOffset) : getTextOffset(contenteditable, selection.focusNode, selection.focusOffset);\n}\n\nexport function getSelectionEnd(contenteditable: any): any {\n  let selection: any = window.getSelection();\n  let c = compareCaretPositons(selection.anchorNode, selection.anchorOffset, selection.focusNode, selection.focusOffset);\n  return c < 0 ? getTextOffset(contenteditable, selection.focusNode, selection.focusOffset) : getTextOffset(contenteditable, selection.anchorNode, selection.anchorOffset);\n}","import React, { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport { BlockData } from \"../types\";\nimport { UseBlockType } from \"./useBlock\";\nimport { \n  contentsElement,\n  copyInClipboard,\n  createClipboardContentsText,\n  createContentsElement\n} from '../utils';\nimport { \n  getSelectionStart,\n  getSelectionEnd,\n  setSelectionRange\n} from '../utils/selectionText';\nimport { createBlockData, sliceTextContents } from \"../reducer/utils\";\n\nfunction useTextBlock(blockData: BlockData, useBlockReducer: UseBlockType, selected: boolean) {\n  const [ editable, setEditable]        = useState<boolean>(true);\n  const [ cursorStart, setCursorStart ] = useState<number>(0);\n  const [ cursorEnd, setCursorEnd ]     = useState<number>(0);\n  const [ styleToggle, setStyleToggle ] = useState<boolean>(false);\n\n  const blockContentsRef = useRef<HTMLDivElement>(null);\n\n  const {\n    initBlock,\n    isGrab,\n    isHoldingDown,\n    isCliping,\n    nextBlockInfo,\n    editingBlockId,\n    onChangeEditingId,\n    onEditBlock,\n    onAddTextBlock,\n    onChangeTextStyle,\n    onCommitBlock,\n    onChangeBlockContents,\n    onDeleteBlock,\n    onDeleteTextBlock,\n    onRevertBlock,\n    onSwitchBlock,\n    onClearNextBlockInfo\n  } = useBlockReducer;\n\n  const createMarkup = useMemo(()=> {\n    const htmlElement = blockData.contents[0]?\n    (!blockData.contents[1]? \n      contentsElement(blockData.contents[0])\n      : blockData.contents.reduce(createContentsElement)\n    ) : \"\";\n\n    return {\n      __html: htmlElement\n    }\n  }, [blockData.contents]);\n\n  // keyboard methods text\n  const handleKeyUp = useCallback((e:any) => {\n    if(e.ctrlKey) return;\n\n    setCursorStart(getSelectionStart(e.target));\n    setCursorEnd(getSelectionEnd(e.target));\n    \n    switch(e.key) {\n\n      case \"Enter\":\n        e.preventDefault();\n        break;\n\n      case \"ArrowUp\": \n      // cursor가 앞으로 튐\n        e.preventDefault();\n        setCursorStart(0);\n        setCursorEnd(0);\n        setSelectionRange(e.target, 0, 0);\n\n        if(cursorStart === 0 && cursorEnd === 0) {\n          onChangeEditingId(blockData.index - 1);\n        } \n        \n        break;\n\n      case \"ArrowDown\":\n        e.preventDefault();\n        const contentsLength = e.target.innerText.length;\n        setCursorStart(contentsLength);\n        setCursorEnd(contentsLength);\n        setSelectionRange(e.target, contentsLength, contentsLength);\n\n        if((cursorEnd && cursorStart) === e.target.innerText.length) {\n          setCursorStart(0);\n          setCursorEnd(0);\n          onChangeEditingId(blockData.index + 1);\n        }\n        \n        break;\n\n      case \" \":\n        setCursorEnd(0);\n        onEditBlock(blockData.id, blockData.index, e.target.innerHTML);\n        onCommitBlock();\n        break;\n      \n      default:\n        onEditBlock(blockData.id, blockData.index, e.target.innerHTML);\n    }\n\n  }, [blockData, cursorEnd, cursorStart]);\n\n  const handleKeyPress = (e: any) => {\n    if(e.key === \"Enter\") {\n      e.preventDefault();\n      onAddTextBlock(\n        blockData.index, \n        e.target.innerHTML, \n        getSelectionStart(e.target), \n        getSelectionEnd(e.target)\n      );\n    }\n  }\n\n  const handleKeyDown = (e: any) => {\n    if (e.key === \"Backspace\") {\n      const cursorStartPoint = getSelectionStart(e.target);\n      const cursorEndPoint   = getSelectionEnd(e.target);\n      \n      setCursorStart(cursorStartPoint);\n      setCursorEnd(cursorEndPoint);\n\n      if(cursorStartPoint === 0 && cursorEndPoint === 0) {\n        if(!e.target.innerHTML || e.target.innerHTML === \"<br>\") {\n          const nextEditIndex = blockData.index > 0? blockData.index - 1 : undefined;\n          onDeleteBlock([blockData], nextEditIndex);\n        } else if(blockData.index !== 0) {\n          onDeleteTextBlock(blockData.index, e.target.innerHTML, e.target.innerText.length);\n        }\n        \n      }\n\n    }\n  }\n\n  const moveEndPoint = useCallback((ele: any) => {\n    const length = ele.innerText.length;\n    setCursorStart(length);\n    setCursorEnd(length);\n    setSelectionRange(ele, length, length);\n  }, []);\n\n  const refreshPoint = useCallback((\n    ele:any, \n    cursorStart: number, \n    cursorEnd?: number | null\n    ) => {\n    setSelectionRange(ele, cursorStart, cursorEnd? cursorEnd : cursorStart);\n  }, []);\n\n  const handleClick = useCallback((e: any) => {\n    const parentNode = e.target.parentNode;\n\n    if(parentNode.tagName === \"A\") {\n      window.open(parentNode.href);\n    }\n\n  }, []);\n\n  const handleMouseUp = () => {\n    const getStartPosition = getSelectionStart(blockContentsRef.current);\n    const getEndPosition = getSelectionEnd(blockContentsRef.current);\n    setCursorStart(getStartPosition);\n    setCursorEnd(getEndPosition);\n  };\n\n  const handleBlur = useCallback((e: any) => {\n    if(e.relatedTarget && !e.currentTarget.contains(e.relatedTarget)) {\n      setCursorStart(0);\n      setCursorEnd(0);\n      onCommitBlock();\n      onChangeEditingId();\n    }\n  }, []);\n\n  const handleFocus = useCallback((element: any) => {\n    element.focus();\n  }, []);\n\n  const isFocus = () => {\n    if(!styleToggle) {\n      moveEndPoint(blockContentsRef.current);\n    } else if((cursorStart | cursorEnd)) {\n      refreshPoint(blockContentsRef.current, cursorStart, cursorEnd);\n    } \n\n    if(blockData.id !== editingBlockId) onChangeEditingId(blockData.id);\n  }\n\n  const reBlockFocus = () => {\n    handleFocus(blockContentsRef.current);\n  }\n\n  useEffect(() => {\n    const focused = document.activeElement;\n    \n    if((cursorStart | cursorEnd) && blockContentsRef && focused === blockContentsRef.current) {\n      refreshPoint(blockContentsRef.current, cursorStart, cursorEnd);\n    }\n\n  }, [blockData.contents]);\n\n  useEffect(() => {\n    if(editingBlockId === blockData.id) {\n      if(blockContentsRef.current) {\n        handleFocus(blockContentsRef.current);\n\n        if(nextBlockInfo) {\n          if(nextBlockInfo.type === \"text\") {\n            if(nextBlockInfo.payload[0] === \"delete\") {\n              const length = blockContentsRef.current.innerText.length - nextBlockInfo.payload[1];\n              setSelectionRange(blockContentsRef.current, length, length);\n            }\n            onClearNextBlockInfo();\n          }\n        }\n\n      }\n    } else {\n      setStyleToggle(false);\n    }\n  }, [editingBlockId]);\n\n  useEffect(() => {\n    if(cursorEnd - cursorStart >= 1) {\n      setStyleToggle(true);\n    } else {\n      setStyleToggle(false);\n    }\n  }, [cursorStart, cursorEnd]);\n\n  useEffect(() => {\n    \n    if(isGrab) {\n      setEditable(!isGrab);\n    } else {\n      setEditable(!selected);\n    }\n  }, [selected]);\n\n  useEffect(() => {\n    if(editingBlockId === blockData.id) {\n      if(blockContentsRef) {\n        handleFocus(blockContentsRef.current);\n        setSelectionRange(blockContentsRef.current, 0, 0);\n      }\n    }\n  }, [blockContentsRef]);\n\n  return {\n    cursorStart,\n    cursorEnd,\n    styleToggle,\n    blockContentsRef,\n    createMarkup,\n    handleKeyUp,\n    handleKeyPress,\n    handleKeyDown,\n    handleClick,\n    handleMouseUp,\n    handleBlur,\n    isFocus,\n    reBlockFocus,\n    editable,\n    setEditable\n  };\n}\n\nexport type UseTextBlockType = ReturnType<typeof useTextBlock>;\n\nexport default useTextBlock;","import React from 'react';\n\ninterface ContentEditableEle {\n  className: string;\n  editable: boolean;\n  onKeyDown?: any;\n  onKeyPress?: any;\n  onKeyUp?: any;\n  onCopy?: any;\n  onPaste?: any;\n  onClick?: any;\n  onMouseUp?: any;\n  onMouseDown?: any;\n  onMouseMove?: any;\n  onFocus?: any;\n  onBlur?: any;\n  placeholder: string;\n  dangerouslySetInnerHTML: {\n    __html: any\n  }\n  contents?: string;\n}\n\nconst ContentEditableEle = React.forwardRef<HTMLDivElement, ContentEditableEle>(({\n  className,\n  editable,\n  onKeyPress, \n  onKeyUp,\n  onKeyDown,\n  onCopy,\n  onPaste,\n  onClick,\n  onMouseUp,\n  onMouseDown,\n  onMouseMove,\n  onFocus,\n  onBlur,\n  dangerouslySetInnerHTML,\n  contents,\n  placeholder\n}, ref) => {\n  \n  return (\n    <div \n      className={`bk-contentEditable ${className? className : \"\"}`}\n      ref={ref}\n      onKeyUp={onKeyUp}\n      onKeyPress={onKeyPress}\n      onKeyDown={onKeyDown}\n      onCopy={onCopy}\n      onPaste={onPaste}\n      onClick={onClick}\n      onMouseUp={onMouseUp}\n      onMouseDown={onMouseDown}\n      onMouseMove={onMouseMove}\n      onFocus={onFocus}\n      onBlur={onBlur}\n      contentEditable={editable}\n      dangerouslySetInnerHTML={dangerouslySetInnerHTML}\n      placeholder={placeholder} \n    >\n      { contents }\n    </div>\n  )\n})\n\nexport default ContentEditableEle;","import React from 'react';\n\ninterface ColorStyleToggleButtonProps {\n  colorCode: number[];\n  onStyleChange: any;\n  addDelToggle: any;\n}\n\nconst ColorStyleToggleButton: React.FC<ColorStyleToggleButtonProps> = ({\n  colorCode,\n  onStyleChange,\n  addDelToggle\n}) => {\n  const RGBA = `rgba(${colorCode[0]},${colorCode[1]},${colorCode[2]},${colorCode[3]})`\n\n  const btnStyle = {\n    color: RGBA\n  }\n\n  const addDel = addDelToggle([\"fc\", RGBA])? \"del\" : \"color\";\n\n  const handleClick = ()=> {\n    onStyleChange([\"fc\", RGBA], addDel);\n  }\n\n  return (\n    <button className=\"bk-colorStyleToggle\" style={btnStyle} onClick={handleClick}>\n      Text\n      { addDel === \"del\"? \"v\" : null }\n    </button>\n  );\n}\n\nconst colorCodes: number[][] = [\n  [191, 63, 63, 1],\n  [191, 127, 63, 1],\n  [191, 191, 63, 1],\n  [127, 191, 63, 1],\n  [63, 191, 63, 1],\n  [63, 191, 127, 1],\n  [63, 127, 191, 1],\n  [63, 63, 191, 1],\n  [127, 63, 191, 1],\n  [191, 63, 191, 1],\n  [191, 63, 127, 1]\n];\n\ninterface ColorStyleToggleProps {\n  addDelToggle: any;\n  onStyleChange: any;\n}\n\nconst ColorStyleToggle: React.FC<ColorStyleToggleProps> = ({\n  addDelToggle, \n  onStyleChange \n}) => {\n\n  return (\n    <div className=\"bk-color-menu\">\n      {\n        colorCodes.map((code, key) => \n          <ColorStyleToggleButton \n            key={key}\n            colorCode={code}\n            onStyleChange={onStyleChange}\n            addDelToggle={addDelToggle}\n          />\n        )\n      }\n    </div>\n  );\n}\n\nexport default ColorStyleToggle;","import React, { useState } from \"react\";\n\ntype SetFunction = (e: React.ChangeEvent<HTMLSelectElement | HTMLInputElement>) => void;\n\ntype HandleFunction = (callback?: Function) => SetFunction\n\nexport type UseChangeType = [string, HandleFunction];;\n\nfunction useChange(defaultValue: string): UseChangeType {\n  const [ value, setValue ] = useState<string>(defaultValue);\n\n  const handleValue: HandleFunction= (callback?: Function) => (e: React.ChangeEvent<HTMLSelectElement | HTMLInputElement>) => {\n    setValue(e.target.value);\n    if(callback) callback(e.target.value);\n  }\n\n  return [ value, handleValue ];\n}\n\nexport default useChange;","import React, { useCallback } from 'react';\nimport useChange from '../../../../hooks/useChange';\n\nconst textBlockType: string[][] = [\n  [\"h1\", \"bk-h1\"],\n  [\"h2\", \"bk-h2\"],\n  [\"h3\", \"bk-h3\"],\n  [\"h4\", \"bk-h4\"],\n  [\"p\", \"bk-p\"]\n];\n\ninterface TextBlockTypeSelectionProps {\n  blockIndex: number;\n  onChangeStyleType: (blockInfo: string | number, styleType: string) => void;\n  styleType: string;\n}\n\nconst TextBlockTypeSelection: React.FC<TextBlockTypeSelectionProps> = ({\n  blockIndex,\n  onChangeStyleType,\n  styleType\n}) => {\n  const [ value, handleValue ] = useChange(styleType);\n\n  const handleChange = useCallback(() => \n    handleValue((value) => onChangeStyleType(blockIndex, value)), \n  [value, onChangeStyleType, blockIndex]);\n\n  return (\n    <select onChange={handleChange()} value={value}>\n      { textBlockType.map(((type) => <option value={type[1]} key={type[1]}>{ type[0] }</option>)) }\n    </select>\n  );\n}\n\nexport default TextBlockTypeSelection;","import React, { useMemo } from 'react';\n\ninterface TextStyleToggleButtonProps {\n  onStyleChange: any;\n  addDelToggle: boolean;\n  styleType: string;\n}\n\nconst TextStyleToggleButton: React.FC<TextStyleToggleButtonProps> = ({\n  onStyleChange,\n  addDelToggle,\n  styleType\n}) => {\n\n  const addDelClassName = () => addDelToggle? \"del\" : \"add\";\n\n  const handleClick = () => {\n    onStyleChange([styleType], addDelClassName);\n  }\n\n  return (\n    <button \n      className={`bk-textStyleToggle ${addDelClassName}`}\n      onClick={handleClick}\n    >\n      { styleType }\n    </button>\n  );\n}\n\nexport default TextStyleToggleButton;","import React, { useEffect, useState } from 'react';\nimport { \n  ContentType\n} from '../../../../types';\nimport { \n  findTextStyle,\n  arrayFindIndex\n} from '../../../../utils';\nimport { UseBlockType }       from '../../../../hooks/useBlock';\nimport ColorStyleToggle       from './ColorStyleToggle';\nimport TextBlockTypeSelection from './TextBlockTypeSelection';\nimport TextStyleToggleButton  from './TextStyleToggleButton';\n\ninterface TextStyleTogglesProps {\n  blockIndex: number;\n  styleType: string;\n  contents: any;\n  startPosition: number;\n  endPosition: number;\n  reBlockFocus: any;\n  useBlockReducer: UseBlockType;\n}\n\nconst TextStyleToggles: React.FC<TextStyleTogglesProps> = ({\n  blockIndex, \n  styleType,\n  contents,\n  startPosition,\n  endPosition,\n  reBlockFocus,\n  useBlockReducer\n}) => {\n  const [ currentStyle, setStyle ] = useState(findTextStyle(contents, startPosition));\n  const { \n    onChangeTextStyle, \n    onCommitBlock,\n    onChangeStyleType\n  } = useBlockReducer;\n\n  const toggleProps:string[] = [\"b\", \"i\", \"_\"];\n\n  const onStyleChange = (contentType: ContentType, toggle: any) => {\n    onCommitBlock();\n    onChangeTextStyle(\n      blockIndex, \n      contentType,\n      startPosition, \n      endPosition,\n      toggle\n    )\n    console.log(\"click\", startPosition, endPosition);\n    reBlockFocus();\n  }\n\n  const addDelToggle = (prop: any): boolean => {\n    return arrayFindIndex(\n      currentStyle? \n      currentStyle : [], \n      prop\n    ) !== -1? true : false;\n  }\n\n  useEffect(()=> {\n    setStyle(findTextStyle(contents, startPosition));\n  }, [contents, startPosition]);\n\n  return (\n    <div \n      style={{left: `${startPosition * 16}px`}}\n      className=\"bk-style-toggles absolute bg-white -top-full border\"\n    >\n      <TextBlockTypeSelection\n        blockIndex={blockIndex}\n        styleType={styleType}\n        onChangeStyleType={onChangeStyleType}\n      />\n      {\n        toggleProps.map((prop)=> \n          <TextStyleToggleButton \n            key={prop}\n            onStyleChange={onStyleChange}\n            styleType={prop}\n            addDelToggle={addDelToggle([prop])}\n          />\n        )\n      }\n      <ColorStyleToggle\n        addDelToggle={addDelToggle}\n        onStyleChange={onStyleChange}\n      />\n    </div>\n  )\n}\n\nexport default TextStyleToggles;","import React, { useEffect } from 'react';\nimport useTextBlock from '../../../hooks/useTextBlock';\nimport { BlockProps } from '../../Block';\nimport ContentEditableEle from './base/ContentEditableEle';\nimport TextStyleToggle from './base/TextStyleToggle';\n\ninterface TextBlockEleProps extends BlockProps {\n  selected: boolean;\n  setSelect: React.Dispatch<React.SetStateAction<boolean>>;\n}\n\nconst TextBlockEle: React.FC<TextBlockEleProps> = ({ \n  blockData, \n  useBlockReducer, \n  selected,\n  setSelect\n}) => {\n\n  const {\n    cursorStart,\n    cursorEnd,\n    styleToggle,\n    blockContentsRef,\n    createMarkup,\n    handleKeyUp,\n    handleKeyPress,\n    handleKeyDown,\n    handleClick,\n    handleMouseUp,\n    handleBlur,\n    isFocus,\n    reBlockFocus,\n    editable,\n    setEditable\n  } = useTextBlock(blockData, useBlockReducer, selected);\n\n  useEffect(() => {\n    setEditable(!selected);\n  }, [selected]);\n\n  return (\n    <div \n      className=\"text-block\"\n      onBlur={handleBlur}\n    > \n      { \n        <ContentEditableEle\n          className={blockData.styleType}\n          editable={editable}\n          dangerouslySetInnerHTML={createMarkup}\n          ref={blockContentsRef}\n          onKeyUp={handleKeyUp}\n          onKeyPress={handleKeyPress}\n          onKeyDown={handleKeyDown}\n          onClick={handleClick}\n          onMouseDown={isFocus}\n          onMouseUp={handleMouseUp}\n          onFocus={isFocus}\n          placeholder=\"입력해주세요...\"\n        />\n      }\n      {\n        styleToggle? \n        <TextStyleToggle\n          blockIndex={blockData.index}\n          styleType={blockData.styleType}\n          contents={blockData.contents}\n          startPosition={cursorStart}\n          endPosition={cursorEnd}\n          reBlockFocus={reBlockFocus}\n          useBlockReducer={useBlockReducer}\n        /> : null\n      }\n    </div>\n  )\n}\n\nexport default TextBlockEle;","import TextBlock from \"./TextBlock\";\n\nexport default TextBlock;","import React from \"react\";\nimport { BlockProps } from \"../../Block\";\nimport BaseBlockZone from \"../../zone/BaseBlockZone\";\nimport TextBlockEle from \"./TextBlockEle\";\n\nconst TextBlock: React.FC<BlockProps> = ({ blockData, useBlockReducer, parentInfo }) => {\n  return (\n    <BaseBlockZone\n      blockData={blockData}\n      useBlockReducer={useBlockReducer}\n      parentInfo={parentInfo}\n    >\n      {\n        (selected, setSelect) => {\n          return (\n            <TextBlockEle \n              blockData={blockData} \n              useBlockReducer={useBlockReducer} \n              selected={selected}\n              setSelect={setSelect}\n            />\n          );\n        }\n          \n      }\n      \n    </BaseBlockZone>\n  )\n}\n\nexport default TextBlock;","import React from \"react\";\nimport { UseBlockType } from \"../hooks/useBlock\";\nimport { BlockData } from \"../types\";\nimport TextBlock from \"./elements/text\";\n\nimport '../assets/block.scss';\n\nexport type ParentInfoType = {\n  type: string;\n  selected: boolean;\n};\n\nexport interface BlockProps {\n  blockData: BlockData;\n  useBlockReducer: UseBlockType;\n  parentInfo?: ParentInfoType;\n}\n\n// const BlockHandler = {\n//   [\"text\"]: (\n//       blockData: BlockData, \n//       useBlockReducer: UseBlockType, \n//       parentInfo?: ParentInfoType\n//     ) =>  <TextBlock blockData={blockData} useBlockReducer={useBlockReducer} parentInfo={parentInfo} />\n\n// }\n\nconst Block: React.FC<BlockProps> = ({\n  blockData,\n  useBlockReducer,\n  parentInfo\n}) => {\n  switch(blockData.type) {\n    case \"text\":\n      return <TextBlock blockData={blockData} useBlockReducer={useBlockReducer} parentInfo={parentInfo} />\n    default:\n      return null;\n  };\n  // if(BlockHandler.hasOwnProperty(blockData.type)) {\n  //   return BlockHandler[blockData.type](blockData, useBlockReducer, parentInfo);\n  // } else {\n  //   return null\n  // }\n}\n\nexport default Block;\n","import BlockEditor from './BlockEditor';\n\nexport default BlockEditor;","import React, { useCallback, useRef } from 'react';\nimport { useIdleTimer } from 'react-idle-timer';\nimport classNames from 'classnames';\nimport useBlock from './hooks/useBlock';\nimport { BlockData } from './types';\nimport useConnectRedux from './hooks/useConnectRedux';\nimport Block from './components/Block';\nimport './assets/block.scss';\n\nconst BlockEditor: React.FC = () => {\n  \n  // custom hooks\n  const useBlockReducer = useBlock();\n\n  // redux & api\n  const { updated } = useConnectRedux(useBlockReducer);\n  \n  const {\n    state,\n    stage,\n    isGrab,\n    isCliping,\n    tempClipData,\n    initBlock,\n    onCommitBlock,\n    onResetEditorState,\n    onRevertBlock\n  } = useBlockReducer;\n\n  // elements\n  const editorRef = useRef<HTMLDivElement>(null);\n\n  const dragRef = useRef<HTMLDivElement>(null);\n\n  // callback\n  const handleOnIdle = useCallback(() => {\n    if(stage[0]) onCommitBlock();\n  }, [stage, onCommitBlock]);\n\n  const handleMouseDown = useCallback((e: React.MouseEvent) => {\n    dragRef.current?.setAttribute(\"style\", `transform: translate(${e.clientX - 40}px, ${e.clientY - 70}px)`);\n  }, [dragRef]);\n\n  const handleMouseMove = useCallback((e: React.MouseEvent) => {\n    if(isGrab) {\n      dragRef.current?.setAttribute(\"style\", `transform: translate(${e.clientX - 40}px, ${e.clientY - 70}px)`);\n    }\n  }, [isGrab, dragRef]);\n\n  const handleDrag = useCallback((e: React.DragEvent) => {\n    if(isGrab || isCliping) {\n    }\n  }, [isGrab, isCliping]);\n\n  const handleMouseUp = useCallback(() => {\n    onResetEditorState(false);\n  }, [editorRef, onResetEditorState]);\n\n  const handleMouseLeave = useCallback(() => {\n    onResetEditorState(false);\n  }, [onResetEditorState]);\n\n  const handleKeyDown = useCallback((e: React.KeyboardEvent) => {\n\n    if((e.metaKey || e.ctrlKey)) {\n      if(!stage[0]) {\n        switch(e.key) {\n          case \"z\":\n            e.preventDefault();\n            onRevertBlock();\n          break;\n    \n          case \"y\":\n            e.preventDefault();\n            onRevertBlock(true);\n          break;\n    \n          default: \n        }\n      } \n\n      if(tempClipData[0]) {\n\n      }\n    }\n  }, [onRevertBlock, stage, tempClipData]);\n\n  // idle\n  const { getLastActiveTime } = useIdleTimer({\n    timeout: 10 * 60 * 2,\n    onIdle: handleOnIdle,\n    debounce: 500\n  });\n\n  return (\n    <div \n      className=\"block-editor blockEditor items-center overflow-auto w-full notranslate text-gray-700 bg-white h-full rounded-md shadow-md\"\n      ref={editorRef}\n      onMouseUp={handleMouseUp}\n      onMouseLeave={handleMouseLeave}\n      onMouseMove={handleMouseMove}\n      onMouseDown={handleMouseDown}\n      onDrag={handleDrag}\n      onKeyDown={handleKeyDown}\n    >\n      <div className=\"cover\"></div>\n      <div className={classNames(\n        \"pt-8\",\n        \"m-auto\", \n        \"h-full\", \n        \"block-container\",\n        {\"not-drag\": (isGrab || isCliping)? true : false},\n        {\"updated\": updated}\n      )}>\n        {\n          initBlock?\n          initBlock.root.map((block: BlockData) =>\n            <Block\n              key={block.id}\n              blockData={block}\n              useBlockReducer={useBlockReducer}\n            />\n          ) : <div> Loading... </div>\n        }\n      </div>\n\n      {\n        // 이거 전용 element를 만들어야 함.\n        <div \n          className={classNames(\n            \"drag-elements\",\n            {hidden: !isGrab}\n          )}\n          ref={dragRef}\n        >\n          {\n            tempClipData[0] !== undefined?\n            tempClipData.map((data, idx) => {\n              const blockData = state.blockList[data];\n              return (\n                <Block \n                  key={idx} \n                  blockData={blockData}\n                  useBlockReducer={useBlockReducer}\n                />\n              );\n            })\n            : null\n          }\n        </div>\n      }\n      \n\n    </div>\n  )\n}\n\nexport default BlockEditor;","import React from 'react';\nimport { Link } from 'react-router-dom';\n\ninterface EditorBlockProps {\n  penName: string;\n  userPhoto: string | null;\n  bio: string;\n}\n\nconst classes = [\n  \"user-block px-4 pt-4 bg-purple-50\",\n  \"profile-text-block\",\n  \"penName font-semibold text-xl text-gray-600\",\n  \"bi text-sm font-medium text-gray-600\",\n  \"profile-image-block w-full h-18 pt-6\",\n  \"avatar w-24 h-12 m-auto relative\",\n  \"w-24 h-24 absolute hover:cursor-pointer rounded-full overflow-hidden border\",\n  \"w-full h-full\",\n  \"w-full h-full\"\n]\n\nfunction EditorBlock({ penName, bio ,userPhoto }: EditorBlockProps) {\n  return (\n    <div className={classes[0]}>\n      <div className={classes[1]}>\n        <div className={classes[2]}>\n          { penName }\n        </div>\n        <div className={classes[3]}>\n          { bio }\n        </div>\n      </div>\n      <div className={classes[4]}>\n        <div className={classes[5]}>\n          <Link \n            to={`/bklog/${penName}`} \n            className={classes[6]} \n            title={`${penName} page 이동`}\n          >\n            {\n              userPhoto? \n              <img className={classes[7]} src={userPhoto} alt={penName} />\n              : <div className={classes[8]}>{penName[0]}</div>\n            }\n          </Link>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default EditorBlock;","import React, { useState, useEffect } from 'react';\nimport useAuth from '../../../hooks/useAuth';\n\nimport EditorBlock from './EditorBlock';\n\nimport './profile.scss';\nimport usePage from '../../../hooks/usePage';\n\nfunction Profile() {\n\n  const {\n    pageEditor\n  } = usePage();\n\n  return (\n    <div className={`user-profile flex-none w-full whitespace-nowrap border-b mb-12`}>\n      { \n        pageEditor? \n        <>\n          <EditorBlock\n            penName={pageEditor.penName}\n            userPhoto={pageEditor.userPhoto}\n            bio={pageEditor.bio}\n          />\n        </>\n        : <div></div>\n      }\n    </div>\n  )\n}\n\nexport default Profile;","import Profile from './Profile';\n\nexport default Profile;","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faSortDown } from '@fortawesome/free-solid-svg-icons';\nimport usePage from '../../hooks/usePage';\nimport { UserProfile } from '../../store/modules/auth/utils';\nimport { Page } from '../../store/modules/page/utils';\n\ninterface PageListProps {\n  pageEditor: UserProfile;\n  pageList: Page[];\n}\n\nfunction PageList({ pageEditor, pageList }: PageListProps) {\n\n  return (\n    <div className=\"page-list flex-1 overflow-auto pt-1\">\n      <div className=\"pl-4 text-base font-semibold\">\n        Page list\n      </div>\n      <ul className=\"list p-4 font-semibold text-sm text-gray-600\">\n        {\n          pageList? pageList.map((page, idx) =>\n            <li key={idx} className=\"h-auto flex justify-between px-2\">\n              <div className=\"h-8 leading-8 w-5/6 flex-none\">\n                <Link to={`/bklog/${pageEditor.penName}/${page.pageId}`}>\n                  {` ${page.pageTitle}`}\n                </Link>\n              </div>\n               {/**\n                누르면 색이 바뀌게 하면 될거 같음.\n              */}\n              <button className=\"h-8 pb-2 w-8 outline-none click:outline-none text-gray-300 hover:text-gray-600\">\n                <FontAwesomeIcon icon={faSortDown} />\n              </button>\n            </li>  \n          ) : <li></li>\n        }\n        \n      </ul>\n      <ul>\n        <li>\n          \n        </li>\n      </ul>\n    </div>\n  )\n}\n\nexport default PageList;","import React from 'react';\nimport classNames from 'classnames';\nimport Profile from './profile';\nimport PageList from './Page-list';\nimport './sidebar.scss';\nimport usePage from '../../hooks/usePage';\n\nfunction Sidebar() {\n\n  const { pageState } = usePage();\n\n  return (\n    <div className={\n      classNames(\n        \"sidebar h-full flex-none gnb-box overflow-hidden\",\n        {\"off\": !pageState.toggle}\n      )}\n    >\n      <div className=\"h-full py-2 pl-2\">\n        <nav className={` h-full rounded-md shadow-md bg-white overflow-hidden relative flex flex-col`}>\n          <Profile />\n          <PageList\n            pageEditor={pageState.pageEditor}\n            pageList={pageState.pageList}\n          />\n        </nav>\n      </div>\n    </div>\n  )\n}\n\nexport default Sidebar;","import Sibebar from './Sidebar';\n\nexport default Sibebar;","import React, { useEffect, useMemo, useState } from 'react';\nimport classNames from 'classnames';\nimport BlockEditor from '../components/newBlock';\nimport { BlockData } from '../types/bklog';\nimport Sibebar from '../components/sidebar';\nimport usePage from '../hooks/usePage';\nimport useBklog from '../hooks/useBKlog';\nimport { PageInfoType } from '../store/modules/bklog/utils';\n\nfunction BklogContainer() { \n  const { bklogState } = useBklog();\n\n  const pageInfo: PageInfoType = useMemo(() => bklogState.pageInfo, [bklogState.pageInfo]);\n\n  return (\n    <div className=\"flex h-full relative overflow-auto\">\n      <Sibebar />\n      <div className={classNames(\n        \"flex-auto w-full h-full py-2 pr-2 ml-2\"\n      )}>\n        {\n          pageInfo?  <BlockEditor /> : \"loading...\"\n        }\n        \n      </div>\n    </div>\n    \n  )\n}\n\nexport default BklogContainer;","import React, { useState, useEffect, useMemo } from 'react';\nimport { RouteComponentProps } from 'react-router';\nimport classNames from 'classnames';\nimport BklogContainer from '../containers/BklogContainer';\nimport useAuth from '../hooks/useAuth';\nimport useBklog from '../hooks/useBKlog';\nimport { Redirect } from 'react-router-dom';\nimport useSocket from '../hooks/useSocket';\n\ninterface MatchParams {\n  penName: string;\n  id: string;\n}\n\nfunction BkPage({ match }: RouteComponentProps<MatchParams>) {\n  const { penName, id } = match.params;\n\n  const {\n    onCheckToken\n  } = useAuth();\n\n  const {\n    bklogState,\n    onGetPage\n  } = useBklog();\n\n  useEffect(() => {\n    // onCheckToken();\n  });\n\n  useEffect(() => {\n    if(match.params.id) onGetPage(match.params.id);\n  }, [match.params.id]);\n\n  if(!match.params.penName) return (<Redirect to=\"/home\" />)\n\n  return (\n    <div className={classNames(\"bk-page\", \"h-full\", \"overflow-scroll\")}>\n      { id? <BklogContainer /> : null }\n    </div>\n  );\n}\n\nexport default BkPage;","import React from 'react';\n\ninterface UserBlockProps {\n  className?: string;\n  penName: string;\n  userPhoto: string;\n  onClick: any;\n}\n\nfunction UserBlock({ \n  className, \n  penName, \n  userPhoto, \n  onClick\n}: UserBlockProps ) {\n  return (\n    <button onClick={onClick} className={`${className} max-w-xs rounded-xl flex items-center text-sm py-1 px-2`} id=\"user-menu\">\n      <span className=\"sr-only\">{penName}</span>\n      {\n        userPhoto? \n        <img className=\"h-8 w-8 rounded-full\" src={userPhoto} alt={penName} />\n        : <div className=\"h-8 w-8 rounded-full bg-blue-400 leading-8\">{penName[0]}</div>\n      } \n      <span className=\"ml-4\">{penName}</span>\n    </button>\n  )\n}\n\nexport default UserBlock;","import React from 'react';\nimport classNames from 'classnames';\nimport useBase from '../../hooks/useBase';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCircle, faMoon } from '@fortawesome/free-solid-svg-icons';\n\nfunction DarkModeToggle() {\n\n  const { baseState: { dark }, onChangeMode } = useBase();\n\n  const handleClickToggle = () => {\n    onChangeMode();\n  }\n\n  return (\n    <div className=\"dark-mode-toggle\">\n      <button \n        onClick={handleClickToggle}\n        className={classNames(\n          \"mode-field hover:bg-yellow-300 transition-all bg-gray-200 dark:bg-gray-700 dark:hover:bg-indigo-900 w-16 h-8 rounded-full p-1 border-none\",\n          \"text-2xl leading-6 text-left text-white dark:text-gray-500 hover:text-yellow-50 dark:hover:text-yellow-300\"\n        )}\n      >\n        <span className=\"sr-only\">Dark mode toggle</span>\n        <FontAwesomeIcon className={classNames(\"transform transition-all\", {\"translate-x-8\": dark})} icon={dark? faMoon : faCircle} />\n      </button>\n    </div>\n  )\n}\n\nexport default DarkModeToggle;","import React, { useState, useEffect } from 'react';\nimport classNames from 'classnames';\nimport useAuth from '../../hooks/useAuth';\nimport UserBlock from './user/Userblock';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faBars } from '@fortawesome/free-solid-svg-icons';\nimport usePage from '../../hooks/usePage';\nimport { Link } from 'react-router-dom';\nimport DarkModeToggle from './DarkModeToggle';\n\n\nconst LinkClasses = \"hover:bg-purple-500 hover:text-white px-3 py-2 rounded-md text-sm font-medium\";\n\nfunction GlobalNav() {\n\n  const [ onUserMenu, setOnUserMenu ] = useState<boolean>(false); \n\n  const {\n    pageToggle,\n    onChangeToggle\n  } = usePage();\n\n  const { \n    authState: { loading, user },\n    onSignOutUser\n  } = useAuth();\n\n  const handleClickToggle = () => {\n    onChangeToggle();\n  }\n\n  const handleClickUserMenu = () => {\n    setOnUserMenu(!onUserMenu);\n  }\n\n  const handleClickToggleFalse = (e: any) => {\n    setOnUserMenu(false);\n  }\n\n  const handleClickSignOut = () => {\n    onSignOutUser();\n  }\n\n  return (\n    <nav className=\"bg-white dark:bg-black absolute left-0 top-0 z-10 shadow w-full\">\n      <div className=\"w-full pr-4 pl-1\">\n        <div className=\"flex items-center justify-between h-14\">\n        <div className=\"hidden md:block\">\n          <div className=\"flex items-center space-x-4\">\n          <div className=\"flex-shrink-0\">\n            <button \n              className={classNames(\"w-12 h-12 text-xl rounded\", {\"text-white bg-purple-500 shadow\": pageToggle}, {\"text-gray-500 hover:text-purple-500\": !pageToggle})}\n              onClick={handleClickToggle}\n            >\n              <FontAwesomeIcon icon={faBars} />\n            </button>\n          </div>\n\n            <div className=\"ml-0 relative\">\n              <div>\n                {\n                  user?\n                  <UserBlock\n                    className={classNames({\"hover:bg-purple-500 hover:text-white outline-none\": onUserMenu})}\n                    userPhoto={user.userPhoto}\n                    penName={user.penName}\n                    onClick={handleClickUserMenu}\n                  />\n                  : loading?\n                    <button className=\"max-w-xs rounded-full flex items-center text-sm\" id=\"user-menu\" aria-haspopup=\"true\">\n                      <span className=\"sr-only\"></span>\n                      <div className=\"h-8 w-8 rounded-full leading-8 bg-gray-200\"></div>\n                    </button> \n                  : <div className=\"flex items-center\">\n                      <div className=\"hidden md:block\">\n                        <div className=\"flex items-baseline space-x-4 text-gray-700 dark:text-gray-100\">\n            \n                          <Link className={LinkClasses} to=\"/auth/sign-in\">Sign In</Link>\n                          <Link className={LinkClasses} to=\"/auth/sign-up\">Sign up</Link>\n            \n                        </div>\n                      </div>\n                    </div>\n                }\n              \n              </div>\n              {\n                onUserMenu && user? \n                <div onMouseLeave={handleClickToggleFalse} className=\"origin-top-right absolute left-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5\" role=\"menu\" aria-orientation=\"vertical\" aria-labelledby=\"user-menu\">\n                  <Link to={`/bklog/${user.penName}`} className=\"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\">My Page</Link>\n                  <a href=\"#\" className=\"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\" role=\"menuitem\">View Profile</a>\n                  <button \n                    className=\"block text-left w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                    onClick={handleClickSignOut}\n                  > Sign out </button>\n                </div> : null\n              }\n              \n            </div>\n\n            <div className=\"hidden md:block\">\n              <div className=\"flex items-baseline space-x-4 text-gray-700 dark:text-gray-100\">\n\n                <Link className={LinkClasses} to=\"/home\">Home</Link>\n\n              </div>\n            </div>\n                \n\n          </div>\n        </div>\n\n        <div className=\"flex items-center\">\n          <DarkModeToggle />\n        </div>\n\n        </div>\n      </div>\n    </nav>\n  )\n}\n\nexport default GlobalNav;","import GlobalNav from './GlobalNav';\n\nexport default GlobalNav;","import React from 'react';\nimport { BrowserRouter as Router, Switch, Route, HashRouter, Redirect} from 'react-router-dom';\nimport AuthPage from './pages/AuthPage';\nimport useBase from './hooks/useBase';\nimport Home from './pages/HomePage';\nimport BkPage from './pages/BKPage'\nimport GlobalNav from './components/gnb';\nimport classNames from 'classnames';\nimport './assets/App.scss';\nimport useSocket from './hooks/useSocket';\n\nfunction App() {\n\n  const { baseState: { dark } } = useBase();\n\n  return (\n    <div className={classNames(\n      \"App w-full h-screen\",\n      {\"dark\": dark},\n      {\"light\": !dark}\n    )}>\n      <div className=\"w-full h-full pt-14 bg-gray-100 dark:bg-gray-900 text-gray-700 dark:text-gray-100\">\n      <Router basename=\"/\">\n        <GlobalNav />\n        <Switch>\n          <Route path=\"/\" exact>\n            <Redirect to=\"/home\" />\n          </Route>\n          <Route path=\"/home\" component={Home} />\n          <Route path=\"/bklog/:penName/:id\" component={BkPage} />\n          <Route path=\"/auth\" component={AuthPage} />\n        </Switch>\n      </Router>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","import { BaseState, BaseActions, CHANGE_DARK_MODE, SERVER_DISCONNECTED } from \"./utils\";\n\nconst initState: BaseState = {\n  dark: false,\n  error: null\n}\n\nfunction base(state: BaseState = initState, action: BaseActions) {\n  switch(action.type) {\n    case CHANGE_DARK_MODE:\n      return Object.assign({}, state, {\n        dark: !state.dark\n      });\n\n    case SERVER_DISCONNECTED:\n      return Object.assign({}, state, {\n        error: action.payload.error\n      });\n\n    default: \n      return state;\n  }\n}\n\nexport default base;\n","import { initialState } from \".\";\nimport { ModifyDataType } from \"../../../components/newBlock/types\";\nimport { updateObject } from \"../../utils\";\nimport { addPushModifyData, ADD_PUSH_MODIFY_DATA, BklogState, BklogStateProps, changeUpdateState, CHANGE_UPDATE_STATE, clearBklogState, CLEAR_BKLOG_STATE, getPage, getPageError, getPageSuccess, GET_PAGE_ERROR, GET_PAGE_SUCCESS, PageInfoProps, PageInfoType, resetBklog, RESET_BKLOG, updateBklog, updateBklogError, updateBklogSuccess, updateVersion, updateVersionError, updateVersionSuccess, UPDATE_BKLOG, UPDATE_BKLOG_ERROR, UPDATE_BKLOG_SUCCESS, UPDATE_VERSION, UPDATE_VERSION_ERROR, UPDATE_VERSION_SUCCESS } from \"./utils\";\n\nfunction resetBklogHandler(\n  state: BklogState, \n  action: ReturnType<typeof resetBklog>\n): BklogState {\n  return updateObject<BklogState, BklogStateProps>(state, initialState);\n}\n\nfunction clearBklogStateHandler(\n  state: BklogState,\n  { payload }: ReturnType<typeof clearBklogState>\n): BklogState {\n  return updateObject<BklogState, BklogStateProps>(state, { [payload]: null });\n}\n\nfunction getPageHandler(\n  state: BklogState,\n  { payload }: ReturnType<typeof getPage>\n) {\n  return updateObject<BklogState, BklogStateProps>(state, {\n    isLoading: true,\n    isFetching: true\n  })\n}\n\nfunction getPageSuccessHandler(\n  state: BklogState, \n  { payload: { pageInfo, blockList, version } }: ReturnType<typeof getPageSuccess> \n): BklogState {\n  return updateObject<BklogState, BklogStateProps>(state, {\n    pageInfo,\n    blockList,\n    version,\n    isLoading: false,\n    isRefresh: false,\n    isFetching: false,\n    pushModifyData: null,\n    pullModifyData: null\n  });\n}\n\nfunction getPageErrorHandler(\n  state: BklogState,\n  { payload }: ReturnType<typeof getPageError>\n): BklogState {\n  return updateObject<BklogState, BklogStateProps>(state, {\n    error: payload\n  });\n}\n\nfunction addPushModifyDataHandler(\n  state: BklogState, \n  { payload }: ReturnType<typeof addPushModifyData>\n): BklogState {\n  return updateObject<BklogState, BklogStateProps>(state, {\n    pushModifyData: payload\n  });\n}\n\nfunction updateBklogHandler(\n  state: BklogState, \n  action: ReturnType<typeof updateBklog>\n): BklogState {\n  return updateObject<BklogState, BklogStateProps>(state, {\n    isFetching: true\n  });\n}\n\nfunction updateBklogSuccessHandler(\n  state: BklogState, \n  { payload: { pageVersion } }: ReturnType<typeof updateBklogSuccess>\n): BklogState {\n  return updateObject<BklogState, BklogStateProps>(state, {\n    isFetching: false,\n    isUpdated: true,\n    pushModifyData: null,\n    version: pageVersion\n  });\n}\n\nfunction updateBklogErrorHandler(\n  state: BklogState,\n  { payload }: ReturnType<typeof updateBklogError>\n) {\n  if(payload.type === \"Bklog\" && payload.code === \"002\") {\n    return updateObject<BklogState, BklogStateProps>(state, {\n      isLoading: true,\n      isRefresh: true\n    });\n  } else {\n    return updateObject<BklogState, BklogStateProps>(state, {\n      isLoading: true,\n      error: payload\n    });\n  }\n}\n\nfunction updateVersionHandler(\n  state: BklogState,\n  action: ReturnType<typeof updateVersion>\n) {\n  return updateObject<BklogState, BklogStateProps>(state, {\n    isFetching: true\n  });\n}\n\nfunction updateVersionSuccessHandler(\n  state: BklogState,\n  { payload: { id, data: { pageInfo, modifyData } } }: ReturnType<typeof updateVersionSuccess>\n) {\n\n  return updateObject<BklogState, BklogStateProps>(state, {\n    isFetching: false,\n    pageInfo: pageInfo? updateObject<PageInfoType, PageInfoProps>(state.pageInfo, pageInfo) \n    : state.pageInfo,\n    version: id,\n    pullModifyData: modifyData? modifyData : state.pullModifyData\n  });\n}\n\nfunction updateVersionErrorHandler(\n  state: BklogState,\n  { payload }: ReturnType<typeof updateVersionError>\n) {\n  console.log(payload);\n  if(payload.type === \"Bklog\" && payload.code === \"002\") {\n    return updateObject<BklogState, BklogStateProps>(state, {\n      isLoading: true,\n      isRefresh: true\n    });\n  } else {\n    return updateObject<BklogState, BklogStateProps>(state, {\n      isLoading: true,\n      error: payload\n    });\n  }\n}\n\nfunction changeUpdateStateHandler(\n  state: BklogState,\n  { payload }: ReturnType<typeof changeUpdateState>\n) {\n  return updateObject<BklogState, BklogStateProps>(state, {\n    isUpdated: payload? true : false\n  });\n}\n\nexport default {\n  [RESET_BKLOG]            : resetBklogHandler,\n  [CLEAR_BKLOG_STATE]      : clearBklogStateHandler,\n  [GET_PAGE_SUCCESS]       : getPageSuccessHandler,\n  [GET_PAGE_ERROR]         : getPageErrorHandler,\n  [ADD_PUSH_MODIFY_DATA]   : addPushModifyDataHandler,\n  [UPDATE_BKLOG]           : updateBklogHandler,\n  [UPDATE_BKLOG_SUCCESS]   : updateBklogSuccessHandler,\n  [UPDATE_BKLOG_ERROR]     : updateBklogErrorHandler,\n  [UPDATE_VERSION]         : updateVersionHandler,\n  [UPDATE_VERSION_SUCCESS] : updateVersionSuccessHandler,\n  [UPDATE_VERSION_ERROR]   : updateVersionErrorHandler,\n  [CHANGE_UPDATE_STATE]    : changeUpdateStateHandler\n};","import { createReducer } from \"../../utils\";\nimport handler from \"./handler\";\nimport { BklogState } from \"./utils\";\n\nexport const initialState: BklogState = {\n  isLoading: false,\n  isFetching: false,\n  isRefresh: false,\n  isUpdated: false,\n  pageInfo: null,\n  version: null,\n  pageStar: null,\n  pageComments: null,\n  blockList: null,\n  blockComments: null,\n  pullModifyData: null,\n  pushModifyData: null,\n  editingUserList: [],\n  error: null\n};\n\nconst bklog = createReducer(initialState, handler);\n\nexport default bklog;","import { \n  AuthState, \n  AuthActions,\n  SIGNINUSER, \n  SIGNOUTUSER, \n  SIGNINUSER_SUCCESS,\n  SIGNINUSER_ERROR,\n  SIGNOUTUSER_SUCCESS,\n  SIGNOUTUSER_ERROR,\n  RESIGNINUSER,\n  RESIGNINUSER_SUCCESS,\n  RESIGNINUSER_ERROR,\n  SIGNUPUSER,\n  SIGNUPUSER_SUCCESS,\n  SIGNUPUSER_ERROR,\n  RESET_AUTH,\n} from './utils';\n\nconst initialState = ((): AuthState  => {\n  return {\n    loading: false,\n    user: null,\n    error: {\n      signInUser: null,\n      signUpUser: {\n        emailValid: false,\n        passwordValid: false,\n        penNameValid: false,\n        emailUsed: false,\n        penNameUsed: false\n      },\n      signOutUser: null\n    }\n  }\n})();\n\nconst initialError = ()=> {\n  return  {\n    signInUser: null,\n    signUpUser: {\n      emailValid: false,\n      passwordValid: false,\n      penNameValid: false,\n      emailUsed: false,\n      penNameUsed: false\n    },\n    signOutUser: null\n  }\n};\n\n\n//server와 연결이 끊겼을 때 error 핸들링 필요.\nexport default function auth(state: AuthState = initialState, action: AuthActions) {\n  switch (action.type) {\n    case SIGNUPUSER:\n      return Object.assign({}, initialState, { loading: true, \n        error: initialError()\n      });\n    case SIGNUPUSER_SUCCESS:\n      return Object.assign({}, state, { loading: false });\n    case SIGNUPUSER_ERROR: \n      return Object.assign({}, state, { \n        loading: false,\n        error: Object.assign({}, state.error, {\n          signUpUser: action.payload.error\n        })\n       });\n\n    case SIGNINUSER:\n    case RESIGNINUSER:\n      return Object.assign({}, initialState, { loading: true,\n        user: null, \n        error: initialError()\n      });\n\n    case SIGNINUSER_SUCCESS:\n    case SIGNINUSER_ERROR:\n    case RESIGNINUSER_SUCCESS:\n    case RESIGNINUSER_ERROR:\n      const { userInfo, error } = action.payload;\n      return Object.assign({}, state, {loading: false, \n        user: action.payload, \n        error: Object.assign({}, state.error, {\n          signInUser: error\n        })\n      });\n\n    case SIGNOUTUSER:\n      return initialState;\n\n    case SIGNOUTUSER_SUCCESS:\n      return Object.assign({}, state, { loading: false });\n      \n    case SIGNOUTUSER_ERROR: \n      return Object.assign({}, state, { loading: false, \n        error: Object.assign({}, state.error, {\n          signOut: \"서버와 통신이 불안정합니다.\"\n        })\n      });\n\n    case RESET_AUTH:\n      return initialState;\n  \n    default:\n      return state;\n  }\n}","import { takeEvery, call, put } from 'redux-saga/effects';\nimport { \n  authFetchGet, \n  authFetchPost, \n  SIGNINUSER, \n  SIGNOUTUSER, \n  UserAuthInfo, \n  User,\n  RequiredUserInfo,\n  ResSignUpUser,\n  SIGNUPUSER,\n  RESIGNINUSER,\n  REISSUETOKEN,\n  SIGNINUSER_ERROR,\n  RESET_AUTH\n} from './utils/index';\nimport { ResType } from '../../../utils/api-utils';\nimport { ALL_RESET, createPromiseSaga } from '../../utils';\nimport { ApiError } from '../../../utils/api-utils';\n\n\nfunction signInUser(userAuthInfo: UserAuthInfo) {\n  return authFetchPost(\"sign-in\", userAuthInfo);\n}\n\nfunction signOutUser() {\n  return authFetchGet(\"sign-out\");\n}\n\nfunction signUpUser(requiredUserInfo: RequiredUserInfo) {\n  return authFetchPost(\"sign-up\", requiredUserInfo);\n}\n\nfunction reSignInUser() {\n  return authFetchGet(\"resign-in\");\n}\n\nfunction validationAccessToken() {\n  return authFetchGet(\"check-token\");\n}\n\nfunction reissueToken() {\n  return authFetchGet(\"reissue-token\");\n}\n\n\nfunction* reissueTokenSaga({ payload }: any) {\n  try {\n    yield call(reissueToken);\n\n    if(payload) {\n      yield put({ type: payload.type, payload: payload.payload? payload.payload : undefined });\n    }\n\n  } catch(error) {\n    \n    if(error.type !== \"System\") {\n      yield put({ type: ALL_RESET });\n    } else {\n      yield put({ type: SIGNINUSER_ERROR, payload: {\n        userInfo: null,\n        error: error\n      }});\n  \n      if(payload) {\n        yield put({ type: `${payload.type}_ERROR`, error: new ApiError(error).get });\n      }  \n    }\n\n  }\n}\n\nconst AUTH_ERROR = \"auth/AUTH_ERROR\" as const;\n\nconst signInUserSaga = createPromiseSaga(SIGNINUSER, signInUser, AUTH_ERROR);\nconst signOutUserSaga = createPromiseSaga(SIGNOUTUSER, signOutUser, AUTH_ERROR);\nconst signUpUserSaga = createPromiseSaga(SIGNUPUSER, signUpUser, AUTH_ERROR);\nconst reSignInUserSaga = createPromiseSaga(RESIGNINUSER, reSignInUser, AUTH_ERROR);\n\nexport default function* authSaga() {\n  yield takeEvery(SIGNINUSER, signInUserSaga);\n  yield takeEvery(SIGNOUTUSER, signOutUserSaga);\n  yield takeEvery(SIGNUPUSER, signUpUserSaga);\n  yield takeEvery(RESIGNINUSER, reSignInUserSaga);\n  yield takeEvery(REISSUETOKEN, reissueTokenSaga);\n}","import { takeEvery } from \"redux-saga/effects\";\nimport { createPromiseSaga } from \"../../utils\";\nimport { bklogFetchGet, bklogFetchPost, GET_PAGE, ReqUpdateBklog, UPDATE_BKLOG, UPDATE_VERSION } from \"./utils\";\n\nfunction updateBklog(data: ReqUpdateBklog) {\n  return bklogFetchPost(\"t-modify\", data);\n}\n\nfunction getPage(pageId: string) {\n  return bklogFetchGet(\"t-getpage\", {\n    id: pageId\n  });\n}\n\nfunction updateVersion(versions: { id: string, preId: string } ) {\n  return bklogFetchGet(\"getmodifydata\", versions);\n}\n\nconst getPageSaga       = createPromiseSaga(GET_PAGE, getPage);\nconst updateBklogSaga   = createPromiseSaga(UPDATE_BKLOG, updateBklog);\nconst updateVersionSaga = createPromiseSaga(UPDATE_VERSION, updateVersion);\n\nexport default function* bklogSaga() {\n  yield takeEvery(GET_PAGE, getPageSaga);\n  yield takeEvery(UPDATE_BKLOG, updateBklogSaga);\n  yield takeEvery(UPDATE_VERSION, updateVersionSaga);\n}","import { combineReducers } from 'redux';\nimport { all, takeEvery } from 'redux-saga/effects';\n\nimport base  from './base';\nimport bklog from './bklog';\nimport auth  from './auth';\nimport page  from './page';\n\nimport authSaga from './auth/authSaga';\nimport { allResetSaga, ALL_RESET } from '../utils';\nimport bklogSaga from './bklog/saga';\n\nconst rootReducer = combineReducers({\n  base,\n  auth,\n  bklog,\n  page\n});\n\nfunction* commonSaga() {\n  yield takeEvery(ALL_RESET, allResetSaga);\n}\n\nexport function* rootSage() {\n  yield all([\n    commonSaga(), \n    authSaga(),\n    bklogSaga()\n  ]); \n}\n\n\nexport default rootReducer;\n\nexport type RootState = ReturnType<typeof rootReducer>;","import { createStore, applyMiddleware, compose } from 'redux';\nimport rootReducer, { rootSage } from './modules';\nimport createSagaMiddleware from 'redux-saga';\n\nconst sagaMiddleware = createSagaMiddleware();\n\n// const middleware = (store: any) => (next: any) => (action: any) => {\n//   console.log(action);\n//   const result = next(action);\n//   return result;\n// }\n\ndeclare global {\n  interface Window {\n    __REDUX_DEVTOOLS_EXTENSION_COMPOSE__?: typeof compose;\n  }\n}\n\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\nconst configureStore = (() => {\n  const store = createStore(rootReducer, composeEnhancers(\n    applyMiddleware(sagaMiddleware)\n  ));\n  sagaMiddleware.run(rootSage);\n\n  return store;\n})();\n\nexport default configureStore;","import React from 'react';\nimport App   from './App';\nimport { Provider } from 'react-redux';\nimport configureStore from './store';\n\nfunction Root() {\n  return (\n    <Provider store={configureStore}>\n      <App />\n    </Provider>\n  )\n}\n\nexport default Root;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Root from './Root';\nimport './assets/index.css';\n\nReactDOM.render(\n  <Root />,\n  document.getElementById('root')\n);"],"sourceRoot":""}